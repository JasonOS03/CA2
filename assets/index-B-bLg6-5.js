(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))s(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const u of a.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&s(u)}).observe(document,{childList:!0,subtree:!0});function e(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function s(i){if(i.ep)return;i.ep=!0;const a=e(i);fetch(i.href,a)}})();async function Xa(n,t,e,s){const i=e.querySelectorAll("shape-card");let a=0;i.forEach(u=>{u.isFaceUp()&&(a+=1)}),a==t&&(alert("game has been won!"),console.log("Database: ",n),await addDoc(collection(n,"memory_game"),{num_clicks:s,time_to_complete:Timestamp.now()}))}function Ya(n,t){n.getAttribute("colour")===t.getAttribute("colour")&&n.getAttribute("type")===t.getAttribute("type")?console.log("match has been found"):setTimeout(()=>{n.flip(),t.flip()},1e3)}const Ja=()=>{};var _i={};const yo=function(n){const t=[];let e=0;for(let s=0;s<n.length;s++){let i=n.charCodeAt(s);i<128?t[e++]=i:i<2048?(t[e++]=i>>6|192,t[e++]=i&63|128):(i&64512)===55296&&s+1<n.length&&(n.charCodeAt(s+1)&64512)===56320?(i=65536+((i&1023)<<10)+(n.charCodeAt(++s)&1023),t[e++]=i>>18|240,t[e++]=i>>12&63|128,t[e++]=i>>6&63|128,t[e++]=i&63|128):(t[e++]=i>>12|224,t[e++]=i>>6&63|128,t[e++]=i&63|128)}return t},Za=function(n){const t=[];let e=0,s=0;for(;e<n.length;){const i=n[e++];if(i<128)t[s++]=String.fromCharCode(i);else if(i>191&&i<224){const a=n[e++];t[s++]=String.fromCharCode((i&31)<<6|a&63)}else if(i>239&&i<365){const a=n[e++],u=n[e++],h=n[e++],g=((i&7)<<18|(a&63)<<12|(u&63)<<6|h&63)-65536;t[s++]=String.fromCharCode(55296+(g>>10)),t[s++]=String.fromCharCode(56320+(g&1023))}else{const a=n[e++],u=n[e++];t[s++]=String.fromCharCode((i&15)<<12|(a&63)<<6|u&63)}}return t.join("")},Eo={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,t){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const e=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,s=[];for(let i=0;i<n.length;i+=3){const a=n[i],u=i+1<n.length,h=u?n[i+1]:0,g=i+2<n.length,d=g?n[i+2]:0,A=a>>2,w=(a&3)<<4|h>>4;let S=(h&15)<<2|d>>6,P=d&63;g||(P=64,u||(S=64)),s.push(e[A],e[w],e[S],e[P])}return s.join("")},encodeString(n,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(n):this.encodeByteArray(yo(n),t)},decodeString(n,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(n):Za(this.decodeStringToByteArray(n,t))},decodeStringToByteArray(n,t){this.init_();const e=t?this.charToByteMapWebSafe_:this.charToByteMap_,s=[];for(let i=0;i<n.length;){const a=e[n.charAt(i++)],h=i<n.length?e[n.charAt(i)]:0;++i;const d=i<n.length?e[n.charAt(i)]:64;++i;const w=i<n.length?e[n.charAt(i)]:64;if(++i,a==null||h==null||d==null||w==null)throw new tl;const S=a<<2|h>>4;if(s.push(S),d!==64){const P=h<<4&240|d>>2;if(s.push(P),w!==64){const N=d<<6&192|w;s.push(N)}}}return s},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class tl extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const el=function(n){const t=yo(n);return Eo.encodeByteArray(t,!0)},Pn=function(n){return el(n).replace(/\./g,"")},nl=function(n){try{return Eo.decodeString(n,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};function rl(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const sl=()=>rl().__FIREBASE_DEFAULTS__,il=()=>{if(typeof process>"u"||typeof _i>"u")return;const n=_i.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},ol=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const t=n&&nl(n[1]);return t&&JSON.parse(t)},Qr=()=>{try{return Ja()||sl()||il()||ol()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},al=n=>Qr()?.emulatorHosts?.[n],ll=n=>{const t=al(n);if(!t)return;const e=t.lastIndexOf(":");if(e<=0||e+1===t.length)throw new Error(`Invalid host ${t} with no separate hostname and port!`);const s=parseInt(t.substring(e+1),10);return t[0]==="["?[t.substring(1,e-1),s]:[t.substring(0,e),s]},To=()=>Qr()?.config;class ul{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((t,e)=>{this.resolve=t,this.reject=e})}wrapCallback(t){return(e,s)=>{e?this.reject(e):this.resolve(s),typeof t=="function"&&(this.promise.catch(()=>{}),t.length===1?t(e):t(e,s))}}}function Kr(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function cl(n){return(await fetch(n,{credentials:"include"})).ok}function hl(n,t){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const e={alg:"none",type:"JWT"},s=t||"demo-project",i=n.iat||0,a=n.sub||n.user_id;if(!a)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const u={iss:`https://securetoken.google.com/${s}`,aud:s,iat:i,exp:i+3600,auth_time:i,sub:a,user_id:a,firebase:{sign_in_provider:"custom",identities:{}},...n};return[Pn(JSON.stringify(e)),Pn(JSON.stringify(u)),""].join(".")}const qe={};function fl(){const n={prod:[],emulator:[]};for(const t of Object.keys(qe))qe[t]?n.emulator.push(t):n.prod.push(t);return n}function dl(n){let t=document.getElementById(n),e=!1;return t||(t=document.createElement("div"),t.setAttribute("id",n),e=!0),{created:e,element:t}}let yi=!1;function pl(n,t){if(typeof window>"u"||typeof document>"u"||!Kr(window.location.host)||qe[n]===t||qe[n]||yi)return;qe[n]=t;function e(S){return`__firebase__banner__${S}`}const s="__firebase__banner",a=fl().prod.length>0;function u(){const S=document.getElementById(s);S&&S.remove()}function h(S){S.style.display="flex",S.style.background="#7faaf0",S.style.position="fixed",S.style.bottom="5px",S.style.left="5px",S.style.padding=".5em",S.style.borderRadius="5px",S.style.alignItems="center"}function g(S,P){S.setAttribute("width","24"),S.setAttribute("id",P),S.setAttribute("height","24"),S.setAttribute("viewBox","0 0 24 24"),S.setAttribute("fill","none"),S.style.marginLeft="-6px"}function d(){const S=document.createElement("span");return S.style.cursor="pointer",S.style.marginLeft="16px",S.style.fontSize="24px",S.innerHTML=" &times;",S.onclick=()=>{yi=!0,u()},S}function A(S,P){S.setAttribute("id",P),S.innerText="Learn more",S.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",S.setAttribute("target","__blank"),S.style.paddingLeft="5px",S.style.textDecoration="underline"}function w(){const S=dl(s),P=e("text"),N=document.getElementById(P)||document.createElement("span"),U=e("learnmore"),O=document.getElementById(U)||document.createElement("a"),Z=e("preprendIcon"),X=document.getElementById(Z)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(S.created){const Q=S.element;h(Q),A(O,U);const mt=d();g(X,Z),Q.append(X,N,O,mt),document.body.appendChild(Q)}a?(N.innerText="Preview backend disconnected.",X.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(X.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,N.innerText="Preview backend running in this workspace."),N.setAttribute("id",P)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",w):w()}function gl(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function ml(){const n=Qr()?.forceEnvironment;if(n==="node")return!0;if(n==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function _l(){return!ml()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function yl(){try{return typeof indexedDB=="object"}catch{return!1}}function El(){return new Promise((n,t)=>{try{let e=!0;const s="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(s);i.onsuccess=()=>{i.result.close(),e||self.indexedDB.deleteDatabase(s),n(!0)},i.onupgradeneeded=()=>{e=!1},i.onerror=()=>{t(i.error?.message||"")}}catch(e){t(e)}})}const Tl="FirebaseError";class Ae extends Error{constructor(t,e,s){super(e),this.code=t,this.customData=s,this.name=Tl,Object.setPrototypeOf(this,Ae.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,vo.prototype.create)}}class vo{constructor(t,e,s){this.service=t,this.serviceName=e,this.errors=s}create(t,...e){const s=e[0]||{},i=`${this.service}/${t}`,a=this.errors[t],u=a?vl(a,s):"Error",h=`${this.serviceName}: ${u} (${i}).`;return new Ae(i,h,s)}}function vl(n,t){return n.replace(Al,(e,s)=>{const i=t[s];return i!=null?String(i):`<${s}?>`})}const Al=/\{\$([^}]+)}/g;function Vn(n,t){if(n===t)return!0;const e=Object.keys(n),s=Object.keys(t);for(const i of e){if(!s.includes(i))return!1;const a=n[i],u=t[i];if(Ei(a)&&Ei(u)){if(!Vn(a,u))return!1}else if(a!==u)return!1}for(const i of s)if(!e.includes(i))return!1;return!0}function Ei(n){return n!==null&&typeof n=="object"}function Ao(n){return n&&n._delegate?n._delegate:n}class We{constructor(t,e,s){this.name=t,this.instanceFactory=e,this.type=s,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(t){return this.instantiationMode=t,this}setMultipleInstances(t){return this.multipleInstances=t,this}setServiceProps(t){return this.serviceProps=t,this}setInstanceCreatedCallback(t){return this.onInstanceCreated=t,this}}const ee="[DEFAULT]";class Il{constructor(t,e){this.name=t,this.container=e,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(t){const e=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(e)){const s=new ul;if(this.instancesDeferred.set(e,s),this.isInitialized(e)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:e});i&&s.resolve(i)}catch{}}return this.instancesDeferred.get(e).promise}getImmediate(t){const e=this.normalizeInstanceIdentifier(t?.identifier),s=t?.optional??!1;if(this.isInitialized(e)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:e})}catch(i){if(s)return null;throw i}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(t){if(t.name!==this.name)throw Error(`Mismatching Component ${t.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=t,!!this.shouldAutoInitialize()){if(Rl(t))try{this.getOrInitializeService({instanceIdentifier:ee})}catch{}for(const[e,s]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(e);try{const a=this.getOrInitializeService({instanceIdentifier:i});s.resolve(a)}catch{}}}}clearInstance(t=ee){this.instancesDeferred.delete(t),this.instancesOptions.delete(t),this.instances.delete(t)}async delete(){const t=Array.from(this.instances.values());await Promise.all([...t.filter(e=>"INTERNAL"in e).map(e=>e.INTERNAL.delete()),...t.filter(e=>"_delete"in e).map(e=>e._delete())])}isComponentSet(){return this.component!=null}isInitialized(t=ee){return this.instances.has(t)}getOptions(t=ee){return this.instancesOptions.get(t)||{}}initialize(t={}){const{options:e={}}=t,s=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(s))throw Error(`${this.name}(${s}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:s,options:e});for(const[a,u]of this.instancesDeferred.entries()){const h=this.normalizeInstanceIdentifier(a);s===h&&u.resolve(i)}return i}onInit(t,e){const s=this.normalizeInstanceIdentifier(e),i=this.onInitCallbacks.get(s)??new Set;i.add(t),this.onInitCallbacks.set(s,i);const a=this.instances.get(s);return a&&t(a,s),()=>{i.delete(t)}}invokeOnInitCallbacks(t,e){const s=this.onInitCallbacks.get(e);if(s)for(const i of s)try{i(t,e)}catch{}}getOrInitializeService({instanceIdentifier:t,options:e={}}){let s=this.instances.get(t);if(!s&&this.component&&(s=this.component.instanceFactory(this.container,{instanceIdentifier:wl(t),options:e}),this.instances.set(t,s),this.instancesOptions.set(t,e),this.invokeOnInitCallbacks(s,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,s)}catch{}return s||null}normalizeInstanceIdentifier(t=ee){return this.component?this.component.multipleInstances?t:ee:t}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function wl(n){return n===ee?void 0:n}function Rl(n){return n.instantiationMode==="EAGER"}class Sl{constructor(t){this.name=t,this.providers=new Map}addComponent(t){const e=this.getProvider(t.name);if(e.isComponentSet())throw new Error(`Component ${t.name} has already been registered with ${this.name}`);e.setComponent(t)}addOrOverwriteComponent(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)}getProvider(t){if(this.providers.has(t))return this.providers.get(t);const e=new Il(t,this);return this.providers.set(t,e),e}getProviders(){return Array.from(this.providers.values())}}var F;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(F||(F={}));const Cl={debug:F.DEBUG,verbose:F.VERBOSE,info:F.INFO,warn:F.WARN,error:F.ERROR,silent:F.SILENT},bl=F.INFO,Pl={[F.DEBUG]:"log",[F.VERBOSE]:"log",[F.INFO]:"info",[F.WARN]:"warn",[F.ERROR]:"error"},Vl=(n,t,...e)=>{if(t<n.logLevel)return;const s=new Date().toISOString(),i=Pl[t];if(i)console[i](`[${s}]  ${n.name}:`,...e);else throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`)};class Io{constructor(t){this.name=t,this._logLevel=bl,this._logHandler=Vl,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(t){if(!(t in F))throw new TypeError(`Invalid value "${t}" assigned to \`logLevel\``);this._logLevel=t}setLogLevel(t){this._logLevel=typeof t=="string"?Cl[t]:t}get logHandler(){return this._logHandler}set logHandler(t){if(typeof t!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t}get userLogHandler(){return this._userLogHandler}set userLogHandler(t){this._userLogHandler=t}debug(...t){this._userLogHandler&&this._userLogHandler(this,F.DEBUG,...t),this._logHandler(this,F.DEBUG,...t)}log(...t){this._userLogHandler&&this._userLogHandler(this,F.VERBOSE,...t),this._logHandler(this,F.VERBOSE,...t)}info(...t){this._userLogHandler&&this._userLogHandler(this,F.INFO,...t),this._logHandler(this,F.INFO,...t)}warn(...t){this._userLogHandler&&this._userLogHandler(this,F.WARN,...t),this._logHandler(this,F.WARN,...t)}error(...t){this._userLogHandler&&this._userLogHandler(this,F.ERROR,...t),this._logHandler(this,F.ERROR,...t)}}const Dl=(n,t)=>t.some(e=>n instanceof e);let Ti,vi;function Nl(){return Ti||(Ti=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function Ol(){return vi||(vi=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const wo=new WeakMap,Cr=new WeakMap,Ro=new WeakMap,yr=new WeakMap,Wr=new WeakMap;function Ml(n){const t=new Promise((e,s)=>{const i=()=>{n.removeEventListener("success",a),n.removeEventListener("error",u)},a=()=>{e(jt(n.result)),i()},u=()=>{s(n.error),i()};n.addEventListener("success",a),n.addEventListener("error",u)});return t.then(e=>{e instanceof IDBCursor&&wo.set(e,n)}).catch(()=>{}),Wr.set(t,n),t}function kl(n){if(Cr.has(n))return;const t=new Promise((e,s)=>{const i=()=>{n.removeEventListener("complete",a),n.removeEventListener("error",u),n.removeEventListener("abort",u)},a=()=>{e(),i()},u=()=>{s(n.error||new DOMException("AbortError","AbortError")),i()};n.addEventListener("complete",a),n.addEventListener("error",u),n.addEventListener("abort",u)});Cr.set(n,t)}let br={get(n,t,e){if(n instanceof IDBTransaction){if(t==="done")return Cr.get(n);if(t==="objectStoreNames")return n.objectStoreNames||Ro.get(n);if(t==="store")return e.objectStoreNames[1]?void 0:e.objectStore(e.objectStoreNames[0])}return jt(n[t])},set(n,t,e){return n[t]=e,!0},has(n,t){return n instanceof IDBTransaction&&(t==="done"||t==="store")?!0:t in n}};function xl(n){br=n(br)}function Ll(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(t,...e){const s=n.call(Er(this),t,...e);return Ro.set(s,t.sort?t.sort():[t]),jt(s)}:Ol().includes(n)?function(...t){return n.apply(Er(this),t),jt(wo.get(this))}:function(...t){return jt(n.apply(Er(this),t))}}function Fl(n){return typeof n=="function"?Ll(n):(n instanceof IDBTransaction&&kl(n),Dl(n,Nl())?new Proxy(n,br):n)}function jt(n){if(n instanceof IDBRequest)return Ml(n);if(yr.has(n))return yr.get(n);const t=Fl(n);return t!==n&&(yr.set(n,t),Wr.set(t,n)),t}const Er=n=>Wr.get(n);function Ul(n,t,{blocked:e,upgrade:s,blocking:i,terminated:a}={}){const u=indexedDB.open(n,t),h=jt(u);return s&&u.addEventListener("upgradeneeded",g=>{s(jt(u.result),g.oldVersion,g.newVersion,jt(u.transaction),g)}),e&&u.addEventListener("blocked",g=>e(g.oldVersion,g.newVersion,g)),h.then(g=>{a&&g.addEventListener("close",()=>a()),i&&g.addEventListener("versionchange",d=>i(d.oldVersion,d.newVersion,d))}).catch(()=>{}),h}const Bl=["get","getKey","getAll","getAllKeys","count"],jl=["put","add","delete","clear"],Tr=new Map;function Ai(n,t){if(!(n instanceof IDBDatabase&&!(t in n)&&typeof t=="string"))return;if(Tr.get(t))return Tr.get(t);const e=t.replace(/FromIndex$/,""),s=t!==e,i=jl.includes(e);if(!(e in(s?IDBIndex:IDBObjectStore).prototype)||!(i||Bl.includes(e)))return;const a=async function(u,...h){const g=this.transaction(u,i?"readwrite":"readonly");let d=g.store;return s&&(d=d.index(h.shift())),(await Promise.all([d[e](...h),i&&g.done]))[0]};return Tr.set(t,a),a}xl(n=>({...n,get:(t,e,s)=>Ai(t,e)||n.get(t,e,s),has:(t,e)=>!!Ai(t,e)||n.has(t,e)}));class $l{constructor(t){this.container=t}getPlatformInfoString(){return this.container.getProviders().map(e=>{if(ql(e)){const s=e.getImmediate();return`${s.library}/${s.version}`}else return null}).filter(e=>e).join(" ")}}function ql(n){return n.getComponent()?.type==="VERSION"}const Pr="@firebase/app",Ii="0.14.6";const Nt=new Io("@firebase/app"),Hl="@firebase/app-compat",zl="@firebase/analytics-compat",Gl="@firebase/analytics",Ql="@firebase/app-check-compat",Kl="@firebase/app-check",Wl="@firebase/auth",Xl="@firebase/auth-compat",Yl="@firebase/database",Jl="@firebase/data-connect",Zl="@firebase/database-compat",tu="@firebase/functions",eu="@firebase/functions-compat",nu="@firebase/installations",ru="@firebase/installations-compat",su="@firebase/messaging",iu="@firebase/messaging-compat",ou="@firebase/performance",au="@firebase/performance-compat",lu="@firebase/remote-config",uu="@firebase/remote-config-compat",cu="@firebase/storage",hu="@firebase/storage-compat",fu="@firebase/firestore",du="@firebase/ai",pu="@firebase/firestore-compat",gu="firebase",mu="12.6.0";const Vr="[DEFAULT]",_u={[Pr]:"fire-core",[Hl]:"fire-core-compat",[Gl]:"fire-analytics",[zl]:"fire-analytics-compat",[Kl]:"fire-app-check",[Ql]:"fire-app-check-compat",[Wl]:"fire-auth",[Xl]:"fire-auth-compat",[Yl]:"fire-rtdb",[Jl]:"fire-data-connect",[Zl]:"fire-rtdb-compat",[tu]:"fire-fn",[eu]:"fire-fn-compat",[nu]:"fire-iid",[ru]:"fire-iid-compat",[su]:"fire-fcm",[iu]:"fire-fcm-compat",[ou]:"fire-perf",[au]:"fire-perf-compat",[lu]:"fire-rc",[uu]:"fire-rc-compat",[cu]:"fire-gcs",[hu]:"fire-gcs-compat",[fu]:"fire-fst",[pu]:"fire-fst-compat",[du]:"fire-vertex","fire-js":"fire-js",[gu]:"fire-js-all"};const Dn=new Map,yu=new Map,Dr=new Map;function wi(n,t){try{n.container.addComponent(t)}catch(e){Nt.debug(`Component ${t.name} failed to register with FirebaseApp ${n.name}`,e)}}function Nn(n){const t=n.name;if(Dr.has(t))return Nt.debug(`There were multiple attempts to register component ${t}.`),!1;Dr.set(t,n);for(const e of Dn.values())wi(e,n);for(const e of yu.values())wi(e,n);return!0}function Eu(n,t){const e=n.container.getProvider("heartbeat").getImmediate({optional:!0});return e&&e.triggerHeartbeat(),n.container.getProvider(t)}function Tu(n){return n==null?!1:n.settings!==void 0}const vu={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},$t=new vo("app","Firebase",vu);class Au{constructor(t,e,s){this._isDeleted=!1,this._options={...t},this._config={...e},this._name=e.name,this._automaticDataCollectionEnabled=e.automaticDataCollectionEnabled,this._container=s,this.container.addComponent(new We("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(t){this.checkDestroyed(),this._automaticDataCollectionEnabled=t}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(t){this._isDeleted=t}checkDestroyed(){if(this.isDeleted)throw $t.create("app-deleted",{appName:this._name})}}const Iu=mu;function So(n,t={}){let e=n;typeof t!="object"&&(t={name:t});const s={name:Vr,automaticDataCollectionEnabled:!0,...t},i=s.name;if(typeof i!="string"||!i)throw $t.create("bad-app-name",{appName:String(i)});if(e||(e=To()),!e)throw $t.create("no-options");const a=Dn.get(i);if(a){if(Vn(e,a.options)&&Vn(s,a.config))return a;throw $t.create("duplicate-app",{appName:i})}const u=new Sl(i);for(const g of Dr.values())u.addComponent(g);const h=new Au(e,s,u);return Dn.set(i,h),h}function wu(n=Vr){const t=Dn.get(n);if(!t&&n===Vr&&To())return So();if(!t)throw $t.create("no-app",{appName:n});return t}function ge(n,t,e){let s=_u[n]??n;e&&(s+=`-${e}`);const i=s.match(/\s|\//),a=t.match(/\s|\//);if(i||a){const u=[`Unable to register library "${s}" with version "${t}":`];i&&u.push(`library name "${s}" contains illegal characters (whitespace or "/")`),i&&a&&u.push("and"),a&&u.push(`version name "${t}" contains illegal characters (whitespace or "/")`),Nt.warn(u.join(" "));return}Nn(new We(`${s}-version`,()=>({library:s,version:t}),"VERSION"))}const Ru="firebase-heartbeat-database",Su=1,Xe="firebase-heartbeat-store";let vr=null;function Co(){return vr||(vr=Ul(Ru,Su,{upgrade:(n,t)=>{switch(t){case 0:try{n.createObjectStore(Xe)}catch(e){console.warn(e)}}}}).catch(n=>{throw $t.create("idb-open",{originalErrorMessage:n.message})})),vr}async function Cu(n){try{const e=(await Co()).transaction(Xe),s=await e.objectStore(Xe).get(bo(n));return await e.done,s}catch(t){if(t instanceof Ae)Nt.warn(t.message);else{const e=$t.create("idb-get",{originalErrorMessage:t?.message});Nt.warn(e.message)}}}async function Ri(n,t){try{const s=(await Co()).transaction(Xe,"readwrite");await s.objectStore(Xe).put(t,bo(n)),await s.done}catch(e){if(e instanceof Ae)Nt.warn(e.message);else{const s=$t.create("idb-set",{originalErrorMessage:e?.message});Nt.warn(s.message)}}}function bo(n){return`${n.name}!${n.options.appId}`}const bu=1024,Pu=30;class Vu{constructor(t){this.container=t,this._heartbeatsCache=null;const e=this.container.getProvider("app").getImmediate();this._storage=new Nu(e),this._heartbeatsCachePromise=this._storage.read().then(s=>(this._heartbeatsCache=s,s))}async triggerHeartbeat(){try{const e=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=Si();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(i=>i.date===s))return;if(this._heartbeatsCache.heartbeats.push({date:s,agent:e}),this._heartbeatsCache.heartbeats.length>Pu){const i=Ou(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(i,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(t){Nt.warn(t)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=Si(),{heartbeatsToSend:e,unsentEntries:s}=Du(this._heartbeatsCache.heartbeats),i=Pn(JSON.stringify({version:2,heartbeats:e}));return this._heartbeatsCache.lastSentHeartbeatDate=t,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(t){return Nt.warn(t),""}}}function Si(){return new Date().toISOString().substring(0,10)}function Du(n,t=bu){const e=[];let s=n.slice();for(const i of n){const a=e.find(u=>u.agent===i.agent);if(a){if(a.dates.push(i.date),Ci(e)>t){a.dates.pop();break}}else if(e.push({agent:i.agent,dates:[i.date]}),Ci(e)>t){e.pop();break}s=s.slice(1)}return{heartbeatsToSend:e,unsentEntries:s}}class Nu{constructor(t){this.app=t,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return yl()?El().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const e=await Cu(this.app);return e?.heartbeats?e:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(t){if(await this._canUseIndexedDBPromise){const s=await this.read();return Ri(this.app,{lastSentHeartbeatDate:t.lastSentHeartbeatDate??s.lastSentHeartbeatDate,heartbeats:t.heartbeats})}else return}async add(t){if(await this._canUseIndexedDBPromise){const s=await this.read();return Ri(this.app,{lastSentHeartbeatDate:t.lastSentHeartbeatDate??s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...t.heartbeats]})}else return}}function Ci(n){return Pn(JSON.stringify({version:2,heartbeats:n})).length}function Ou(n){if(n.length===0)return-1;let t=0,e=n[0].date;for(let s=1;s<n.length;s++)n[s].date<e&&(e=n[s].date,t=s);return t}function Mu(n){Nn(new We("platform-logger",t=>new $l(t),"PRIVATE")),Nn(new We("heartbeat",t=>new Vu(t),"PRIVATE")),ge(Pr,Ii,n),ge(Pr,Ii,"esm2020"),ge("fire-js","")}Mu("");var ku="firebase",xu="12.6.0";ge(ku,xu,"app");var bi=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var Xr;(function(){var n;function t(y,f){function m(){}m.prototype=f.prototype,y.F=f.prototype,y.prototype=new m,y.prototype.constructor=y,y.D=function(E,_,v){for(var p=Array(arguments.length-2),pt=2;pt<arguments.length;pt++)p[pt-2]=arguments[pt];return f.prototype[_].apply(E,p)}}function e(){this.blockSize=-1}function s(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}t(s,e),s.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(y,f,m){m||(m=0);const E=Array(16);if(typeof f=="string")for(var _=0;_<16;++_)E[_]=f.charCodeAt(m++)|f.charCodeAt(m++)<<8|f.charCodeAt(m++)<<16|f.charCodeAt(m++)<<24;else for(_=0;_<16;++_)E[_]=f[m++]|f[m++]<<8|f[m++]<<16|f[m++]<<24;f=y.g[0],m=y.g[1],_=y.g[2];let v=y.g[3],p;p=f+(v^m&(_^v))+E[0]+3614090360&4294967295,f=m+(p<<7&4294967295|p>>>25),p=v+(_^f&(m^_))+E[1]+3905402710&4294967295,v=f+(p<<12&4294967295|p>>>20),p=_+(m^v&(f^m))+E[2]+606105819&4294967295,_=v+(p<<17&4294967295|p>>>15),p=m+(f^_&(v^f))+E[3]+3250441966&4294967295,m=_+(p<<22&4294967295|p>>>10),p=f+(v^m&(_^v))+E[4]+4118548399&4294967295,f=m+(p<<7&4294967295|p>>>25),p=v+(_^f&(m^_))+E[5]+1200080426&4294967295,v=f+(p<<12&4294967295|p>>>20),p=_+(m^v&(f^m))+E[6]+2821735955&4294967295,_=v+(p<<17&4294967295|p>>>15),p=m+(f^_&(v^f))+E[7]+4249261313&4294967295,m=_+(p<<22&4294967295|p>>>10),p=f+(v^m&(_^v))+E[8]+1770035416&4294967295,f=m+(p<<7&4294967295|p>>>25),p=v+(_^f&(m^_))+E[9]+2336552879&4294967295,v=f+(p<<12&4294967295|p>>>20),p=_+(m^v&(f^m))+E[10]+4294925233&4294967295,_=v+(p<<17&4294967295|p>>>15),p=m+(f^_&(v^f))+E[11]+2304563134&4294967295,m=_+(p<<22&4294967295|p>>>10),p=f+(v^m&(_^v))+E[12]+1804603682&4294967295,f=m+(p<<7&4294967295|p>>>25),p=v+(_^f&(m^_))+E[13]+4254626195&4294967295,v=f+(p<<12&4294967295|p>>>20),p=_+(m^v&(f^m))+E[14]+2792965006&4294967295,_=v+(p<<17&4294967295|p>>>15),p=m+(f^_&(v^f))+E[15]+1236535329&4294967295,m=_+(p<<22&4294967295|p>>>10),p=f+(_^v&(m^_))+E[1]+4129170786&4294967295,f=m+(p<<5&4294967295|p>>>27),p=v+(m^_&(f^m))+E[6]+3225465664&4294967295,v=f+(p<<9&4294967295|p>>>23),p=_+(f^m&(v^f))+E[11]+643717713&4294967295,_=v+(p<<14&4294967295|p>>>18),p=m+(v^f&(_^v))+E[0]+3921069994&4294967295,m=_+(p<<20&4294967295|p>>>12),p=f+(_^v&(m^_))+E[5]+3593408605&4294967295,f=m+(p<<5&4294967295|p>>>27),p=v+(m^_&(f^m))+E[10]+38016083&4294967295,v=f+(p<<9&4294967295|p>>>23),p=_+(f^m&(v^f))+E[15]+3634488961&4294967295,_=v+(p<<14&4294967295|p>>>18),p=m+(v^f&(_^v))+E[4]+3889429448&4294967295,m=_+(p<<20&4294967295|p>>>12),p=f+(_^v&(m^_))+E[9]+568446438&4294967295,f=m+(p<<5&4294967295|p>>>27),p=v+(m^_&(f^m))+E[14]+3275163606&4294967295,v=f+(p<<9&4294967295|p>>>23),p=_+(f^m&(v^f))+E[3]+4107603335&4294967295,_=v+(p<<14&4294967295|p>>>18),p=m+(v^f&(_^v))+E[8]+1163531501&4294967295,m=_+(p<<20&4294967295|p>>>12),p=f+(_^v&(m^_))+E[13]+2850285829&4294967295,f=m+(p<<5&4294967295|p>>>27),p=v+(m^_&(f^m))+E[2]+4243563512&4294967295,v=f+(p<<9&4294967295|p>>>23),p=_+(f^m&(v^f))+E[7]+1735328473&4294967295,_=v+(p<<14&4294967295|p>>>18),p=m+(v^f&(_^v))+E[12]+2368359562&4294967295,m=_+(p<<20&4294967295|p>>>12),p=f+(m^_^v)+E[5]+4294588738&4294967295,f=m+(p<<4&4294967295|p>>>28),p=v+(f^m^_)+E[8]+2272392833&4294967295,v=f+(p<<11&4294967295|p>>>21),p=_+(v^f^m)+E[11]+1839030562&4294967295,_=v+(p<<16&4294967295|p>>>16),p=m+(_^v^f)+E[14]+4259657740&4294967295,m=_+(p<<23&4294967295|p>>>9),p=f+(m^_^v)+E[1]+2763975236&4294967295,f=m+(p<<4&4294967295|p>>>28),p=v+(f^m^_)+E[4]+1272893353&4294967295,v=f+(p<<11&4294967295|p>>>21),p=_+(v^f^m)+E[7]+4139469664&4294967295,_=v+(p<<16&4294967295|p>>>16),p=m+(_^v^f)+E[10]+3200236656&4294967295,m=_+(p<<23&4294967295|p>>>9),p=f+(m^_^v)+E[13]+681279174&4294967295,f=m+(p<<4&4294967295|p>>>28),p=v+(f^m^_)+E[0]+3936430074&4294967295,v=f+(p<<11&4294967295|p>>>21),p=_+(v^f^m)+E[3]+3572445317&4294967295,_=v+(p<<16&4294967295|p>>>16),p=m+(_^v^f)+E[6]+76029189&4294967295,m=_+(p<<23&4294967295|p>>>9),p=f+(m^_^v)+E[9]+3654602809&4294967295,f=m+(p<<4&4294967295|p>>>28),p=v+(f^m^_)+E[12]+3873151461&4294967295,v=f+(p<<11&4294967295|p>>>21),p=_+(v^f^m)+E[15]+530742520&4294967295,_=v+(p<<16&4294967295|p>>>16),p=m+(_^v^f)+E[2]+3299628645&4294967295,m=_+(p<<23&4294967295|p>>>9),p=f+(_^(m|~v))+E[0]+4096336452&4294967295,f=m+(p<<6&4294967295|p>>>26),p=v+(m^(f|~_))+E[7]+1126891415&4294967295,v=f+(p<<10&4294967295|p>>>22),p=_+(f^(v|~m))+E[14]+2878612391&4294967295,_=v+(p<<15&4294967295|p>>>17),p=m+(v^(_|~f))+E[5]+4237533241&4294967295,m=_+(p<<21&4294967295|p>>>11),p=f+(_^(m|~v))+E[12]+1700485571&4294967295,f=m+(p<<6&4294967295|p>>>26),p=v+(m^(f|~_))+E[3]+2399980690&4294967295,v=f+(p<<10&4294967295|p>>>22),p=_+(f^(v|~m))+E[10]+4293915773&4294967295,_=v+(p<<15&4294967295|p>>>17),p=m+(v^(_|~f))+E[1]+2240044497&4294967295,m=_+(p<<21&4294967295|p>>>11),p=f+(_^(m|~v))+E[8]+1873313359&4294967295,f=m+(p<<6&4294967295|p>>>26),p=v+(m^(f|~_))+E[15]+4264355552&4294967295,v=f+(p<<10&4294967295|p>>>22),p=_+(f^(v|~m))+E[6]+2734768916&4294967295,_=v+(p<<15&4294967295|p>>>17),p=m+(v^(_|~f))+E[13]+1309151649&4294967295,m=_+(p<<21&4294967295|p>>>11),p=f+(_^(m|~v))+E[4]+4149444226&4294967295,f=m+(p<<6&4294967295|p>>>26),p=v+(m^(f|~_))+E[11]+3174756917&4294967295,v=f+(p<<10&4294967295|p>>>22),p=_+(f^(v|~m))+E[2]+718787259&4294967295,_=v+(p<<15&4294967295|p>>>17),p=m+(v^(_|~f))+E[9]+3951481745&4294967295,y.g[0]=y.g[0]+f&4294967295,y.g[1]=y.g[1]+(_+(p<<21&4294967295|p>>>11))&4294967295,y.g[2]=y.g[2]+_&4294967295,y.g[3]=y.g[3]+v&4294967295}s.prototype.v=function(y,f){f===void 0&&(f=y.length);const m=f-this.blockSize,E=this.C;let _=this.h,v=0;for(;v<f;){if(_==0)for(;v<=m;)i(this,y,v),v+=this.blockSize;if(typeof y=="string"){for(;v<f;)if(E[_++]=y.charCodeAt(v++),_==this.blockSize){i(this,E),_=0;break}}else for(;v<f;)if(E[_++]=y[v++],_==this.blockSize){i(this,E),_=0;break}}this.h=_,this.o+=f},s.prototype.A=function(){var y=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);y[0]=128;for(var f=1;f<y.length-8;++f)y[f]=0;f=this.o*8;for(var m=y.length-8;m<y.length;++m)y[m]=f&255,f/=256;for(this.v(y),y=Array(16),f=0,m=0;m<4;++m)for(let E=0;E<32;E+=8)y[f++]=this.g[m]>>>E&255;return y};function a(y,f){var m=h;return Object.prototype.hasOwnProperty.call(m,y)?m[y]:m[y]=f(y)}function u(y,f){this.h=f;const m=[];let E=!0;for(let _=y.length-1;_>=0;_--){const v=y[_]|0;E&&v==f||(m[_]=v,E=!1)}this.g=m}var h={};function g(y){return-128<=y&&y<128?a(y,function(f){return new u([f|0],f<0?-1:0)}):new u([y|0],y<0?-1:0)}function d(y){if(isNaN(y)||!isFinite(y))return w;if(y<0)return O(d(-y));const f=[];let m=1;for(let E=0;y>=m;E++)f[E]=y/m|0,m*=4294967296;return new u(f,0)}function A(y,f){if(y.length==0)throw Error("number format error: empty string");if(f=f||10,f<2||36<f)throw Error("radix out of range: "+f);if(y.charAt(0)=="-")return O(A(y.substring(1),f));if(y.indexOf("-")>=0)throw Error('number format error: interior "-" character');const m=d(Math.pow(f,8));let E=w;for(let v=0;v<y.length;v+=8){var _=Math.min(8,y.length-v);const p=parseInt(y.substring(v,v+_),f);_<8?(_=d(Math.pow(f,_)),E=E.j(_).add(d(p))):(E=E.j(m),E=E.add(d(p)))}return E}var w=g(0),S=g(1),P=g(16777216);n=u.prototype,n.m=function(){if(U(this))return-O(this).m();let y=0,f=1;for(let m=0;m<this.g.length;m++){const E=this.i(m);y+=(E>=0?E:4294967296+E)*f,f*=4294967296}return y},n.toString=function(y){if(y=y||10,y<2||36<y)throw Error("radix out of range: "+y);if(N(this))return"0";if(U(this))return"-"+O(this).toString(y);const f=d(Math.pow(y,6));var m=this;let E="";for(;;){const _=mt(m,f).g;m=Z(m,_.j(f));let v=((m.g.length>0?m.g[0]:m.h)>>>0).toString(y);if(m=_,N(m))return v+E;for(;v.length<6;)v="0"+v;E=v+E}},n.i=function(y){return y<0?0:y<this.g.length?this.g[y]:this.h};function N(y){if(y.h!=0)return!1;for(let f=0;f<y.g.length;f++)if(y.g[f]!=0)return!1;return!0}function U(y){return y.h==-1}n.l=function(y){return y=Z(this,y),U(y)?-1:N(y)?0:1};function O(y){const f=y.g.length,m=[];for(let E=0;E<f;E++)m[E]=~y.g[E];return new u(m,~y.h).add(S)}n.abs=function(){return U(this)?O(this):this},n.add=function(y){const f=Math.max(this.g.length,y.g.length),m=[];let E=0;for(let _=0;_<=f;_++){let v=E+(this.i(_)&65535)+(y.i(_)&65535),p=(v>>>16)+(this.i(_)>>>16)+(y.i(_)>>>16);E=p>>>16,v&=65535,p&=65535,m[_]=p<<16|v}return new u(m,m[m.length-1]&-2147483648?-1:0)};function Z(y,f){return y.add(O(f))}n.j=function(y){if(N(this)||N(y))return w;if(U(this))return U(y)?O(this).j(O(y)):O(O(this).j(y));if(U(y))return O(this.j(O(y)));if(this.l(P)<0&&y.l(P)<0)return d(this.m()*y.m());const f=this.g.length+y.g.length,m=[];for(var E=0;E<2*f;E++)m[E]=0;for(E=0;E<this.g.length;E++)for(let _=0;_<y.g.length;_++){const v=this.i(E)>>>16,p=this.i(E)&65535,pt=y.i(_)>>>16,Wt=y.i(_)&65535;m[2*E+2*_]+=p*Wt,X(m,2*E+2*_),m[2*E+2*_+1]+=v*Wt,X(m,2*E+2*_+1),m[2*E+2*_+1]+=p*pt,X(m,2*E+2*_+1),m[2*E+2*_+2]+=v*pt,X(m,2*E+2*_+2)}for(y=0;y<f;y++)m[y]=m[2*y+1]<<16|m[2*y];for(y=f;y<2*f;y++)m[y]=0;return new u(m,0)};function X(y,f){for(;(y[f]&65535)!=y[f];)y[f+1]+=y[f]>>>16,y[f]&=65535,f++}function Q(y,f){this.g=y,this.h=f}function mt(y,f){if(N(f))throw Error("division by zero");if(N(y))return new Q(w,w);if(U(y))return f=mt(O(y),f),new Q(O(f.g),O(f.h));if(U(f))return f=mt(y,O(f)),new Q(O(f.g),f.h);if(y.g.length>30){if(U(y)||U(f))throw Error("slowDivide_ only works with positive integers.");for(var m=S,E=f;E.l(y)<=0;)m=Tt(m),E=Tt(E);var _=ct(m,1),v=ct(E,1);for(E=ct(E,2),m=ct(m,2);!N(E);){var p=v.add(E);p.l(y)<=0&&(_=_.add(m),v=p),E=ct(E,1),m=ct(m,1)}return f=Z(y,_.j(f)),new Q(_,f)}for(_=w;y.l(f)>=0;){for(m=Math.max(1,Math.floor(y.m()/f.m())),E=Math.ceil(Math.log(m)/Math.LN2),E=E<=48?1:Math.pow(2,E-48),v=d(m),p=v.j(f);U(p)||p.l(y)>0;)m-=E,v=d(m),p=v.j(f);N(v)&&(v=S),_=_.add(v),y=Z(y,p)}return new Q(_,y)}n.B=function(y){return mt(this,y).h},n.and=function(y){const f=Math.max(this.g.length,y.g.length),m=[];for(let E=0;E<f;E++)m[E]=this.i(E)&y.i(E);return new u(m,this.h&y.h)},n.or=function(y){const f=Math.max(this.g.length,y.g.length),m=[];for(let E=0;E<f;E++)m[E]=this.i(E)|y.i(E);return new u(m,this.h|y.h)},n.xor=function(y){const f=Math.max(this.g.length,y.g.length),m=[];for(let E=0;E<f;E++)m[E]=this.i(E)^y.i(E);return new u(m,this.h^y.h)};function Tt(y){const f=y.g.length+1,m=[];for(let E=0;E<f;E++)m[E]=y.i(E)<<1|y.i(E-1)>>>31;return new u(m,y.h)}function ct(y,f){const m=f>>5;f%=32;const E=y.g.length-m,_=[];for(let v=0;v<E;v++)_[v]=f>0?y.i(v+m)>>>f|y.i(v+m+1)<<32-f:y.i(v+m);return new u(_,y.h)}s.prototype.digest=s.prototype.A,s.prototype.reset=s.prototype.u,s.prototype.update=s.prototype.v,u.prototype.add=u.prototype.add,u.prototype.multiply=u.prototype.j,u.prototype.modulo=u.prototype.B,u.prototype.compare=u.prototype.l,u.prototype.toNumber=u.prototype.m,u.prototype.toString=u.prototype.toString,u.prototype.getBits=u.prototype.i,u.fromNumber=d,u.fromString=A,Xr=u}).apply(typeof bi<"u"?bi:typeof self<"u"?self:typeof window<"u"?window:{});var En=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var Po,$e,Vo,Rn,Nr,Do,No,Oo;(function(){var n,t=Object.defineProperty;function e(r){r=[typeof globalThis=="object"&&globalThis,r,typeof window=="object"&&window,typeof self=="object"&&self,typeof En=="object"&&En];for(var o=0;o<r.length;++o){var l=r[o];if(l&&l.Math==Math)return l}throw Error("Cannot find global object")}var s=e(this);function i(r,o){if(o)t:{var l=s;r=r.split(".");for(var c=0;c<r.length-1;c++){var T=r[c];if(!(T in l))break t;l=l[T]}r=r[r.length-1],c=l[r],o=o(c),o!=c&&o!=null&&t(l,r,{configurable:!0,writable:!0,value:o})}}i("Symbol.dispose",function(r){return r||Symbol("Symbol.dispose")}),i("Array.prototype.values",function(r){return r||function(){return this[Symbol.iterator]()}}),i("Object.entries",function(r){return r||function(o){var l=[],c;for(c in o)Object.prototype.hasOwnProperty.call(o,c)&&l.push([c,o[c]]);return l}});var a=a||{},u=this||self;function h(r){var o=typeof r;return o=="object"&&r!=null||o=="function"}function g(r,o,l){return r.call.apply(r.bind,arguments)}function d(r,o,l){return d=g,d.apply(null,arguments)}function A(r,o){var l=Array.prototype.slice.call(arguments,1);return function(){var c=l.slice();return c.push.apply(c,arguments),r.apply(this,c)}}function w(r,o){function l(){}l.prototype=o.prototype,r.Z=o.prototype,r.prototype=new l,r.prototype.constructor=r,r.Ob=function(c,T,I){for(var C=Array(arguments.length-2),M=2;M<arguments.length;M++)C[M-2]=arguments[M];return o.prototype[T].apply(c,C)}}var S=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?r=>r&&AsyncContext.Snapshot.wrap(r):r=>r;function P(r){const o=r.length;if(o>0){const l=Array(o);for(let c=0;c<o;c++)l[c]=r[c];return l}return[]}function N(r,o){for(let c=1;c<arguments.length;c++){const T=arguments[c];var l=typeof T;if(l=l!="object"?l:T?Array.isArray(T)?"array":l:"null",l=="array"||l=="object"&&typeof T.length=="number"){l=r.length||0;const I=T.length||0;r.length=l+I;for(let C=0;C<I;C++)r[l+C]=T[C]}else r.push(T)}}class U{constructor(o,l){this.i=o,this.j=l,this.h=0,this.g=null}get(){let o;return this.h>0?(this.h--,o=this.g,this.g=o.next,o.next=null):o=this.i(),o}}function O(r){u.setTimeout(()=>{throw r},0)}function Z(){var r=y;let o=null;return r.g&&(o=r.g,r.g=r.g.next,r.g||(r.h=null),o.next=null),o}class X{constructor(){this.h=this.g=null}add(o,l){const c=Q.get();c.set(o,l),this.h?this.h.next=c:this.g=c,this.h=c}}var Q=new U(()=>new mt,r=>r.reset());class mt{constructor(){this.next=this.g=this.h=null}set(o,l){this.h=o,this.g=l,this.next=null}reset(){this.next=this.g=this.h=null}}let Tt,ct=!1,y=new X,f=()=>{const r=Promise.resolve(void 0);Tt=()=>{r.then(m)}};function m(){for(var r;r=Z();){try{r.h.call(r.g)}catch(l){O(l)}var o=Q;o.j(r),o.h<100&&(o.h++,r.next=o.g,o.g=r)}ct=!1}function E(){this.u=this.u,this.C=this.C}E.prototype.u=!1,E.prototype.dispose=function(){this.u||(this.u=!0,this.N())},E.prototype[Symbol.dispose]=function(){this.dispose()},E.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function _(r,o){this.type=r,this.g=this.target=o,this.defaultPrevented=!1}_.prototype.h=function(){this.defaultPrevented=!0};var v=(function(){if(!u.addEventListener||!Object.defineProperty)return!1;var r=!1,o=Object.defineProperty({},"passive",{get:function(){r=!0}});try{const l=()=>{};u.addEventListener("test",l,o),u.removeEventListener("test",l,o)}catch{}return r})();function p(r){return/^[\s\xa0]*$/.test(r)}function pt(r,o){_.call(this,r?r.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,r&&this.init(r,o)}w(pt,_),pt.prototype.init=function(r,o){const l=this.type=r.type,c=r.changedTouches&&r.changedTouches.length?r.changedTouches[0]:null;this.target=r.target||r.srcElement,this.g=o,o=r.relatedTarget,o||(l=="mouseover"?o=r.fromElement:l=="mouseout"&&(o=r.toElement)),this.relatedTarget=o,c?(this.clientX=c.clientX!==void 0?c.clientX:c.pageX,this.clientY=c.clientY!==void 0?c.clientY:c.pageY,this.screenX=c.screenX||0,this.screenY=c.screenY||0):(this.clientX=r.clientX!==void 0?r.clientX:r.pageX,this.clientY=r.clientY!==void 0?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0),this.button=r.button,this.key=r.key||"",this.ctrlKey=r.ctrlKey,this.altKey=r.altKey,this.shiftKey=r.shiftKey,this.metaKey=r.metaKey,this.pointerId=r.pointerId||0,this.pointerType=r.pointerType,this.state=r.state,this.i=r,r.defaultPrevented&&pt.Z.h.call(this)},pt.prototype.h=function(){pt.Z.h.call(this);const r=this.i;r.preventDefault?r.preventDefault():r.returnValue=!1};var Wt="closure_listenable_"+(Math.random()*1e6|0),ya=0;function Ea(r,o,l,c,T){this.listener=r,this.proxy=null,this.src=o,this.type=l,this.capture=!!c,this.ha=T,this.key=++ya,this.da=this.fa=!1}function rn(r){r.da=!0,r.listener=null,r.proxy=null,r.src=null,r.ha=null}function sn(r,o,l){for(const c in r)o.call(l,r[c],c,r)}function Ta(r,o){for(const l in r)o.call(void 0,r[l],l,r)}function ms(r){const o={};for(const l in r)o[l]=r[l];return o}const _s="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function ys(r,o){let l,c;for(let T=1;T<arguments.length;T++){c=arguments[T];for(l in c)r[l]=c[l];for(let I=0;I<_s.length;I++)l=_s[I],Object.prototype.hasOwnProperty.call(c,l)&&(r[l]=c[l])}}function on(r){this.src=r,this.g={},this.h=0}on.prototype.add=function(r,o,l,c,T){const I=r.toString();r=this.g[I],r||(r=this.g[I]=[],this.h++);const C=Wn(r,o,c,T);return C>-1?(o=r[C],l||(o.fa=!1)):(o=new Ea(o,this.src,I,!!c,T),o.fa=l,r.push(o)),o};function Kn(r,o){const l=o.type;if(l in r.g){var c=r.g[l],T=Array.prototype.indexOf.call(c,o,void 0),I;(I=T>=0)&&Array.prototype.splice.call(c,T,1),I&&(rn(o),r.g[l].length==0&&(delete r.g[l],r.h--))}}function Wn(r,o,l,c){for(let T=0;T<r.length;++T){const I=r[T];if(!I.da&&I.listener==o&&I.capture==!!l&&I.ha==c)return T}return-1}var Xn="closure_lm_"+(Math.random()*1e6|0),Yn={};function Es(r,o,l,c,T){if(Array.isArray(o)){for(let I=0;I<o.length;I++)Es(r,o[I],l,c,T);return null}return l=As(l),r&&r[Wt]?r.J(o,l,h(c)?!!c.capture:!1,T):va(r,o,l,!1,c,T)}function va(r,o,l,c,T,I){if(!o)throw Error("Invalid event type");const C=h(T)?!!T.capture:!!T;let M=Zn(r);if(M||(r[Xn]=M=new on(r)),l=M.add(o,l,c,C,I),l.proxy)return l;if(c=Aa(),l.proxy=c,c.src=r,c.listener=l,r.addEventListener)v||(T=C),T===void 0&&(T=!1),r.addEventListener(o.toString(),c,T);else if(r.attachEvent)r.attachEvent(vs(o.toString()),c);else if(r.addListener&&r.removeListener)r.addListener(c);else throw Error("addEventListener and attachEvent are unavailable.");return l}function Aa(){function r(l){return o.call(r.src,r.listener,l)}const o=Ia;return r}function Ts(r,o,l,c,T){if(Array.isArray(o))for(var I=0;I<o.length;I++)Ts(r,o[I],l,c,T);else c=h(c)?!!c.capture:!!c,l=As(l),r&&r[Wt]?(r=r.i,I=String(o).toString(),I in r.g&&(o=r.g[I],l=Wn(o,l,c,T),l>-1&&(rn(o[l]),Array.prototype.splice.call(o,l,1),o.length==0&&(delete r.g[I],r.h--)))):r&&(r=Zn(r))&&(o=r.g[o.toString()],r=-1,o&&(r=Wn(o,l,c,T)),(l=r>-1?o[r]:null)&&Jn(l))}function Jn(r){if(typeof r!="number"&&r&&!r.da){var o=r.src;if(o&&o[Wt])Kn(o.i,r);else{var l=r.type,c=r.proxy;o.removeEventListener?o.removeEventListener(l,c,r.capture):o.detachEvent?o.detachEvent(vs(l),c):o.addListener&&o.removeListener&&o.removeListener(c),(l=Zn(o))?(Kn(l,r),l.h==0&&(l.src=null,o[Xn]=null)):rn(r)}}}function vs(r){return r in Yn?Yn[r]:Yn[r]="on"+r}function Ia(r,o){if(r.da)r=!0;else{o=new pt(o,this);const l=r.listener,c=r.ha||r.src;r.fa&&Jn(r),r=l.call(c,o)}return r}function Zn(r){return r=r[Xn],r instanceof on?r:null}var tr="__closure_events_fn_"+(Math.random()*1e9>>>0);function As(r){return typeof r=="function"?r:(r[tr]||(r[tr]=function(o){return r.handleEvent(o)}),r[tr])}function at(){E.call(this),this.i=new on(this),this.M=this,this.G=null}w(at,E),at.prototype[Wt]=!0,at.prototype.removeEventListener=function(r,o,l,c){Ts(this,r,o,l,c)};function ht(r,o){var l,c=r.G;if(c)for(l=[];c;c=c.G)l.push(c);if(r=r.M,c=o.type||o,typeof o=="string")o=new _(o,r);else if(o instanceof _)o.target=o.target||r;else{var T=o;o=new _(c,r),ys(o,T)}T=!0;let I,C;if(l)for(C=l.length-1;C>=0;C--)I=o.g=l[C],T=an(I,c,!0,o)&&T;if(I=o.g=r,T=an(I,c,!0,o)&&T,T=an(I,c,!1,o)&&T,l)for(C=0;C<l.length;C++)I=o.g=l[C],T=an(I,c,!1,o)&&T}at.prototype.N=function(){if(at.Z.N.call(this),this.i){var r=this.i;for(const o in r.g){const l=r.g[o];for(let c=0;c<l.length;c++)rn(l[c]);delete r.g[o],r.h--}}this.G=null},at.prototype.J=function(r,o,l,c){return this.i.add(String(r),o,!1,l,c)},at.prototype.K=function(r,o,l,c){return this.i.add(String(r),o,!0,l,c)};function an(r,o,l,c){if(o=r.i.g[String(o)],!o)return!0;o=o.concat();let T=!0;for(let I=0;I<o.length;++I){const C=o[I];if(C&&!C.da&&C.capture==l){const M=C.listener,Y=C.ha||C.src;C.fa&&Kn(r.i,C),T=M.call(Y,c)!==!1&&T}}return T&&!c.defaultPrevented}function wa(r,o){if(typeof r!="function")if(r&&typeof r.handleEvent=="function")r=d(r.handleEvent,r);else throw Error("Invalid listener argument");return Number(o)>2147483647?-1:u.setTimeout(r,o||0)}function Is(r){r.g=wa(()=>{r.g=null,r.i&&(r.i=!1,Is(r))},r.l);const o=r.h;r.h=null,r.m.apply(null,o)}class Ra extends E{constructor(o,l){super(),this.m=o,this.l=l,this.h=null,this.i=!1,this.g=null}j(o){this.h=arguments,this.g?this.i=!0:Is(this)}N(){super.N(),this.g&&(u.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Re(r){E.call(this),this.h=r,this.g={}}w(Re,E);var ws=[];function Rs(r){sn(r.g,function(o,l){this.g.hasOwnProperty(l)&&Jn(o)},r),r.g={}}Re.prototype.N=function(){Re.Z.N.call(this),Rs(this)},Re.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var er=u.JSON.stringify,Sa=u.JSON.parse,Ca=class{stringify(r){return u.JSON.stringify(r,void 0)}parse(r){return u.JSON.parse(r,void 0)}};function Ss(){}function Cs(){}var Se={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function nr(){_.call(this,"d")}w(nr,_);function rr(){_.call(this,"c")}w(rr,_);var Xt={},bs=null;function ln(){return bs=bs||new at}Xt.Ia="serverreachability";function Ps(r){_.call(this,Xt.Ia,r)}w(Ps,_);function Ce(r){const o=ln();ht(o,new Ps(o))}Xt.STAT_EVENT="statevent";function Vs(r,o){_.call(this,Xt.STAT_EVENT,r),this.stat=o}w(Vs,_);function ft(r){const o=ln();ht(o,new Vs(o,r))}Xt.Ja="timingevent";function Ds(r,o){_.call(this,Xt.Ja,r),this.size=o}w(Ds,_);function be(r,o){if(typeof r!="function")throw Error("Fn must not be null and must be a function");return u.setTimeout(function(){r()},o)}function Pe(){this.g=!0}Pe.prototype.ua=function(){this.g=!1};function ba(r,o,l,c,T,I){r.info(function(){if(r.g)if(I){var C="",M=I.split("&");for(let j=0;j<M.length;j++){var Y=M[j].split("=");if(Y.length>1){const tt=Y[0];Y=Y[1];const Rt=tt.split("_");C=Rt.length>=2&&Rt[1]=="type"?C+(tt+"="+Y+"&"):C+(tt+"=redacted&")}}}else C=null;else C=I;return"XMLHTTP REQ ("+c+") [attempt "+T+"]: "+o+`
`+l+`
`+C})}function Pa(r,o,l,c,T,I,C){r.info(function(){return"XMLHTTP RESP ("+c+") [ attempt "+T+"]: "+o+`
`+l+`
`+I+" "+C})}function ce(r,o,l,c){r.info(function(){return"XMLHTTP TEXT ("+o+"): "+Da(r,l)+(c?" "+c:"")})}function Va(r,o){r.info(function(){return"TIMEOUT: "+o})}Pe.prototype.info=function(){};function Da(r,o){if(!r.g)return o;if(!o)return null;try{const I=JSON.parse(o);if(I){for(r=0;r<I.length;r++)if(Array.isArray(I[r])){var l=I[r];if(!(l.length<2)){var c=l[1];if(Array.isArray(c)&&!(c.length<1)){var T=c[0];if(T!="noop"&&T!="stop"&&T!="close")for(let C=1;C<c.length;C++)c[C]=""}}}}return er(I)}catch{return o}}var un={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},Ns={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},Os;function sr(){}w(sr,Ss),sr.prototype.g=function(){return new XMLHttpRequest},Os=new sr;function Ve(r){return encodeURIComponent(String(r))}function Na(r){var o=1;r=r.split(":");const l=[];for(;o>0&&r.length;)l.push(r.shift()),o--;return r.length&&l.push(r.join(":")),l}function Ot(r,o,l,c){this.j=r,this.i=o,this.l=l,this.S=c||1,this.V=new Re(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new Ms}function Ms(){this.i=null,this.g="",this.h=!1}var ks={},ir={};function or(r,o,l){r.M=1,r.A=hn(wt(o)),r.u=l,r.R=!0,xs(r,null)}function xs(r,o){r.F=Date.now(),cn(r),r.B=wt(r.A);var l=r.B,c=r.S;Array.isArray(c)||(c=[String(c)]),Ws(l.i,"t",c),r.C=0,l=r.j.L,r.h=new Ms,r.g=di(r.j,l?o:null,!r.u),r.P>0&&(r.O=new Ra(d(r.Y,r,r.g),r.P)),o=r.V,l=r.g,c=r.ba;var T="readystatechange";Array.isArray(T)||(T&&(ws[0]=T.toString()),T=ws);for(let I=0;I<T.length;I++){const C=Es(l,T[I],c||o.handleEvent,!1,o.h||o);if(!C)break;o.g[C.key]=C}o=r.J?ms(r.J):{},r.u?(r.v||(r.v="POST"),o["Content-Type"]="application/x-www-form-urlencoded",r.g.ea(r.B,r.v,r.u,o)):(r.v="GET",r.g.ea(r.B,r.v,null,o)),Ce(),ba(r.i,r.v,r.B,r.l,r.S,r.u)}Ot.prototype.ba=function(r){r=r.target;const o=this.O;o&&xt(r)==3?o.j():this.Y(r)},Ot.prototype.Y=function(r){try{if(r==this.g)t:{const M=xt(this.g),Y=this.g.ya(),j=this.g.ca();if(!(M<3)&&(M!=3||this.g&&(this.h.h||this.g.la()||ni(this.g)))){this.K||M!=4||Y==7||(Y==8||j<=0?Ce(3):Ce(2)),ar(this);var o=this.g.ca();this.X=o;var l=Oa(this);if(this.o=o==200,Pa(this.i,this.v,this.B,this.l,this.S,M,o),this.o){if(this.U&&!this.L){e:{if(this.g){var c,T=this.g;if((c=T.g?T.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!p(c)){var I=c;break e}}I=null}if(r=I)ce(this.i,this.l,r,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,lr(this,r);else{this.o=!1,this.m=3,ft(12),Yt(this),De(this);break t}}if(this.R){r=!0;let tt;for(;!this.K&&this.C<l.length;)if(tt=Ma(this,l),tt==ir){M==4&&(this.m=4,ft(14),r=!1),ce(this.i,this.l,null,"[Incomplete Response]");break}else if(tt==ks){this.m=4,ft(15),ce(this.i,this.l,l,"[Invalid Chunk]"),r=!1;break}else ce(this.i,this.l,tt,null),lr(this,tt);if(Ls(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),M!=4||l.length!=0||this.h.h||(this.m=1,ft(16),r=!1),this.o=this.o&&r,!r)ce(this.i,this.l,l,"[Invalid Chunked Response]"),Yt(this),De(this);else if(l.length>0&&!this.W){this.W=!0;var C=this.j;C.g==this&&C.aa&&!C.P&&(C.j.info("Great, no buffering proxy detected. Bytes received: "+l.length),mr(C),C.P=!0,ft(11))}}else ce(this.i,this.l,l,null),lr(this,l);M==4&&Yt(this),this.o&&!this.K&&(M==4?ui(this.j,this):(this.o=!1,cn(this)))}else Ka(this.g),o==400&&l.indexOf("Unknown SID")>0?(this.m=3,ft(12)):(this.m=0,ft(13)),Yt(this),De(this)}}}catch{}finally{}};function Oa(r){if(!Ls(r))return r.g.la();const o=ni(r.g);if(o==="")return"";let l="";const c=o.length,T=xt(r.g)==4;if(!r.h.i){if(typeof TextDecoder>"u")return Yt(r),De(r),"";r.h.i=new u.TextDecoder}for(let I=0;I<c;I++)r.h.h=!0,l+=r.h.i.decode(o[I],{stream:!(T&&I==c-1)});return o.length=0,r.h.g+=l,r.C=0,r.h.g}function Ls(r){return r.g?r.v=="GET"&&r.M!=2&&r.j.Aa:!1}function Ma(r,o){var l=r.C,c=o.indexOf(`
`,l);return c==-1?ir:(l=Number(o.substring(l,c)),isNaN(l)?ks:(c+=1,c+l>o.length?ir:(o=o.slice(c,c+l),r.C=c+l,o)))}Ot.prototype.cancel=function(){this.K=!0,Yt(this)};function cn(r){r.T=Date.now()+r.H,Fs(r,r.H)}function Fs(r,o){if(r.D!=null)throw Error("WatchDog timer not null");r.D=be(d(r.aa,r),o)}function ar(r){r.D&&(u.clearTimeout(r.D),r.D=null)}Ot.prototype.aa=function(){this.D=null;const r=Date.now();r-this.T>=0?(Va(this.i,this.B),this.M!=2&&(Ce(),ft(17)),Yt(this),this.m=2,De(this)):Fs(this,this.T-r)};function De(r){r.j.I==0||r.K||ui(r.j,r)}function Yt(r){ar(r);var o=r.O;o&&typeof o.dispose=="function"&&o.dispose(),r.O=null,Rs(r.V),r.g&&(o=r.g,r.g=null,o.abort(),o.dispose())}function lr(r,o){try{var l=r.j;if(l.I!=0&&(l.g==r||ur(l.h,r))){if(!r.L&&ur(l.h,r)&&l.I==3){try{var c=l.Ba.g.parse(o)}catch{c=null}if(Array.isArray(c)&&c.length==3){var T=c;if(T[0]==0){t:if(!l.v){if(l.g)if(l.g.F+3e3<r.F)mn(l),pn(l);else break t;gr(l),ft(18)}}else l.xa=T[1],0<l.xa-l.K&&T[2]<37500&&l.F&&l.A==0&&!l.C&&(l.C=be(d(l.Va,l),6e3));js(l.h)<=1&&l.ta&&(l.ta=void 0)}else Zt(l,11)}else if((r.L||l.g==r)&&mn(l),!p(o))for(T=l.Ba.g.parse(o),o=0;o<T.length;o++){let j=T[o];const tt=j[0];if(!(tt<=l.K))if(l.K=tt,j=j[1],l.I==2)if(j[0]=="c"){l.M=j[1],l.ba=j[2];const Rt=j[3];Rt!=null&&(l.ka=Rt,l.j.info("VER="+l.ka));const te=j[4];te!=null&&(l.za=te,l.j.info("SVER="+l.za));const Lt=j[5];Lt!=null&&typeof Lt=="number"&&Lt>0&&(c=1.5*Lt,l.O=c,l.j.info("backChannelRequestTimeoutMs_="+c)),c=l;const Ft=r.g;if(Ft){const yn=Ft.g?Ft.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(yn){var I=c.h;I.g||yn.indexOf("spdy")==-1&&yn.indexOf("quic")==-1&&yn.indexOf("h2")==-1||(I.j=I.l,I.g=new Set,I.h&&(cr(I,I.h),I.h=null))}if(c.G){const _r=Ft.g?Ft.g.getResponseHeader("X-HTTP-Session-Id"):null;_r&&(c.wa=_r,$(c.J,c.G,_r))}}l.I=3,l.l&&l.l.ra(),l.aa&&(l.T=Date.now()-r.F,l.j.info("Handshake RTT: "+l.T+"ms")),c=l;var C=r;if(c.na=fi(c,c.L?c.ba:null,c.W),C.L){$s(c.h,C);var M=C,Y=c.O;Y&&(M.H=Y),M.D&&(ar(M),cn(M)),c.g=C}else ai(c);l.i.length>0&&gn(l)}else j[0]!="stop"&&j[0]!="close"||Zt(l,7);else l.I==3&&(j[0]=="stop"||j[0]=="close"?j[0]=="stop"?Zt(l,7):pr(l):j[0]!="noop"&&l.l&&l.l.qa(j),l.A=0)}}Ce(4)}catch{}}var ka=class{constructor(r,o){this.g=r,this.map=o}};function Us(r){this.l=r||10,u.PerformanceNavigationTiming?(r=u.performance.getEntriesByType("navigation"),r=r.length>0&&(r[0].nextHopProtocol=="hq"||r[0].nextHopProtocol=="h2")):r=!!(u.chrome&&u.chrome.loadTimes&&u.chrome.loadTimes()&&u.chrome.loadTimes().wasFetchedViaSpdy),this.j=r?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function Bs(r){return r.h?!0:r.g?r.g.size>=r.j:!1}function js(r){return r.h?1:r.g?r.g.size:0}function ur(r,o){return r.h?r.h==o:r.g?r.g.has(o):!1}function cr(r,o){r.g?r.g.add(o):r.h=o}function $s(r,o){r.h&&r.h==o?r.h=null:r.g&&r.g.has(o)&&r.g.delete(o)}Us.prototype.cancel=function(){if(this.i=qs(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const r of this.g.values())r.cancel();this.g.clear()}};function qs(r){if(r.h!=null)return r.i.concat(r.h.G);if(r.g!=null&&r.g.size!==0){let o=r.i;for(const l of r.g.values())o=o.concat(l.G);return o}return P(r.i)}var Hs=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function xa(r,o){if(r){r=r.split("&");for(let l=0;l<r.length;l++){const c=r[l].indexOf("=");let T,I=null;c>=0?(T=r[l].substring(0,c),I=r[l].substring(c+1)):T=r[l],o(T,I?decodeURIComponent(I.replace(/\+/g," ")):"")}}}function Mt(r){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let o;r instanceof Mt?(this.l=r.l,Ne(this,r.j),this.o=r.o,this.g=r.g,Oe(this,r.u),this.h=r.h,hr(this,Xs(r.i)),this.m=r.m):r&&(o=String(r).match(Hs))?(this.l=!1,Ne(this,o[1]||"",!0),this.o=Me(o[2]||""),this.g=Me(o[3]||"",!0),Oe(this,o[4]),this.h=Me(o[5]||"",!0),hr(this,o[6]||"",!0),this.m=Me(o[7]||"")):(this.l=!1,this.i=new xe(null,this.l))}Mt.prototype.toString=function(){const r=[];var o=this.j;o&&r.push(ke(o,zs,!0),":");var l=this.g;return(l||o=="file")&&(r.push("//"),(o=this.o)&&r.push(ke(o,zs,!0),"@"),r.push(Ve(l).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),l=this.u,l!=null&&r.push(":",String(l))),(l=this.h)&&(this.g&&l.charAt(0)!="/"&&r.push("/"),r.push(ke(l,l.charAt(0)=="/"?Ua:Fa,!0))),(l=this.i.toString())&&r.push("?",l),(l=this.m)&&r.push("#",ke(l,ja)),r.join("")},Mt.prototype.resolve=function(r){const o=wt(this);let l=!!r.j;l?Ne(o,r.j):l=!!r.o,l?o.o=r.o:l=!!r.g,l?o.g=r.g:l=r.u!=null;var c=r.h;if(l)Oe(o,r.u);else if(l=!!r.h){if(c.charAt(0)!="/")if(this.g&&!this.h)c="/"+c;else{var T=o.h.lastIndexOf("/");T!=-1&&(c=o.h.slice(0,T+1)+c)}if(T=c,T==".."||T==".")c="";else if(T.indexOf("./")!=-1||T.indexOf("/.")!=-1){c=T.lastIndexOf("/",0)==0,T=T.split("/");const I=[];for(let C=0;C<T.length;){const M=T[C++];M=="."?c&&C==T.length&&I.push(""):M==".."?((I.length>1||I.length==1&&I[0]!="")&&I.pop(),c&&C==T.length&&I.push("")):(I.push(M),c=!0)}c=I.join("/")}else c=T}return l?o.h=c:l=r.i.toString()!=="",l?hr(o,Xs(r.i)):l=!!r.m,l&&(o.m=r.m),o};function wt(r){return new Mt(r)}function Ne(r,o,l){r.j=l?Me(o,!0):o,r.j&&(r.j=r.j.replace(/:$/,""))}function Oe(r,o){if(o){if(o=Number(o),isNaN(o)||o<0)throw Error("Bad port number "+o);r.u=o}else r.u=null}function hr(r,o,l){o instanceof xe?(r.i=o,$a(r.i,r.l)):(l||(o=ke(o,Ba)),r.i=new xe(o,r.l))}function $(r,o,l){r.i.set(o,l)}function hn(r){return $(r,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),r}function Me(r,o){return r?o?decodeURI(r.replace(/%25/g,"%2525")):decodeURIComponent(r):""}function ke(r,o,l){return typeof r=="string"?(r=encodeURI(r).replace(o,La),l&&(r=r.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),r):null}function La(r){return r=r.charCodeAt(0),"%"+(r>>4&15).toString(16)+(r&15).toString(16)}var zs=/[#\/\?@]/g,Fa=/[#\?:]/g,Ua=/[#\?]/g,Ba=/[#\?@]/g,ja=/#/g;function xe(r,o){this.h=this.g=null,this.i=r||null,this.j=!!o}function Jt(r){r.g||(r.g=new Map,r.h=0,r.i&&xa(r.i,function(o,l){r.add(decodeURIComponent(o.replace(/\+/g," ")),l)}))}n=xe.prototype,n.add=function(r,o){Jt(this),this.i=null,r=he(this,r);let l=this.g.get(r);return l||this.g.set(r,l=[]),l.push(o),this.h+=1,this};function Gs(r,o){Jt(r),o=he(r,o),r.g.has(o)&&(r.i=null,r.h-=r.g.get(o).length,r.g.delete(o))}function Qs(r,o){return Jt(r),o=he(r,o),r.g.has(o)}n.forEach=function(r,o){Jt(this),this.g.forEach(function(l,c){l.forEach(function(T){r.call(o,T,c,this)},this)},this)};function Ks(r,o){Jt(r);let l=[];if(typeof o=="string")Qs(r,o)&&(l=l.concat(r.g.get(he(r,o))));else for(r=Array.from(r.g.values()),o=0;o<r.length;o++)l=l.concat(r[o]);return l}n.set=function(r,o){return Jt(this),this.i=null,r=he(this,r),Qs(this,r)&&(this.h-=this.g.get(r).length),this.g.set(r,[o]),this.h+=1,this},n.get=function(r,o){return r?(r=Ks(this,r),r.length>0?String(r[0]):o):o};function Ws(r,o,l){Gs(r,o),l.length>0&&(r.i=null,r.g.set(he(r,o),P(l)),r.h+=l.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const r=[],o=Array.from(this.g.keys());for(let c=0;c<o.length;c++){var l=o[c];const T=Ve(l);l=Ks(this,l);for(let I=0;I<l.length;I++){let C=T;l[I]!==""&&(C+="="+Ve(l[I])),r.push(C)}}return this.i=r.join("&")};function Xs(r){const o=new xe;return o.i=r.i,r.g&&(o.g=new Map(r.g),o.h=r.h),o}function he(r,o){return o=String(o),r.j&&(o=o.toLowerCase()),o}function $a(r,o){o&&!r.j&&(Jt(r),r.i=null,r.g.forEach(function(l,c){const T=c.toLowerCase();c!=T&&(Gs(this,c),Ws(this,T,l))},r)),r.j=o}function qa(r,o){const l=new Pe;if(u.Image){const c=new Image;c.onload=A(kt,l,"TestLoadImage: loaded",!0,o,c),c.onerror=A(kt,l,"TestLoadImage: error",!1,o,c),c.onabort=A(kt,l,"TestLoadImage: abort",!1,o,c),c.ontimeout=A(kt,l,"TestLoadImage: timeout",!1,o,c),u.setTimeout(function(){c.ontimeout&&c.ontimeout()},1e4),c.src=r}else o(!1)}function Ha(r,o){const l=new Pe,c=new AbortController,T=setTimeout(()=>{c.abort(),kt(l,"TestPingServer: timeout",!1,o)},1e4);fetch(r,{signal:c.signal}).then(I=>{clearTimeout(T),I.ok?kt(l,"TestPingServer: ok",!0,o):kt(l,"TestPingServer: server error",!1,o)}).catch(()=>{clearTimeout(T),kt(l,"TestPingServer: error",!1,o)})}function kt(r,o,l,c,T){try{T&&(T.onload=null,T.onerror=null,T.onabort=null,T.ontimeout=null),c(l)}catch{}}function za(){this.g=new Ca}function fr(r){this.i=r.Sb||null,this.h=r.ab||!1}w(fr,Ss),fr.prototype.g=function(){return new fn(this.i,this.h)};function fn(r,o){at.call(this),this.H=r,this.o=o,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}w(fn,at),n=fn.prototype,n.open=function(r,o){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=r,this.D=o,this.readyState=1,Fe(this)},n.send=function(r){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const o={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};r&&(o.body=r),(this.H||u).fetch(new Request(this.D,o)).then(this.Pa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,Le(this)),this.readyState=0},n.Pa=function(r){if(this.g&&(this.l=r,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=r.headers,this.readyState=2,Fe(this)),this.g&&(this.readyState=3,Fe(this),this.g)))if(this.responseType==="arraybuffer")r.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof u.ReadableStream<"u"&&"body"in r){if(this.j=r.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;Ys(this)}else r.text().then(this.Oa.bind(this),this.ga.bind(this))};function Ys(r){r.j.read().then(r.Ma.bind(r)).catch(r.ga.bind(r))}n.Ma=function(r){if(this.g){if(this.o&&r.value)this.response.push(r.value);else if(!this.o){var o=r.value?r.value:new Uint8Array(0);(o=this.B.decode(o,{stream:!r.done}))&&(this.response=this.responseText+=o)}r.done?Le(this):Fe(this),this.readyState==3&&Ys(this)}},n.Oa=function(r){this.g&&(this.response=this.responseText=r,Le(this))},n.Na=function(r){this.g&&(this.response=r,Le(this))},n.ga=function(){this.g&&Le(this)};function Le(r){r.readyState=4,r.l=null,r.j=null,r.B=null,Fe(r)}n.setRequestHeader=function(r,o){this.A.append(r,o)},n.getResponseHeader=function(r){return this.h&&this.h.get(r.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const r=[],o=this.h.entries();for(var l=o.next();!l.done;)l=l.value,r.push(l[0]+": "+l[1]),l=o.next();return r.join(`\r
`)};function Fe(r){r.onreadystatechange&&r.onreadystatechange.call(r)}Object.defineProperty(fn.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(r){this.m=r?"include":"same-origin"}});function Js(r){let o="";return sn(r,function(l,c){o+=c,o+=":",o+=l,o+=`\r
`}),o}function dr(r,o,l){t:{for(c in l){var c=!1;break t}c=!0}c||(l=Js(l),typeof r=="string"?l!=null&&Ve(l):$(r,o,l))}function H(r){at.call(this),this.headers=new Map,this.L=r||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}w(H,at);var Ga=/^https?$/i,Qa=["POST","PUT"];n=H.prototype,n.Fa=function(r){this.H=r},n.ea=function(r,o,l,c){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+r);o=o?o.toUpperCase():"GET",this.D=r,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():Os.g(),this.g.onreadystatechange=S(d(this.Ca,this));try{this.B=!0,this.g.open(o,String(r),!0),this.B=!1}catch(I){Zs(this,I);return}if(r=l||"",l=new Map(this.headers),c)if(Object.getPrototypeOf(c)===Object.prototype)for(var T in c)l.set(T,c[T]);else if(typeof c.keys=="function"&&typeof c.get=="function")for(const I of c.keys())l.set(I,c.get(I));else throw Error("Unknown input type for opt_headers: "+String(c));c=Array.from(l.keys()).find(I=>I.toLowerCase()=="content-type"),T=u.FormData&&r instanceof u.FormData,!(Array.prototype.indexOf.call(Qa,o,void 0)>=0)||c||T||l.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[I,C]of l)this.g.setRequestHeader(I,C);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(r),this.v=!1}catch(I){Zs(this,I)}};function Zs(r,o){r.h=!1,r.g&&(r.j=!0,r.g.abort(),r.j=!1),r.l=o,r.o=5,ti(r),dn(r)}function ti(r){r.A||(r.A=!0,ht(r,"complete"),ht(r,"error"))}n.abort=function(r){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=r||7,ht(this,"complete"),ht(this,"abort"),dn(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),dn(this,!0)),H.Z.N.call(this)},n.Ca=function(){this.u||(this.B||this.v||this.j?ei(this):this.Xa())},n.Xa=function(){ei(this)};function ei(r){if(r.h&&typeof a<"u"){if(r.v&&xt(r)==4)setTimeout(r.Ca.bind(r),0);else if(ht(r,"readystatechange"),xt(r)==4){r.h=!1;try{const I=r.ca();t:switch(I){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var o=!0;break t;default:o=!1}var l;if(!(l=o)){var c;if(c=I===0){let C=String(r.D).match(Hs)[1]||null;!C&&u.self&&u.self.location&&(C=u.self.location.protocol.slice(0,-1)),c=!Ga.test(C?C.toLowerCase():"")}l=c}if(l)ht(r,"complete"),ht(r,"success");else{r.o=6;try{var T=xt(r)>2?r.g.statusText:""}catch{T=""}r.l=T+" ["+r.ca()+"]",ti(r)}}finally{dn(r)}}}}function dn(r,o){if(r.g){r.m&&(clearTimeout(r.m),r.m=null);const l=r.g;r.g=null,o||ht(r,"ready");try{l.onreadystatechange=null}catch{}}}n.isActive=function(){return!!this.g};function xt(r){return r.g?r.g.readyState:0}n.ca=function(){try{return xt(this)>2?this.g.status:-1}catch{return-1}},n.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.La=function(r){if(this.g){var o=this.g.responseText;return r&&o.indexOf(r)==0&&(o=o.substring(r.length)),Sa(o)}};function ni(r){try{if(!r.g)return null;if("response"in r.g)return r.g.response;switch(r.F){case"":case"text":return r.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in r.g)return r.g.mozResponseArrayBuffer}return null}catch{return null}}function Ka(r){const o={};r=(r.g&&xt(r)>=2&&r.g.getAllResponseHeaders()||"").split(`\r
`);for(let c=0;c<r.length;c++){if(p(r[c]))continue;var l=Na(r[c]);const T=l[0];if(l=l[1],typeof l!="string")continue;l=l.trim();const I=o[T]||[];o[T]=I,I.push(l)}Ta(o,function(c){return c.join(", ")})}n.ya=function(){return this.o},n.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function Ue(r,o,l){return l&&l.internalChannelParams&&l.internalChannelParams[r]||o}function ri(r){this.za=0,this.i=[],this.j=new Pe,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=Ue("failFast",!1,r),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=Ue("baseRetryDelayMs",5e3,r),this.Za=Ue("retryDelaySeedMs",1e4,r),this.Ta=Ue("forwardChannelMaxRetries",2,r),this.va=Ue("forwardChannelRequestTimeoutMs",2e4,r),this.ma=r&&r.xmlHttpFactory||void 0,this.Ua=r&&r.Rb||void 0,this.Aa=r&&r.useFetchStreams||!1,this.O=void 0,this.L=r&&r.supportsCrossDomainXhr||!1,this.M="",this.h=new Us(r&&r.concurrentRequestLimit),this.Ba=new za,this.S=r&&r.fastHandshake||!1,this.R=r&&r.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=r&&r.Pb||!1,r&&r.ua&&this.j.ua(),r&&r.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&r&&r.detectBufferingProxy||!1,this.ia=void 0,r&&r.longPollingTimeout&&r.longPollingTimeout>0&&(this.ia=r.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}n=ri.prototype,n.ka=8,n.I=1,n.connect=function(r,o,l,c){ft(0),this.W=r,this.H=o||{},l&&c!==void 0&&(this.H.OSID=l,this.H.OAID=c),this.F=this.X,this.J=fi(this,null,this.W),gn(this)};function pr(r){if(si(r),r.I==3){var o=r.V++,l=wt(r.J);if($(l,"SID",r.M),$(l,"RID",o),$(l,"TYPE","terminate"),Be(r,l),o=new Ot(r,r.j,o),o.M=2,o.A=hn(wt(l)),l=!1,u.navigator&&u.navigator.sendBeacon)try{l=u.navigator.sendBeacon(o.A.toString(),"")}catch{}!l&&u.Image&&(new Image().src=o.A,l=!0),l||(o.g=di(o.j,null),o.g.ea(o.A)),o.F=Date.now(),cn(o)}hi(r)}function pn(r){r.g&&(mr(r),r.g.cancel(),r.g=null)}function si(r){pn(r),r.v&&(u.clearTimeout(r.v),r.v=null),mn(r),r.h.cancel(),r.m&&(typeof r.m=="number"&&u.clearTimeout(r.m),r.m=null)}function gn(r){if(!Bs(r.h)&&!r.m){r.m=!0;var o=r.Ea;Tt||f(),ct||(Tt(),ct=!0),y.add(o,r),r.D=0}}function Wa(r,o){return js(r.h)>=r.h.j-(r.m?1:0)?!1:r.m?(r.i=o.G.concat(r.i),!0):r.I==1||r.I==2||r.D>=(r.Sa?0:r.Ta)?!1:(r.m=be(d(r.Ea,r,o),ci(r,r.D)),r.D++,!0)}n.Ea=function(r){if(this.m)if(this.m=null,this.I==1){if(!r){this.V=Math.floor(Math.random()*1e5),r=this.V++;const T=new Ot(this,this.j,r);let I=this.o;if(this.U&&(I?(I=ms(I),ys(I,this.U)):I=this.U),this.u!==null||this.R||(T.J=I,I=null),this.S)t:{for(var o=0,l=0;l<this.i.length;l++){e:{var c=this.i[l];if("__data__"in c.map&&(c=c.map.__data__,typeof c=="string")){c=c.length;break e}c=void 0}if(c===void 0)break;if(o+=c,o>4096){o=l;break t}if(o===4096||l===this.i.length-1){o=l+1;break t}}o=1e3}else o=1e3;o=oi(this,T,o),l=wt(this.J),$(l,"RID",r),$(l,"CVER",22),this.G&&$(l,"X-HTTP-Session-Id",this.G),Be(this,l),I&&(this.R?o="headers="+Ve(Js(I))+"&"+o:this.u&&dr(l,this.u,I)),cr(this.h,T),this.Ra&&$(l,"TYPE","init"),this.S?($(l,"$req",o),$(l,"SID","null"),T.U=!0,or(T,l,null)):or(T,l,o),this.I=2}}else this.I==3&&(r?ii(this,r):this.i.length==0||Bs(this.h)||ii(this))};function ii(r,o){var l;o?l=o.l:l=r.V++;const c=wt(r.J);$(c,"SID",r.M),$(c,"RID",l),$(c,"AID",r.K),Be(r,c),r.u&&r.o&&dr(c,r.u,r.o),l=new Ot(r,r.j,l,r.D+1),r.u===null&&(l.J=r.o),o&&(r.i=o.G.concat(r.i)),o=oi(r,l,1e3),l.H=Math.round(r.va*.5)+Math.round(r.va*.5*Math.random()),cr(r.h,l),or(l,c,o)}function Be(r,o){r.H&&sn(r.H,function(l,c){$(o,c,l)}),r.l&&sn({},function(l,c){$(o,c,l)})}function oi(r,o,l){l=Math.min(r.i.length,l);const c=r.l?d(r.l.Ka,r.l,r):null;t:{var T=r.i;let M=-1;for(;;){const Y=["count="+l];M==-1?l>0?(M=T[0].g,Y.push("ofs="+M)):M=0:Y.push("ofs="+M);let j=!0;for(let tt=0;tt<l;tt++){var I=T[tt].g;const Rt=T[tt].map;if(I-=M,I<0)M=Math.max(0,T[tt].g-100),j=!1;else try{I="req"+I+"_"||"";try{var C=Rt instanceof Map?Rt:Object.entries(Rt);for(const[te,Lt]of C){let Ft=Lt;h(Lt)&&(Ft=er(Lt)),Y.push(I+te+"="+encodeURIComponent(Ft))}}catch(te){throw Y.push(I+"type="+encodeURIComponent("_badmap")),te}}catch{c&&c(Rt)}}if(j){C=Y.join("&");break t}}C=void 0}return r=r.i.splice(0,l),o.G=r,C}function ai(r){if(!r.g&&!r.v){r.Y=1;var o=r.Da;Tt||f(),ct||(Tt(),ct=!0),y.add(o,r),r.A=0}}function gr(r){return r.g||r.v||r.A>=3?!1:(r.Y++,r.v=be(d(r.Da,r),ci(r,r.A)),r.A++,!0)}n.Da=function(){if(this.v=null,li(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var r=4*this.T;this.j.info("BP detection timer enabled: "+r),this.B=be(d(this.Wa,this),r)}},n.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,ft(10),pn(this),li(this))};function mr(r){r.B!=null&&(u.clearTimeout(r.B),r.B=null)}function li(r){r.g=new Ot(r,r.j,"rpc",r.Y),r.u===null&&(r.g.J=r.o),r.g.P=0;var o=wt(r.na);$(o,"RID","rpc"),$(o,"SID",r.M),$(o,"AID",r.K),$(o,"CI",r.F?"0":"1"),!r.F&&r.ia&&$(o,"TO",r.ia),$(o,"TYPE","xmlhttp"),Be(r,o),r.u&&r.o&&dr(o,r.u,r.o),r.O&&(r.g.H=r.O);var l=r.g;r=r.ba,l.M=1,l.A=hn(wt(o)),l.u=null,l.R=!0,xs(l,r)}n.Va=function(){this.C!=null&&(this.C=null,pn(this),gr(this),ft(19))};function mn(r){r.C!=null&&(u.clearTimeout(r.C),r.C=null)}function ui(r,o){var l=null;if(r.g==o){mn(r),mr(r),r.g=null;var c=2}else if(ur(r.h,o))l=o.G,$s(r.h,o),c=1;else return;if(r.I!=0){if(o.o)if(c==1){l=o.u?o.u.length:0,o=Date.now()-o.F;var T=r.D;c=ln(),ht(c,new Ds(c,l)),gn(r)}else ai(r);else if(T=o.m,T==3||T==0&&o.X>0||!(c==1&&Wa(r,o)||c==2&&gr(r)))switch(l&&l.length>0&&(o=r.h,o.i=o.i.concat(l)),T){case 1:Zt(r,5);break;case 4:Zt(r,10);break;case 3:Zt(r,6);break;default:Zt(r,2)}}}function ci(r,o){let l=r.Qa+Math.floor(Math.random()*r.Za);return r.isActive()||(l*=2),l*o}function Zt(r,o){if(r.j.info("Error code "+o),o==2){var l=d(r.bb,r),c=r.Ua;const T=!c;c=new Mt(c||"//www.google.com/images/cleardot.gif"),u.location&&u.location.protocol=="http"||Ne(c,"https"),hn(c),T?qa(c.toString(),l):Ha(c.toString(),l)}else ft(2);r.I=0,r.l&&r.l.pa(o),hi(r),si(r)}n.bb=function(r){r?(this.j.info("Successfully pinged google.com"),ft(2)):(this.j.info("Failed to ping google.com"),ft(1))};function hi(r){if(r.I=0,r.ja=[],r.l){const o=qs(r.h);(o.length!=0||r.i.length!=0)&&(N(r.ja,o),N(r.ja,r.i),r.h.i.length=0,P(r.i),r.i.length=0),r.l.oa()}}function fi(r,o,l){var c=l instanceof Mt?wt(l):new Mt(l);if(c.g!="")o&&(c.g=o+"."+c.g),Oe(c,c.u);else{var T=u.location;c=T.protocol,o=o?o+"."+T.hostname:T.hostname,T=+T.port;const I=new Mt(null);c&&Ne(I,c),o&&(I.g=o),T&&Oe(I,T),l&&(I.h=l),c=I}return l=r.G,o=r.wa,l&&o&&$(c,l,o),$(c,"VER",r.ka),Be(r,c),c}function di(r,o,l){if(o&&!r.L)throw Error("Can't create secondary domain capable XhrIo object.");return o=r.Aa&&!r.ma?new H(new fr({ab:l})):new H(r.ma),o.Fa(r.L),o}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function pi(){}n=pi.prototype,n.ra=function(){},n.qa=function(){},n.pa=function(){},n.oa=function(){},n.isActive=function(){return!0},n.Ka=function(){};function _n(){}_n.prototype.g=function(r,o){return new _t(r,o)};function _t(r,o){at.call(this),this.g=new ri(o),this.l=r,this.h=o&&o.messageUrlParams||null,r=o&&o.messageHeaders||null,o&&o.clientProtocolHeaderRequired&&(r?r["X-Client-Protocol"]="webchannel":r={"X-Client-Protocol":"webchannel"}),this.g.o=r,r=o&&o.initMessageHeaders||null,o&&o.messageContentType&&(r?r["X-WebChannel-Content-Type"]=o.messageContentType:r={"X-WebChannel-Content-Type":o.messageContentType}),o&&o.sa&&(r?r["X-WebChannel-Client-Profile"]=o.sa:r={"X-WebChannel-Client-Profile":o.sa}),this.g.U=r,(r=o&&o.Qb)&&!p(r)&&(this.g.u=r),this.A=o&&o.supportsCrossDomainXhr||!1,this.v=o&&o.sendRawJson||!1,(o=o&&o.httpSessionIdParam)&&!p(o)&&(this.g.G=o,r=this.h,r!==null&&o in r&&(r=this.h,o in r&&delete r[o])),this.j=new fe(this)}w(_t,at),_t.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},_t.prototype.close=function(){pr(this.g)},_t.prototype.o=function(r){var o=this.g;if(typeof r=="string"){var l={};l.__data__=r,r=l}else this.v&&(l={},l.__data__=er(r),r=l);o.i.push(new ka(o.Ya++,r)),o.I==3&&gn(o)},_t.prototype.N=function(){this.g.l=null,delete this.j,pr(this.g),delete this.g,_t.Z.N.call(this)};function gi(r){nr.call(this),r.__headers__&&(this.headers=r.__headers__,this.statusCode=r.__status__,delete r.__headers__,delete r.__status__);var o=r.__sm__;if(o){t:{for(const l in o){r=l;break t}r=void 0}(this.i=r)&&(r=this.i,o=o!==null&&r in o?o[r]:void 0),this.data=o}else this.data=r}w(gi,nr);function mi(){rr.call(this),this.status=1}w(mi,rr);function fe(r){this.g=r}w(fe,pi),fe.prototype.ra=function(){ht(this.g,"a")},fe.prototype.qa=function(r){ht(this.g,new gi(r))},fe.prototype.pa=function(r){ht(this.g,new mi)},fe.prototype.oa=function(){ht(this.g,"b")},_n.prototype.createWebChannel=_n.prototype.g,_t.prototype.send=_t.prototype.o,_t.prototype.open=_t.prototype.m,_t.prototype.close=_t.prototype.close,Oo=function(){return new _n},No=function(){return ln()},Do=Xt,Nr={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},un.NO_ERROR=0,un.TIMEOUT=8,un.HTTP_ERROR=6,Rn=un,Ns.COMPLETE="complete",Vo=Ns,Cs.EventType=Se,Se.OPEN="a",Se.CLOSE="b",Se.ERROR="c",Se.MESSAGE="d",at.prototype.listen=at.prototype.J,$e=Cs,H.prototype.listenOnce=H.prototype.K,H.prototype.getLastError=H.prototype.Ha,H.prototype.getLastErrorCode=H.prototype.ya,H.prototype.getStatus=H.prototype.ca,H.prototype.getResponseJson=H.prototype.La,H.prototype.getResponseText=H.prototype.la,H.prototype.send=H.prototype.ea,H.prototype.setWithCredentials=H.prototype.Fa,Po=H}).apply(typeof En<"u"?En:typeof self<"u"?self:typeof window<"u"?window:{});const Pi="@firebase/firestore",Vi="4.9.2";class ut{constructor(t){this.uid=t}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(t){return t.uid===this.uid}}ut.UNAUTHENTICATED=new ut(null),ut.GOOGLE_CREDENTIALS=new ut("google-credentials-uid"),ut.FIRST_PARTY=new ut("first-party-uid"),ut.MOCK_USER=new ut("mock-user");let Ie="12.3.0";const ae=new Io("@firebase/firestore");function de(){return ae.logLevel}function V(n,...t){if(ae.logLevel<=F.DEBUG){const e=t.map(Yr);ae.debug(`Firestore (${Ie}): ${n}`,...e)}}function we(n,...t){if(ae.logLevel<=F.ERROR){const e=t.map(Yr);ae.error(`Firestore (${Ie}): ${n}`,...e)}}function Bn(n,...t){if(ae.logLevel<=F.WARN){const e=t.map(Yr);ae.warn(`Firestore (${Ie}): ${n}`,...e)}}function Yr(n){if(typeof n=="string")return n;try{return(function(e){return JSON.stringify(e)})(n)}catch{return n}}function x(n,t,e){let s="Unexpected state";typeof t=="string"?s=t:e=t,Mo(n,s,e)}function Mo(n,t,e){let s=`FIRESTORE (${Ie}) INTERNAL ASSERTION FAILED: ${t} (ID: ${n.toString(16)})`;if(e!==void 0)try{s+=" CONTEXT: "+JSON.stringify(e)}catch{s+=" CONTEXT: "+e}throw we(s),new Error(s)}function st(n,t,e,s){let i="Unexpected state";typeof e=="string"?i=e:s=e,n||Mo(t,i,s)}function ot(n,t){return n}const b={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class D extends Ae{constructor(t,e){super(t,e),this.code=t,this.message=e,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class se{constructor(){this.promise=new Promise(((t,e)=>{this.resolve=t,this.reject=e}))}}class ko{constructor(t,e){this.user=e,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${t}`)}}class Lu{getToken(){return Promise.resolve(null)}invalidateToken(){}start(t,e){t.enqueueRetryable((()=>e(ut.UNAUTHENTICATED)))}shutdown(){}}class Fu{constructor(t){this.token=t,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(t,e){this.changeListener=e,t.enqueueRetryable((()=>e(this.token.user)))}shutdown(){this.changeListener=null}}class Uu{constructor(t){this.t=t,this.currentUser=ut.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(t,e){st(this.o===void 0,42304);let s=this.i;const i=g=>this.i!==s?(s=this.i,e(g)):Promise.resolve();let a=new se;this.o=()=>{this.i++,this.currentUser=this.u(),a.resolve(),a=new se,t.enqueueRetryable((()=>i(this.currentUser)))};const u=()=>{const g=a;t.enqueueRetryable((async()=>{await g.promise,await i(this.currentUser)}))},h=g=>{V("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=g,this.o&&(this.auth.addAuthTokenListener(this.o),u())};this.t.onInit((g=>h(g))),setTimeout((()=>{if(!this.auth){const g=this.t.getImmediate({optional:!0});g?h(g):(V("FirebaseAuthCredentialsProvider","Auth not yet detected"),a.resolve(),a=new se)}}),0),u()}getToken(){const t=this.i,e=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(e).then((s=>this.i!==t?(V("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):s?(st(typeof s.accessToken=="string",31837,{l:s}),new ko(s.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const t=this.auth&&this.auth.getUid();return st(t===null||typeof t=="string",2055,{h:t}),new ut(t)}}class Bu{constructor(t,e,s){this.P=t,this.T=e,this.I=s,this.type="FirstParty",this.user=ut.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const t=this.R();return t&&this.A.set("Authorization",t),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class ju{constructor(t,e,s){this.P=t,this.T=e,this.I=s}getToken(){return Promise.resolve(new Bu(this.P,this.T,this.I))}start(t,e){t.enqueueRetryable((()=>e(ut.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class Di{constructor(t){this.value=t,this.type="AppCheck",this.headers=new Map,t&&t.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class $u{constructor(t,e){this.V=e,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Tu(t)&&t.settings.appCheckToken&&(this.p=t.settings.appCheckToken)}start(t,e){st(this.o===void 0,3512);const s=a=>{a.error!=null&&V("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${a.error.message}`);const u=a.token!==this.m;return this.m=a.token,V("FirebaseAppCheckTokenProvider",`Received ${u?"new":"existing"} token.`),u?e(a.token):Promise.resolve()};this.o=a=>{t.enqueueRetryable((()=>s(a)))};const i=a=>{V("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=a,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((a=>i(a))),setTimeout((()=>{if(!this.appCheck){const a=this.V.getImmediate({optional:!0});a?i(a):V("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new Di(this.p));const t=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(t).then((e=>e?(st(typeof e.token=="string",44558,{tokenResult:e}),this.m=e.token,new Di(e.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function qu(n){const t=typeof self<"u"&&(self.crypto||self.msCrypto),e=new Uint8Array(n);if(t&&typeof t.getRandomValues=="function")t.getRandomValues(e);else for(let s=0;s<n;s++)e[s]=Math.floor(256*Math.random());return e}class xo{static newId(){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=62*Math.floor(4.129032258064516);let s="";for(;s.length<20;){const i=qu(40);for(let a=0;a<i.length;++a)s.length<20&&i[a]<e&&(s+=t.charAt(i[a]%62))}return s}}function B(n,t){return n<t?-1:n>t?1:0}function Or(n,t){const e=Math.min(n.length,t.length);for(let s=0;s<e;s++){const i=n.charAt(s),a=t.charAt(s);if(i!==a)return Ar(i)===Ar(a)?B(i,a):Ar(i)?1:-1}return B(n.length,t.length)}const Hu=55296,zu=57343;function Ar(n){const t=n.charCodeAt(0);return t>=Hu&&t<=zu}function ye(n,t,e){return n.length===t.length&&n.every(((s,i)=>e(s,t[i])))}const Ni="__name__";class St{constructor(t,e,s){e===void 0?e=0:e>t.length&&x(637,{offset:e,range:t.length}),s===void 0?s=t.length-e:s>t.length-e&&x(1746,{length:s,range:t.length-e}),this.segments=t,this.offset=e,this.len=s}get length(){return this.len}isEqual(t){return St.comparator(this,t)===0}child(t){const e=this.segments.slice(this.offset,this.limit());return t instanceof St?t.forEach((s=>{e.push(s)})):e.push(t),this.construct(e)}limit(){return this.offset+this.length}popFirst(t){return t=t===void 0?1:t,this.construct(this.segments,this.offset+t,this.length-t)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(t){return this.segments[this.offset+t]}isEmpty(){return this.length===0}isPrefixOf(t){if(t.length<this.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}isImmediateParentOf(t){if(this.length+1!==t.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}forEach(t){for(let e=this.offset,s=this.limit();e<s;e++)t(this.segments[e])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(t,e){const s=Math.min(t.length,e.length);for(let i=0;i<s;i++){const a=St.compareSegments(t.get(i),e.get(i));if(a!==0)return a}return B(t.length,e.length)}static compareSegments(t,e){const s=St.isNumericId(t),i=St.isNumericId(e);return s&&!i?-1:!s&&i?1:s&&i?St.extractNumericId(t).compare(St.extractNumericId(e)):Or(t,e)}static isNumericId(t){return t.startsWith("__id")&&t.endsWith("__")}static extractNumericId(t){return Xr.fromString(t.substring(4,t.length-2))}}class G extends St{construct(t,e,s){return new G(t,e,s)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...t){const e=[];for(const s of t){if(s.indexOf("//")>=0)throw new D(b.INVALID_ARGUMENT,`Invalid segment (${s}). Paths must not contain // in them.`);e.push(...s.split("/").filter((i=>i.length>0)))}return new G(e)}static emptyPath(){return new G([])}}const Gu=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class dt extends St{construct(t,e,s){return new dt(t,e,s)}static isValidIdentifier(t){return Gu.test(t)}canonicalString(){return this.toArray().map((t=>(t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),dt.isValidIdentifier(t)||(t="`"+t+"`"),t))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===Ni}static keyField(){return new dt([Ni])}static fromServerFormat(t){const e=[];let s="",i=0;const a=()=>{if(s.length===0)throw new D(b.INVALID_ARGUMENT,`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);e.push(s),s=""};let u=!1;for(;i<t.length;){const h=t[i];if(h==="\\"){if(i+1===t.length)throw new D(b.INVALID_ARGUMENT,"Path has trailing escape character: "+t);const g=t[i+1];if(g!=="\\"&&g!=="."&&g!=="`")throw new D(b.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);s+=g,i+=2}else h==="`"?(u=!u,i++):h!=="."||u?(s+=h,i++):(a(),i++)}if(a(),u)throw new D(b.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new dt(e)}static emptyPath(){return new dt([])}}class k{constructor(t){this.path=t}static fromPath(t){return new k(G.fromString(t))}static fromName(t){return new k(G.fromString(t).popFirst(5))}static empty(){return new k(G.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(t){return t!==null&&G.comparator(this.path,t.path)===0}toString(){return this.path.toString()}static comparator(t,e){return G.comparator(t.path,e.path)}static isDocumentKey(t){return t.length%2==0}static fromSegments(t){return new k(new G(t.slice()))}}function Qu(n,t,e){if(!e)throw new D(b.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${t}.`)}function Ku(n,t,e,s){if(t===!0&&s===!0)throw new D(b.INVALID_ARGUMENT,`${n} and ${e} cannot be used together.`)}function Oi(n){if(k.isDocumentKey(n))throw new D(b.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function Wu(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function Xu(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const t=(function(s){return s.constructor?s.constructor.name:null})(n);return t?`a custom ${t} object`:"an object"}}return typeof n=="function"?"a function":x(12329,{type:typeof n})}function Lo(n,t){if("_delegate"in n&&(n=n._delegate),!(n instanceof t)){if(t.name===n.constructor.name)throw new D(b.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const e=Xu(n);throw new D(b.INVALID_ARGUMENT,`Expected type '${t.name}', but it was: ${e}`)}}return n}function W(n,t){const e={typeString:n};return t&&(e.value=t),e}function en(n,t){if(!Wu(n))throw new D(b.INVALID_ARGUMENT,"JSON must be an object");let e;for(const s in t)if(t[s]){const i=t[s].typeString,a="value"in t[s]?{value:t[s].value}:void 0;if(!(s in n)){e=`JSON missing required field: '${s}'`;break}const u=n[s];if(i&&typeof u!==i){e=`JSON field '${s}' must be a ${i}.`;break}if(a!==void 0&&u!==a.value){e=`Expected '${s}' field to equal '${a.value}'`;break}}if(e)throw new D(b.INVALID_ARGUMENT,e);return!0}const Mi=-62135596800,ki=1e6;let Et=class ne{static now(){return ne.fromMillis(Date.now())}static fromDate(t){return ne.fromMillis(t.getTime())}static fromMillis(t){const e=Math.floor(t/1e3),s=Math.floor((t-1e3*e)*ki);return new ne(e,s)}constructor(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new D(b.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new D(b.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<Mi)throw new D(b.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new D(b.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/ki}_compareTo(t){return this.seconds===t.seconds?B(this.nanoseconds,t.nanoseconds):B(this.seconds,t.seconds)}isEqual(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:ne._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(t){if(en(t,ne._jsonSchema))return new ne(t.seconds,t.nanoseconds)}valueOf(){const t=this.seconds-Mi;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}};Et._jsonSchemaVersion="firestore/timestamp/1.0",Et._jsonSchema={type:W("string",Et._jsonSchemaVersion),seconds:W("number"),nanoseconds:W("number")};class q{static fromTimestamp(t){return new q(t)}static min(){return new q(new Et(0,0))}static max(){return new q(new Et(253402300799,999999999))}constructor(t){this.timestamp=t}compareTo(t){return this.timestamp._compareTo(t.timestamp)}isEqual(t){return this.timestamp.isEqual(t.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const Ye=-1;function Yu(n,t){const e=n.toTimestamp().seconds,s=n.toTimestamp().nanoseconds+1,i=q.fromTimestamp(s===1e9?new Et(e+1,0):new Et(e,s));return new zt(i,k.empty(),t)}function Ju(n){return new zt(n.readTime,n.key,Ye)}class zt{constructor(t,e,s){this.readTime=t,this.documentKey=e,this.largestBatchId=s}static min(){return new zt(q.min(),k.empty(),Ye)}static max(){return new zt(q.max(),k.empty(),Ye)}}function Zu(n,t){let e=n.readTime.compareTo(t.readTime);return e!==0?e:(e=k.comparator(n.documentKey,t.documentKey),e!==0?e:B(n.largestBatchId,t.largestBatchId))}const tc="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class ec{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(t){this.onCommittedListeners.push(t)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((t=>t()))}}async function nc(n){if(n.code!==b.FAILED_PRECONDITION||n.message!==tc)throw n;V("LocalStore","Unexpectedly lost primary lease")}class R{constructor(t){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t((e=>{this.isDone=!0,this.result=e,this.nextCallback&&this.nextCallback(e)}),(e=>{this.isDone=!0,this.error=e,this.catchCallback&&this.catchCallback(e)}))}catch(t){return this.next(void 0,t)}next(t,e){return this.callbackAttached&&x(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(e,this.error):this.wrapSuccess(t,this.result):new R(((s,i)=>{this.nextCallback=a=>{this.wrapSuccess(t,a).next(s,i)},this.catchCallback=a=>{this.wrapFailure(e,a).next(s,i)}}))}toPromise(){return new Promise(((t,e)=>{this.next(t,e)}))}wrapUserFunction(t){try{const e=t();return e instanceof R?e:R.resolve(e)}catch(e){return R.reject(e)}}wrapSuccess(t,e){return t?this.wrapUserFunction((()=>t(e))):R.resolve(e)}wrapFailure(t,e){return t?this.wrapUserFunction((()=>t(e))):R.reject(e)}static resolve(t){return new R(((e,s)=>{e(t)}))}static reject(t){return new R(((e,s)=>{s(t)}))}static waitFor(t){return new R(((e,s)=>{let i=0,a=0,u=!1;t.forEach((h=>{++i,h.next((()=>{++a,u&&a===i&&e()}),(g=>s(g)))})),u=!0,a===i&&e()}))}static or(t){let e=R.resolve(!1);for(const s of t)e=e.next((i=>i?R.resolve(i):s()));return e}static forEach(t,e){const s=[];return t.forEach(((i,a)=>{s.push(e.call(this,i,a))})),this.waitFor(s)}static mapArray(t,e){return new R(((s,i)=>{const a=t.length,u=new Array(a);let h=0;for(let g=0;g<a;g++){const d=g;e(t[d]).next((A=>{u[d]=A,++h,h===a&&s(u)}),(A=>i(A)))}}))}static doWhile(t,e){return new R(((s,i)=>{const a=()=>{t()===!0?e().next((()=>{a()}),i):s()};a()}))}}function rc(n){const t=n.match(/Android ([\d.]+)/i),e=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(e)}function jn(n){return n.name==="IndexedDbTransactionError"}class Jr{constructor(t,e){this.previousValue=t,e&&(e.sequenceNumberHandler=s=>this.ae(s),this.ue=s=>e.writeSequenceNumber(s))}ae(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){const t=++this.previousValue;return this.ue&&this.ue(t),t}}Jr.ce=-1;const sc=-1;function $n(n){return n==null}function Mr(n){return n===0&&1/n==-1/0}const Fo="";function ic(n){let t="";for(let e=0;e<n.length;e++)t.length>0&&(t=xi(t)),t=oc(n.get(e),t);return xi(t)}function oc(n,t){let e=t;const s=n.length;for(let i=0;i<s;i++){const a=n.charAt(i);switch(a){case"\0":e+="";break;case Fo:e+="";break;default:e+=a}}return e}function xi(n){return n+Fo+""}function Li(n){let t=0;for(const e in n)Object.prototype.hasOwnProperty.call(n,e)&&t++;return t}function nn(n,t){for(const e in n)Object.prototype.hasOwnProperty.call(n,e)&&t(e,n[e])}function ac(n,t){const e=[];for(const s in n)Object.prototype.hasOwnProperty.call(n,s)&&e.push(t(n[s],s,n));return e}function lc(n){for(const t in n)if(Object.prototype.hasOwnProperty.call(n,t))return!1;return!0}class At{constructor(t,e){this.comparator=t,this.root=e||rt.EMPTY}insert(t,e){return new At(this.comparator,this.root.insert(t,e,this.comparator).copy(null,null,rt.BLACK,null,null))}remove(t){return new At(this.comparator,this.root.remove(t,this.comparator).copy(null,null,rt.BLACK,null,null))}get(t){let e=this.root;for(;!e.isEmpty();){const s=this.comparator(t,e.key);if(s===0)return e.value;s<0?e=e.left:s>0&&(e=e.right)}return null}indexOf(t){let e=0,s=this.root;for(;!s.isEmpty();){const i=this.comparator(t,s.key);if(i===0)return e+s.left.size;i<0?s=s.left:(e+=s.left.size+1,s=s.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(t){return this.root.inorderTraversal(t)}forEach(t){this.inorderTraversal(((e,s)=>(t(e,s),!1)))}toString(){const t=[];return this.inorderTraversal(((e,s)=>(t.push(`${e}:${s}`),!1))),`{${t.join(", ")}}`}reverseTraversal(t){return this.root.reverseTraversal(t)}getIterator(){return new Tn(this.root,null,this.comparator,!1)}getIteratorFrom(t){return new Tn(this.root,t,this.comparator,!1)}getReverseIterator(){return new Tn(this.root,null,this.comparator,!0)}getReverseIteratorFrom(t){return new Tn(this.root,t,this.comparator,!0)}}class Tn{constructor(t,e,s,i){this.isReverse=i,this.nodeStack=[];let a=1;for(;!t.isEmpty();)if(a=e?s(t.key,e):1,e&&i&&(a*=-1),a<0)t=this.isReverse?t.left:t.right;else{if(a===0){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}getNext(){let t=this.nodeStack.pop();const e={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return e}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}}}class rt{constructor(t,e,s,i,a){this.key=t,this.value=e,this.color=s??rt.RED,this.left=i??rt.EMPTY,this.right=a??rt.EMPTY,this.size=this.left.size+1+this.right.size}copy(t,e,s,i,a){return new rt(t??this.key,e??this.value,s??this.color,i??this.left,a??this.right)}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,e,s){let i=this;const a=s(t,i.key);return i=a<0?i.copy(null,null,null,i.left.insert(t,e,s),null):a===0?i.copy(null,e,null,null,null):i.copy(null,null,null,null,i.right.insert(t,e,s)),i.fixUp()}removeMin(){if(this.left.isEmpty())return rt.EMPTY;let t=this;return t.left.isRed()||t.left.left.isRed()||(t=t.moveRedLeft()),t=t.copy(null,null,null,t.left.removeMin(),null),t.fixUp()}remove(t,e){let s,i=this;if(e(t,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(t,e),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),e(t,i.key)===0){if(i.right.isEmpty())return rt.EMPTY;s=i.right.min(),i=i.copy(s.key,s.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(t,e))}return i.fixUp()}isRed(){return this.color}fixUp(){let t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t}moveRedLeft(){let t=this.colorFlip();return t.right.left.isRed()&&(t=t.copy(null,null,null,null,t.right.rotateRight()),t=t.rotateLeft(),t=t.colorFlip()),t}moveRedRight(){let t=this.colorFlip();return t.left.left.isRed()&&(t=t.rotateRight(),t=t.colorFlip()),t}rotateLeft(){const t=this.copy(null,null,rt.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight(){const t=this.copy(null,null,rt.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip(){const t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)}checkMaxDepth(){const t=this.check();return Math.pow(2,t)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw x(43730,{key:this.key,value:this.value});if(this.right.isRed())throw x(14113,{key:this.key,value:this.value});const t=this.left.check();if(t!==this.right.check())throw x(27949);return t+(this.isRed()?0:1)}}rt.EMPTY=null,rt.RED=!0,rt.BLACK=!1;rt.EMPTY=new class{constructor(){this.size=0}get key(){throw x(57766)}get value(){throw x(16141)}get color(){throw x(16727)}get left(){throw x(29726)}get right(){throw x(36894)}copy(t,e,s,i,a){return this}insert(t,e,s){return new rt(t,e)}remove(t,e){return this}isEmpty(){return!0}inorderTraversal(t){return!1}reverseTraversal(t){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class it{constructor(t){this.comparator=t,this.data=new At(this.comparator)}has(t){return this.data.get(t)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(t){return this.data.indexOf(t)}forEach(t){this.data.inorderTraversal(((e,s)=>(t(e),!1)))}forEachInRange(t,e){const s=this.data.getIteratorFrom(t[0]);for(;s.hasNext();){const i=s.getNext();if(this.comparator(i.key,t[1])>=0)return;e(i.key)}}forEachWhile(t,e){let s;for(s=e!==void 0?this.data.getIteratorFrom(e):this.data.getIterator();s.hasNext();)if(!t(s.getNext().key))return}firstAfterOrEqual(t){const e=this.data.getIteratorFrom(t);return e.hasNext()?e.getNext().key:null}getIterator(){return new Fi(this.data.getIterator())}getIteratorFrom(t){return new Fi(this.data.getIteratorFrom(t))}add(t){return this.copy(this.data.remove(t).insert(t,!0))}delete(t){return this.has(t)?this.copy(this.data.remove(t)):this}isEmpty(){return this.data.isEmpty()}unionWith(t){let e=this;return e.size<t.size&&(e=t,t=this),t.forEach((s=>{e=e.add(s)})),e}isEqual(t){if(!(t instanceof it)||this.size!==t.size)return!1;const e=this.data.getIterator(),s=t.data.getIterator();for(;e.hasNext();){const i=e.getNext().key,a=s.getNext().key;if(this.comparator(i,a)!==0)return!1}return!0}toArray(){const t=[];return this.forEach((e=>{t.push(e)})),t}toString(){const t=[];return this.forEach((e=>t.push(e))),"SortedSet("+t.toString()+")"}copy(t){const e=new it(this.comparator);return e.data=t,e}}class Fi{constructor(t){this.iter=t}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class Bt{constructor(t){this.fields=t,t.sort(dt.comparator)}static empty(){return new Bt([])}unionWith(t){let e=new it(dt.comparator);for(const s of this.fields)e=e.add(s);for(const s of t)e=e.add(s);return new Bt(e.toArray())}covers(t){for(const e of this.fields)if(e.isPrefixOf(t))return!0;return!1}isEqual(t){return ye(this.fields,t.fields,((e,s)=>e.isEqual(s)))}}class uc extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class bt{constructor(t){this.binaryString=t}static fromBase64String(t){const e=(function(i){try{return atob(i)}catch(a){throw typeof DOMException<"u"&&a instanceof DOMException?new uc("Invalid base64 string: "+a):a}})(t);return new bt(e)}static fromUint8Array(t){const e=(function(i){let a="";for(let u=0;u<i.length;++u)a+=String.fromCharCode(i[u]);return a})(t);return new bt(e)}[Symbol.iterator](){let t=0;return{next:()=>t<this.binaryString.length?{value:this.binaryString.charCodeAt(t++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(e){return btoa(e)})(this.binaryString)}toUint8Array(){return(function(e){const s=new Uint8Array(e.length);for(let i=0;i<e.length;i++)s[i]=e.charCodeAt(i);return s})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(t){return B(this.binaryString,t.binaryString)}isEqual(t){return this.binaryString===t.binaryString}}bt.EMPTY_BYTE_STRING=new bt("");const cc=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Gt(n){if(st(!!n,39018),typeof n=="string"){let t=0;const e=cc.exec(n);if(st(!!e,46558,{timestamp:n}),e[1]){let i=e[1];i=(i+"000000000").substr(0,9),t=Number(i)}const s=new Date(n);return{seconds:Math.floor(s.getTime()/1e3),nanos:t}}return{seconds:z(n.seconds),nanos:z(n.nanos)}}function z(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function le(n){return typeof n=="string"?bt.fromBase64String(n):bt.fromUint8Array(n)}const Uo="server_timestamp",Bo="__type__",jo="__previous_value__",$o="__local_write_time__";function Zr(n){return(n?.mapValue?.fields||{})[Bo]?.stringValue===Uo}function qn(n){const t=n.mapValue.fields[jo];return Zr(t)?qn(t):t}function Je(n){const t=Gt(n.mapValue.fields[$o].timestampValue);return new Et(t.seconds,t.nanos)}class hc{constructor(t,e,s,i,a,u,h,g,d,A){this.databaseId=t,this.appId=e,this.persistenceKey=s,this.host=i,this.ssl=a,this.forceLongPolling=u,this.autoDetectLongPolling=h,this.longPollingOptions=g,this.useFetchStreams=d,this.isUsingEmulator=A}}const On="(default)";class Ze{constructor(t,e){this.projectId=t,this.database=e||On}static empty(){return new Ze("","")}get isDefaultDatabase(){return this.database===On}isEqual(t){return t instanceof Ze&&t.projectId===this.projectId&&t.database===this.database}}const fc="__type__",dc="__max__",vn={mapValue:{}},pc="__vector__",kr="value";function Qt(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?Zr(n)?4:mc(n)?9007199254740991:gc(n)?10:11:x(28295,{value:n})}function Pt(n,t){if(n===t)return!0;const e=Qt(n);if(e!==Qt(t))return!1;switch(e){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===t.booleanValue;case 4:return Je(n).isEqual(Je(t));case 3:return(function(i,a){if(typeof i.timestampValue=="string"&&typeof a.timestampValue=="string"&&i.timestampValue.length===a.timestampValue.length)return i.timestampValue===a.timestampValue;const u=Gt(i.timestampValue),h=Gt(a.timestampValue);return u.seconds===h.seconds&&u.nanos===h.nanos})(n,t);case 5:return n.stringValue===t.stringValue;case 6:return(function(i,a){return le(i.bytesValue).isEqual(le(a.bytesValue))})(n,t);case 7:return n.referenceValue===t.referenceValue;case 8:return(function(i,a){return z(i.geoPointValue.latitude)===z(a.geoPointValue.latitude)&&z(i.geoPointValue.longitude)===z(a.geoPointValue.longitude)})(n,t);case 2:return(function(i,a){if("integerValue"in i&&"integerValue"in a)return z(i.integerValue)===z(a.integerValue);if("doubleValue"in i&&"doubleValue"in a){const u=z(i.doubleValue),h=z(a.doubleValue);return u===h?Mr(u)===Mr(h):isNaN(u)&&isNaN(h)}return!1})(n,t);case 9:return ye(n.arrayValue.values||[],t.arrayValue.values||[],Pt);case 10:case 11:return(function(i,a){const u=i.mapValue.fields||{},h=a.mapValue.fields||{};if(Li(u)!==Li(h))return!1;for(const g in u)if(u.hasOwnProperty(g)&&(h[g]===void 0||!Pt(u[g],h[g])))return!1;return!0})(n,t);default:return x(52216,{left:n})}}function tn(n,t){return(n.values||[]).find((e=>Pt(e,t)))!==void 0}function Ee(n,t){if(n===t)return 0;const e=Qt(n),s=Qt(t);if(e!==s)return B(e,s);switch(e){case 0:case 9007199254740991:return 0;case 1:return B(n.booleanValue,t.booleanValue);case 2:return(function(a,u){const h=z(a.integerValue||a.doubleValue),g=z(u.integerValue||u.doubleValue);return h<g?-1:h>g?1:h===g?0:isNaN(h)?isNaN(g)?0:-1:1})(n,t);case 3:return Ui(n.timestampValue,t.timestampValue);case 4:return Ui(Je(n),Je(t));case 5:return Or(n.stringValue,t.stringValue);case 6:return(function(a,u){const h=le(a),g=le(u);return h.compareTo(g)})(n.bytesValue,t.bytesValue);case 7:return(function(a,u){const h=a.split("/"),g=u.split("/");for(let d=0;d<h.length&&d<g.length;d++){const A=B(h[d],g[d]);if(A!==0)return A}return B(h.length,g.length)})(n.referenceValue,t.referenceValue);case 8:return(function(a,u){const h=B(z(a.latitude),z(u.latitude));return h!==0?h:B(z(a.longitude),z(u.longitude))})(n.geoPointValue,t.geoPointValue);case 9:return Bi(n.arrayValue,t.arrayValue);case 10:return(function(a,u){const h=a.fields||{},g=u.fields||{},d=h[kr]?.arrayValue,A=g[kr]?.arrayValue,w=B(d?.values?.length||0,A?.values?.length||0);return w!==0?w:Bi(d,A)})(n.mapValue,t.mapValue);case 11:return(function(a,u){if(a===vn.mapValue&&u===vn.mapValue)return 0;if(a===vn.mapValue)return 1;if(u===vn.mapValue)return-1;const h=a.fields||{},g=Object.keys(h),d=u.fields||{},A=Object.keys(d);g.sort(),A.sort();for(let w=0;w<g.length&&w<A.length;++w){const S=Or(g[w],A[w]);if(S!==0)return S;const P=Ee(h[g[w]],d[A[w]]);if(P!==0)return P}return B(g.length,A.length)})(n.mapValue,t.mapValue);default:throw x(23264,{he:e})}}function Ui(n,t){if(typeof n=="string"&&typeof t=="string"&&n.length===t.length)return B(n,t);const e=Gt(n),s=Gt(t),i=B(e.seconds,s.seconds);return i!==0?i:B(e.nanos,s.nanos)}function Bi(n,t){const e=n.values||[],s=t.values||[];for(let i=0;i<e.length&&i<s.length;++i){const a=Ee(e[i],s[i]);if(a)return a}return B(e.length,s.length)}function Te(n){return xr(n)}function xr(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(e){const s=Gt(e);return`time(${s.seconds},${s.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(e){return le(e).toBase64()})(n.bytesValue):"referenceValue"in n?(function(e){return k.fromName(e).toString()})(n.referenceValue):"geoPointValue"in n?(function(e){return`geo(${e.latitude},${e.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(e){let s="[",i=!0;for(const a of e.values||[])i?i=!1:s+=",",s+=xr(a);return s+"]"})(n.arrayValue):"mapValue"in n?(function(e){const s=Object.keys(e.fields||{}).sort();let i="{",a=!0;for(const u of s)a?a=!1:i+=",",i+=`${u}:${xr(e.fields[u])}`;return i+"}"})(n.mapValue):x(61005,{value:n})}function Sn(n){switch(Qt(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const t=qn(n);return t?16+Sn(t):16;case 5:return 2*n.stringValue.length;case 6:return le(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return(function(s){return(s.values||[]).reduce(((i,a)=>i+Sn(a)),0)})(n.arrayValue);case 10:case 11:return(function(s){let i=0;return nn(s.fields,((a,u)=>{i+=a.length+Sn(u)})),i})(n.mapValue);default:throw x(13486,{value:n})}}function Lr(n){return!!n&&"integerValue"in n}function ts(n){return!!n&&"arrayValue"in n}function ji(n){return!!n&&"nullValue"in n}function $i(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function Ir(n){return!!n&&"mapValue"in n}function gc(n){return(n?.mapValue?.fields||{})[fc]?.stringValue===pc}function He(n){if(n.geoPointValue)return{geoPointValue:{...n.geoPointValue}};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:{...n.timestampValue}};if(n.mapValue){const t={mapValue:{fields:{}}};return nn(n.mapValue.fields,((e,s)=>t.mapValue.fields[e]=He(s))),t}if(n.arrayValue){const t={arrayValue:{values:[]}};for(let e=0;e<(n.arrayValue.values||[]).length;++e)t.arrayValue.values[e]=He(n.arrayValue.values[e]);return t}return{...n}}function mc(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===dc}class Dt{constructor(t){this.value=t}static empty(){return new Dt({mapValue:{}})}field(t){if(t.isEmpty())return this.value;{let e=this.value;for(let s=0;s<t.length-1;++s)if(e=(e.mapValue.fields||{})[t.get(s)],!Ir(e))return null;return e=(e.mapValue.fields||{})[t.lastSegment()],e||null}}set(t,e){this.getFieldsMap(t.popLast())[t.lastSegment()]=He(e)}setAll(t){let e=dt.emptyPath(),s={},i=[];t.forEach(((u,h)=>{if(!e.isImmediateParentOf(h)){const g=this.getFieldsMap(e);this.applyChanges(g,s,i),s={},i=[],e=h.popLast()}u?s[h.lastSegment()]=He(u):i.push(h.lastSegment())}));const a=this.getFieldsMap(e);this.applyChanges(a,s,i)}delete(t){const e=this.field(t.popLast());Ir(e)&&e.mapValue.fields&&delete e.mapValue.fields[t.lastSegment()]}isEqual(t){return Pt(this.value,t.value)}getFieldsMap(t){let e=this.value;e.mapValue.fields||(e.mapValue={fields:{}});for(let s=0;s<t.length;++s){let i=e.mapValue.fields[t.get(s)];Ir(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},e.mapValue.fields[t.get(s)]=i),e=i}return e.mapValue.fields}applyChanges(t,e,s){nn(e,((i,a)=>t[i]=a));for(const i of s)delete t[i]}clone(){return new Dt(He(this.value))}}class It{constructor(t,e,s,i,a,u,h){this.key=t,this.documentType=e,this.version=s,this.readTime=i,this.createTime=a,this.data=u,this.documentState=h}static newInvalidDocument(t){return new It(t,0,q.min(),q.min(),q.min(),Dt.empty(),0)}static newFoundDocument(t,e,s,i){return new It(t,1,e,q.min(),s,i,0)}static newNoDocument(t,e){return new It(t,2,e,q.min(),q.min(),Dt.empty(),0)}static newUnknownDocument(t,e){return new It(t,3,e,q.min(),q.min(),Dt.empty(),2)}convertToFoundDocument(t,e){return!this.createTime.isEqual(q.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=t),this.version=t,this.documentType=1,this.data=e,this.documentState=0,this}convertToNoDocument(t){return this.version=t,this.documentType=2,this.data=Dt.empty(),this.documentState=0,this}convertToUnknownDocument(t){return this.version=t,this.documentType=3,this.data=Dt.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=q.min(),this}setReadTime(t){return this.readTime=t,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(t){return t instanceof It&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.documentType===t.documentType&&this.documentState===t.documentState&&this.data.isEqual(t.data)}mutableCopy(){return new It(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class Mn{constructor(t,e){this.position=t,this.inclusive=e}}function qi(n,t,e){let s=0;for(let i=0;i<n.position.length;i++){const a=t[i],u=n.position[i];if(a.field.isKeyField()?s=k.comparator(k.fromName(u.referenceValue),e.key):s=Ee(u,e.data.field(a.field)),a.dir==="desc"&&(s*=-1),s!==0)break}return s}function Hi(n,t){if(n===null)return t===null;if(t===null||n.inclusive!==t.inclusive||n.position.length!==t.position.length)return!1;for(let e=0;e<n.position.length;e++)if(!Pt(n.position[e],t.position[e]))return!1;return!0}class kn{constructor(t,e="asc"){this.field=t,this.dir=e}}function _c(n,t){return n.dir===t.dir&&n.field.isEqual(t.field)}class qo{}class J extends qo{constructor(t,e,s){super(),this.field=t,this.op=e,this.value=s}static create(t,e,s){return t.isKeyField()?e==="in"||e==="not-in"?this.createKeyFieldInFilter(t,e,s):new Ec(t,e,s):e==="array-contains"?new Ac(t,s):e==="in"?new Ic(t,s):e==="not-in"?new wc(t,s):e==="array-contains-any"?new Rc(t,s):new J(t,e,s)}static createKeyFieldInFilter(t,e,s){return e==="in"?new Tc(t,s):new vc(t,s)}matches(t){const e=t.data.field(this.field);return this.op==="!="?e!==null&&e.nullValue===void 0&&this.matchesComparison(Ee(e,this.value)):e!==null&&Qt(this.value)===Qt(e)&&this.matchesComparison(Ee(e,this.value))}matchesComparison(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return t===0;case"!=":return t!==0;case">":return t>0;case">=":return t>=0;default:return x(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Vt extends qo{constructor(t,e){super(),this.filters=t,this.op=e,this.Pe=null}static create(t,e){return new Vt(t,e)}matches(t){return Ho(this)?this.filters.find((e=>!e.matches(t)))===void 0:this.filters.find((e=>e.matches(t)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((t,e)=>t.concat(e.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function Ho(n){return n.op==="and"}function zo(n){return yc(n)&&Ho(n)}function yc(n){for(const t of n.filters)if(t instanceof Vt)return!1;return!0}function Fr(n){if(n instanceof J)return n.field.canonicalString()+n.op.toString()+Te(n.value);if(zo(n))return n.filters.map((t=>Fr(t))).join(",");{const t=n.filters.map((e=>Fr(e))).join(",");return`${n.op}(${t})`}}function Go(n,t){return n instanceof J?(function(s,i){return i instanceof J&&s.op===i.op&&s.field.isEqual(i.field)&&Pt(s.value,i.value)})(n,t):n instanceof Vt?(function(s,i){return i instanceof Vt&&s.op===i.op&&s.filters.length===i.filters.length?s.filters.reduce(((a,u,h)=>a&&Go(u,i.filters[h])),!0):!1})(n,t):void x(19439)}function Qo(n){return n instanceof J?(function(e){return`${e.field.canonicalString()} ${e.op} ${Te(e.value)}`})(n):n instanceof Vt?(function(e){return e.op.toString()+" {"+e.getFilters().map(Qo).join(" ,")+"}"})(n):"Filter"}class Ec extends J{constructor(t,e,s){super(t,e,s),this.key=k.fromName(s.referenceValue)}matches(t){const e=k.comparator(t.key,this.key);return this.matchesComparison(e)}}class Tc extends J{constructor(t,e){super(t,"in",e),this.keys=Ko("in",e)}matches(t){return this.keys.some((e=>e.isEqual(t.key)))}}class vc extends J{constructor(t,e){super(t,"not-in",e),this.keys=Ko("not-in",e)}matches(t){return!this.keys.some((e=>e.isEqual(t.key)))}}function Ko(n,t){return(t.arrayValue?.values||[]).map((e=>k.fromName(e.referenceValue)))}class Ac extends J{constructor(t,e){super(t,"array-contains",e)}matches(t){const e=t.data.field(this.field);return ts(e)&&tn(e.arrayValue,this.value)}}class Ic extends J{constructor(t,e){super(t,"in",e)}matches(t){const e=t.data.field(this.field);return e!==null&&tn(this.value.arrayValue,e)}}class wc extends J{constructor(t,e){super(t,"not-in",e)}matches(t){if(tn(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const e=t.data.field(this.field);return e!==null&&e.nullValue===void 0&&!tn(this.value.arrayValue,e)}}class Rc extends J{constructor(t,e){super(t,"array-contains-any",e)}matches(t){const e=t.data.field(this.field);return!(!ts(e)||!e.arrayValue.values)&&e.arrayValue.values.some((s=>tn(this.value.arrayValue,s)))}}class Sc{constructor(t,e=null,s=[],i=[],a=null,u=null,h=null){this.path=t,this.collectionGroup=e,this.orderBy=s,this.filters=i,this.limit=a,this.startAt=u,this.endAt=h,this.Te=null}}function zi(n,t=null,e=[],s=[],i=null,a=null,u=null){return new Sc(n,t,e,s,i,a,u)}function es(n){const t=ot(n);if(t.Te===null){let e=t.path.canonicalString();t.collectionGroup!==null&&(e+="|cg:"+t.collectionGroup),e+="|f:",e+=t.filters.map((s=>Fr(s))).join(","),e+="|ob:",e+=t.orderBy.map((s=>(function(a){return a.field.canonicalString()+a.dir})(s))).join(","),$n(t.limit)||(e+="|l:",e+=t.limit),t.startAt&&(e+="|lb:",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map((s=>Te(s))).join(",")),t.endAt&&(e+="|ub:",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map((s=>Te(s))).join(",")),t.Te=e}return t.Te}function ns(n,t){if(n.limit!==t.limit||n.orderBy.length!==t.orderBy.length)return!1;for(let e=0;e<n.orderBy.length;e++)if(!_c(n.orderBy[e],t.orderBy[e]))return!1;if(n.filters.length!==t.filters.length)return!1;for(let e=0;e<n.filters.length;e++)if(!Go(n.filters[e],t.filters[e]))return!1;return n.collectionGroup===t.collectionGroup&&!!n.path.isEqual(t.path)&&!!Hi(n.startAt,t.startAt)&&Hi(n.endAt,t.endAt)}class Hn{constructor(t,e=null,s=[],i=[],a=null,u="F",h=null,g=null){this.path=t,this.collectionGroup=e,this.explicitOrderBy=s,this.filters=i,this.limit=a,this.limitType=u,this.startAt=h,this.endAt=g,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function Cc(n,t,e,s,i,a,u,h){return new Hn(n,t,e,s,i,a,u,h)}function bc(n){return new Hn(n)}function Gi(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function Pc(n){return n.collectionGroup!==null}function ze(n){const t=ot(n);if(t.Ie===null){t.Ie=[];const e=new Set;for(const a of t.explicitOrderBy)t.Ie.push(a),e.add(a.field.canonicalString());const s=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc";(function(u){let h=new it(dt.comparator);return u.filters.forEach((g=>{g.getFlattenedFilters().forEach((d=>{d.isInequality()&&(h=h.add(d.field))}))})),h})(t).forEach((a=>{e.has(a.canonicalString())||a.isKeyField()||t.Ie.push(new kn(a,s))})),e.has(dt.keyField().canonicalString())||t.Ie.push(new kn(dt.keyField(),s))}return t.Ie}function ie(n){const t=ot(n);return t.Ee||(t.Ee=Wo(t,ze(n))),t.Ee}function Vc(n){const t=ot(n);return t.de||(t.de=Wo(t,n.explicitOrderBy)),t.de}function Wo(n,t){if(n.limitType==="F")return zi(n.path,n.collectionGroup,t,n.filters,n.limit,n.startAt,n.endAt);{t=t.map((i=>{const a=i.dir==="desc"?"asc":"desc";return new kn(i.field,a)}));const e=n.endAt?new Mn(n.endAt.position,n.endAt.inclusive):null,s=n.startAt?new Mn(n.startAt.position,n.startAt.inclusive):null;return zi(n.path,n.collectionGroup,t,n.filters,n.limit,e,s)}}function Ur(n,t,e){return new Hn(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),t,e,n.startAt,n.endAt)}function Xo(n,t){return ns(ie(n),ie(t))&&n.limitType===t.limitType}function Yo(n){return`${es(ie(n))}|lt:${n.limitType}`}function je(n){return`Query(target=${(function(e){let s=e.path.canonicalString();return e.collectionGroup!==null&&(s+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(s+=`, filters: [${e.filters.map((i=>Qo(i))).join(", ")}]`),$n(e.limit)||(s+=", limit: "+e.limit),e.orderBy.length>0&&(s+=`, orderBy: [${e.orderBy.map((i=>(function(u){return`${u.field.canonicalString()} (${u.dir})`})(i))).join(", ")}]`),e.startAt&&(s+=", startAt: ",s+=e.startAt.inclusive?"b:":"a:",s+=e.startAt.position.map((i=>Te(i))).join(",")),e.endAt&&(s+=", endAt: ",s+=e.endAt.inclusive?"a:":"b:",s+=e.endAt.position.map((i=>Te(i))).join(",")),`Target(${s})`})(ie(n))}; limitType=${n.limitType})`}function rs(n,t){return t.isFoundDocument()&&(function(s,i){const a=i.key.path;return s.collectionGroup!==null?i.key.hasCollectionId(s.collectionGroup)&&s.path.isPrefixOf(a):k.isDocumentKey(s.path)?s.path.isEqual(a):s.path.isImmediateParentOf(a)})(n,t)&&(function(s,i){for(const a of ze(s))if(!a.field.isKeyField()&&i.data.field(a.field)===null)return!1;return!0})(n,t)&&(function(s,i){for(const a of s.filters)if(!a.matches(i))return!1;return!0})(n,t)&&(function(s,i){return!(s.startAt&&!(function(u,h,g){const d=qi(u,h,g);return u.inclusive?d<=0:d<0})(s.startAt,ze(s),i)||s.endAt&&!(function(u,h,g){const d=qi(u,h,g);return u.inclusive?d>=0:d>0})(s.endAt,ze(s),i))})(n,t)}function Dc(n){return(t,e)=>{let s=!1;for(const i of ze(n)){const a=Nc(i,t,e);if(a!==0)return a;s=s||i.field.isKeyField()}return 0}}function Nc(n,t,e){const s=n.field.isKeyField()?k.comparator(t.key,e.key):(function(a,u,h){const g=u.data.field(a),d=h.data.field(a);return g!==null&&d!==null?Ee(g,d):x(42886)})(n.field,t,e);switch(n.dir){case"asc":return s;case"desc":return-1*s;default:return x(19790,{direction:n.dir})}}class ue{constructor(t,e){this.mapKeyFn=t,this.equalsFn=e,this.inner={},this.innerSize=0}get(t){const e=this.mapKeyFn(t),s=this.inner[e];if(s!==void 0){for(const[i,a]of s)if(this.equalsFn(i,t))return a}}has(t){return this.get(t)!==void 0}set(t,e){const s=this.mapKeyFn(t),i=this.inner[s];if(i===void 0)return this.inner[s]=[[t,e]],void this.innerSize++;for(let a=0;a<i.length;a++)if(this.equalsFn(i[a][0],t))return void(i[a]=[t,e]);i.push([t,e]),this.innerSize++}delete(t){const e=this.mapKeyFn(t),s=this.inner[e];if(s===void 0)return!1;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],t))return s.length===1?delete this.inner[e]:s.splice(i,1),this.innerSize--,!0;return!1}forEach(t){nn(this.inner,((e,s)=>{for(const[i,a]of s)t(i,a)}))}isEmpty(){return lc(this.inner)}size(){return this.innerSize}}const Oc=new At(k.comparator);function Br(){return Oc}const Jo=new At(k.comparator);function An(...n){let t=Jo;for(const e of n)t=t.insert(e.key,e);return t}function Mc(n){let t=Jo;return n.forEach(((e,s)=>t=t.insert(e,s.overlayedDocument))),t}function re(){return Ge()}function Zo(){return Ge()}function Ge(){return new ue((n=>n.toString()),((n,t)=>n.isEqual(t)))}const kc=new it(k.comparator);function yt(...n){let t=kc;for(const e of n)t=t.add(e);return t}const xc=new it(B);function Lc(){return xc}function Fc(n,t){if(n.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Mr(t)?"-0":t}}function Uc(n){return{integerValue:""+n}}class zn{constructor(){this._=void 0}}function Bc(n,t,e){return n instanceof jr?(function(i,a){const u={fields:{[Bo]:{stringValue:Uo},[$o]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return a&&Zr(a)&&(a=qn(a)),a&&(u.fields[jo]=a),{mapValue:u}})(e,t):n instanceof xn?ta(n,t):n instanceof Ln?ea(n,t):(function(i,a){const u=$c(i,a),h=Qi(u)+Qi(i.Ae);return Lr(u)&&Lr(i.Ae)?Uc(h):Fc(i.serializer,h)})(n,t)}function jc(n,t,e){return n instanceof xn?ta(n,t):n instanceof Ln?ea(n,t):e}function $c(n,t){return n instanceof $r?(function(s){return Lr(s)||(function(a){return!!a&&"doubleValue"in a})(s)})(t)?t:{integerValue:0}:null}class jr extends zn{}class xn extends zn{constructor(t){super(),this.elements=t}}function ta(n,t){const e=na(t);for(const s of n.elements)e.some((i=>Pt(i,s)))||e.push(s);return{arrayValue:{values:e}}}class Ln extends zn{constructor(t){super(),this.elements=t}}function ea(n,t){let e=na(t);for(const s of n.elements)e=e.filter((i=>!Pt(i,s)));return{arrayValue:{values:e}}}class $r extends zn{constructor(t,e){super(),this.serializer=t,this.Ae=e}}function Qi(n){return z(n.integerValue||n.doubleValue)}function na(n){return ts(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}function qc(n,t){return n.field.isEqual(t.field)&&(function(s,i){return s instanceof xn&&i instanceof xn||s instanceof Ln&&i instanceof Ln?ye(s.elements,i.elements,Pt):s instanceof $r&&i instanceof $r?Pt(s.Ae,i.Ae):s instanceof jr&&i instanceof jr})(n.transform,t.transform)}class oe{constructor(t,e){this.updateTime=t,this.exists=e}static none(){return new oe}static exists(t){return new oe(void 0,t)}static updateTime(t){return new oe(t)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)}}function Cn(n,t){return n.updateTime!==void 0?t.isFoundDocument()&&t.version.isEqual(n.updateTime):n.exists===void 0||n.exists===t.isFoundDocument()}class ss{}function ra(n,t){if(!n.hasLocalMutations||t&&t.fields.length===0)return null;if(t===null)return n.isNoDocument()?new zc(n.key,oe.none()):new is(n.key,n.data,oe.none());{const e=n.data,s=Dt.empty();let i=new it(dt.comparator);for(let a of t.fields)if(!i.has(a)){let u=e.field(a);u===null&&a.length>1&&(a=a.popLast(),u=e.field(a)),u===null?s.delete(a):s.set(a,u),i=i.add(a)}return new Gn(n.key,s,new Bt(i.toArray()),oe.none())}}function Hc(n,t,e){n instanceof is?(function(i,a,u){const h=i.value.clone(),g=Wi(i.fieldTransforms,a,u.transformResults);h.setAll(g),a.convertToFoundDocument(u.version,h).setHasCommittedMutations()})(n,t,e):n instanceof Gn?(function(i,a,u){if(!Cn(i.precondition,a))return void a.convertToUnknownDocument(u.version);const h=Wi(i.fieldTransforms,a,u.transformResults),g=a.data;g.setAll(sa(i)),g.setAll(h),a.convertToFoundDocument(u.version,g).setHasCommittedMutations()})(n,t,e):(function(i,a,u){a.convertToNoDocument(u.version).setHasCommittedMutations()})(0,t,e)}function Qe(n,t,e,s){return n instanceof is?(function(a,u,h,g){if(!Cn(a.precondition,u))return h;const d=a.value.clone(),A=Xi(a.fieldTransforms,g,u);return d.setAll(A),u.convertToFoundDocument(u.version,d).setHasLocalMutations(),null})(n,t,e,s):n instanceof Gn?(function(a,u,h,g){if(!Cn(a.precondition,u))return h;const d=Xi(a.fieldTransforms,g,u),A=u.data;return A.setAll(sa(a)),A.setAll(d),u.convertToFoundDocument(u.version,A).setHasLocalMutations(),h===null?null:h.unionWith(a.fieldMask.fields).unionWith(a.fieldTransforms.map((w=>w.field)))})(n,t,e,s):(function(a,u,h){return Cn(a.precondition,u)?(u.convertToNoDocument(u.version).setHasLocalMutations(),null):h})(n,t,e)}function Ki(n,t){return n.type===t.type&&!!n.key.isEqual(t.key)&&!!n.precondition.isEqual(t.precondition)&&!!(function(s,i){return s===void 0&&i===void 0||!(!s||!i)&&ye(s,i,((a,u)=>qc(a,u)))})(n.fieldTransforms,t.fieldTransforms)&&(n.type===0?n.value.isEqual(t.value):n.type!==1||n.data.isEqual(t.data)&&n.fieldMask.isEqual(t.fieldMask))}class is extends ss{constructor(t,e,s,i=[]){super(),this.key=t,this.value=e,this.precondition=s,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class Gn extends ss{constructor(t,e,s,i,a=[]){super(),this.key=t,this.data=e,this.fieldMask=s,this.precondition=i,this.fieldTransforms=a,this.type=1}getFieldMask(){return this.fieldMask}}function sa(n){const t=new Map;return n.fieldMask.fields.forEach((e=>{if(!e.isEmpty()){const s=n.data.field(e);t.set(e,s)}})),t}function Wi(n,t,e){const s=new Map;st(n.length===e.length,32656,{Re:e.length,Ve:n.length});for(let i=0;i<e.length;i++){const a=n[i],u=a.transform,h=t.data.field(a.field);s.set(a.field,jc(u,h,e[i]))}return s}function Xi(n,t,e){const s=new Map;for(const i of n){const a=i.transform,u=e.data.field(i.field);s.set(i.field,Bc(a,u,t))}return s}class zc extends ss{constructor(t,e){super(),this.key=t,this.precondition=e,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class Gc{constructor(t,e,s,i){this.batchId=t,this.localWriteTime=e,this.baseMutations=s,this.mutations=i}applyToRemoteDocument(t,e){const s=e.mutationResults;for(let i=0;i<this.mutations.length;i++){const a=this.mutations[i];a.key.isEqual(t.key)&&Hc(a,t,s[i])}}applyToLocalView(t,e){for(const s of this.baseMutations)s.key.isEqual(t.key)&&(e=Qe(s,t,e,this.localWriteTime));for(const s of this.mutations)s.key.isEqual(t.key)&&(e=Qe(s,t,e,this.localWriteTime));return e}applyToLocalDocumentSet(t,e){const s=Zo();return this.mutations.forEach((i=>{const a=t.get(i.key),u=a.overlayedDocument;let h=this.applyToLocalView(u,a.mutatedFields);h=e.has(i.key)?null:h;const g=ra(u,h);g!==null&&s.set(i.key,g),u.isValidDocument()||u.convertToNoDocument(q.min())})),s}keys(){return this.mutations.reduce(((t,e)=>t.add(e.key)),yt())}isEqual(t){return this.batchId===t.batchId&&ye(this.mutations,t.mutations,((e,s)=>Ki(e,s)))&&ye(this.baseMutations,t.baseMutations,((e,s)=>Ki(e,s)))}}class Qc{constructor(t,e){this.largestBatchId=t,this.mutation=e}getKey(){return this.mutation.key}isEqual(t){return t!==null&&this.mutation===t.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}class Kc{constructor(t,e,s){this.alias=t,this.aggregateType=e,this.fieldPath=s}}var K,L;function Wc(n){if(n===void 0)return we("GRPC error has no .code"),b.UNKNOWN;switch(n){case K.OK:return b.OK;case K.CANCELLED:return b.CANCELLED;case K.UNKNOWN:return b.UNKNOWN;case K.DEADLINE_EXCEEDED:return b.DEADLINE_EXCEEDED;case K.RESOURCE_EXHAUSTED:return b.RESOURCE_EXHAUSTED;case K.INTERNAL:return b.INTERNAL;case K.UNAVAILABLE:return b.UNAVAILABLE;case K.UNAUTHENTICATED:return b.UNAUTHENTICATED;case K.INVALID_ARGUMENT:return b.INVALID_ARGUMENT;case K.NOT_FOUND:return b.NOT_FOUND;case K.ALREADY_EXISTS:return b.ALREADY_EXISTS;case K.PERMISSION_DENIED:return b.PERMISSION_DENIED;case K.FAILED_PRECONDITION:return b.FAILED_PRECONDITION;case K.ABORTED:return b.ABORTED;case K.OUT_OF_RANGE:return b.OUT_OF_RANGE;case K.UNIMPLEMENTED:return b.UNIMPLEMENTED;case K.DATA_LOSS:return b.DATA_LOSS;default:return x(39323,{code:n})}}(L=K||(K={}))[L.OK=0]="OK",L[L.CANCELLED=1]="CANCELLED",L[L.UNKNOWN=2]="UNKNOWN",L[L.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",L[L.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",L[L.NOT_FOUND=5]="NOT_FOUND",L[L.ALREADY_EXISTS=6]="ALREADY_EXISTS",L[L.PERMISSION_DENIED=7]="PERMISSION_DENIED",L[L.UNAUTHENTICATED=16]="UNAUTHENTICATED",L[L.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",L[L.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",L[L.ABORTED=10]="ABORTED",L[L.OUT_OF_RANGE=11]="OUT_OF_RANGE",L[L.UNIMPLEMENTED=12]="UNIMPLEMENTED",L[L.INTERNAL=13]="INTERNAL",L[L.UNAVAILABLE=14]="UNAVAILABLE",L[L.DATA_LOSS=15]="DATA_LOSS";new Xr([4294967295,4294967295],0);const Xc={asc:"ASCENDING",desc:"DESCENDING"},Yc={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Jc={and:"AND",or:"OR"};class Zc{constructor(t,e){this.databaseId=t,this.useProto3Json=e}}function th(n,t){return n.useProto3Json||$n(t)?t:{value:t}}function Yi(n){return st(!!n,49232),q.fromTimestamp((function(e){const s=Gt(e);return new Et(s.seconds,s.nanos)})(n))}function eh(n,t){return qr(n,t).canonicalString()}function qr(n,t){const e=(function(i){return new G(["projects",i.projectId,"databases",i.database])})(n).child("documents");return t===void 0?e:e.child(t)}function nh(n){const t=G.fromString(n);return st(aa(t),10190,{key:t.toString()}),t}function rh(n,t){return eh(n.databaseId,t)}function sh(n){const t=nh(n);return t.length===4?G.emptyPath():ih(t)}function ih(n){return st(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function oh(n,t){const e={structuredQuery:{}},s=t.path;let i;t.collectionGroup!==null?(i=s,e.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(i=s.popLast(),e.structuredQuery.from=[{collectionId:s.lastSegment()}]),e.parent=rh(n,i);const a=(function(d){if(d.length!==0)return oa(Vt.create(d,"and"))})(t.filters);a&&(e.structuredQuery.where=a);const u=(function(d){if(d.length!==0)return d.map((A=>(function(S){return{field:Ut(S.field),direction:uh(S.dir)}})(A)))})(t.orderBy);u&&(e.structuredQuery.orderBy=u);const h=th(n,t.limit);return h!==null&&(e.structuredQuery.limit=h),t.startAt&&(e.structuredQuery.startAt=(function(d){return{before:d.inclusive,values:d.position}})(t.startAt)),t.endAt&&(e.structuredQuery.endAt=(function(d){return{before:!d.inclusive,values:d.position}})(t.endAt)),{ft:e,parent:i}}function ah(n,t,e,s){const{ft:i,parent:a}=oh(n,t),u={},h=[];let g=0;return e.forEach((d=>{const A="aggregate_"+g++;u[A]=d.alias,d.aggregateType==="count"?h.push({alias:A,count:{}}):d.aggregateType==="avg"?h.push({alias:A,avg:{field:Ut(d.fieldPath)}}):d.aggregateType==="sum"&&h.push({alias:A,sum:{field:Ut(d.fieldPath)}})})),{request:{structuredAggregationQuery:{aggregations:h,structuredQuery:i.structuredQuery},parent:i.parent},gt:u,parent:a}}function lh(n){let t=sh(n.parent);const e=n.structuredQuery,s=e.from?e.from.length:0;let i=null;if(s>0){st(s===1,65062);const A=e.from[0];A.allDescendants?i=A.collectionId:t=t.child(A.collectionId)}let a=[];e.where&&(a=(function(w){const S=ia(w);return S instanceof Vt&&zo(S)?S.getFilters():[S]})(e.where));let u=[];e.orderBy&&(u=(function(w){return w.map((S=>(function(N){return new kn(pe(N.field),(function(O){switch(O){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(N.direction))})(S)))})(e.orderBy));let h=null;e.limit&&(h=(function(w){let S;return S=typeof w=="object"?w.value:w,$n(S)?null:S})(e.limit));let g=null;e.startAt&&(g=(function(w){const S=!!w.before,P=w.values||[];return new Mn(P,S)})(e.startAt));let d=null;return e.endAt&&(d=(function(w){const S=!w.before,P=w.values||[];return new Mn(P,S)})(e.endAt)),Cc(t,i,u,a,h,"F",g,d)}function ia(n){return n.unaryFilter!==void 0?(function(e){switch(e.unaryFilter.op){case"IS_NAN":const s=pe(e.unaryFilter.field);return J.create(s,"==",{doubleValue:NaN});case"IS_NULL":const i=pe(e.unaryFilter.field);return J.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const a=pe(e.unaryFilter.field);return J.create(a,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const u=pe(e.unaryFilter.field);return J.create(u,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return x(61313);default:return x(60726)}})(n):n.fieldFilter!==void 0?(function(e){return J.create(pe(e.fieldFilter.field),(function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return x(58110);default:return x(50506)}})(e.fieldFilter.op),e.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(e){return Vt.create(e.compositeFilter.filters.map((s=>ia(s))),(function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return x(1026)}})(e.compositeFilter.op))})(n):x(30097,{filter:n})}function uh(n){return Xc[n]}function ch(n){return Yc[n]}function hh(n){return Jc[n]}function Ut(n){return{fieldPath:n.canonicalString()}}function pe(n){return dt.fromServerFormat(n.fieldPath)}function oa(n){return n instanceof J?(function(e){if(e.op==="=="){if($i(e.value))return{unaryFilter:{field:Ut(e.field),op:"IS_NAN"}};if(ji(e.value))return{unaryFilter:{field:Ut(e.field),op:"IS_NULL"}}}else if(e.op==="!="){if($i(e.value))return{unaryFilter:{field:Ut(e.field),op:"IS_NOT_NAN"}};if(ji(e.value))return{unaryFilter:{field:Ut(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Ut(e.field),op:ch(e.op),value:e.value}}})(n):n instanceof Vt?(function(e){const s=e.getFilters().map((i=>oa(i)));return s.length===1?s[0]:{compositeFilter:{op:hh(e.op),filters:s}}})(n):x(54877,{filter:n})}function aa(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}class fh{constructor(t){this.yt=t}}function dh(n){const t=lh({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?Ur(t,t.limit,"L"):t}class ph{constructor(){this.Cn=new gh}addToCollectionParentIndex(t,e){return this.Cn.add(e),R.resolve()}getCollectionParents(t,e){return R.resolve(this.Cn.getEntries(e))}addFieldIndex(t,e){return R.resolve()}deleteFieldIndex(t,e){return R.resolve()}deleteAllFieldIndexes(t){return R.resolve()}createTargetIndexes(t,e){return R.resolve()}getDocumentsMatchingTarget(t,e){return R.resolve(null)}getIndexType(t,e){return R.resolve(0)}getFieldIndexes(t,e){return R.resolve([])}getNextCollectionGroupToUpdate(t){return R.resolve(null)}getMinOffset(t,e){return R.resolve(zt.min())}getMinOffsetFromCollectionGroup(t,e){return R.resolve(zt.min())}updateCollectionGroup(t,e,s){return R.resolve()}updateIndexEntries(t,e){return R.resolve()}}class gh{constructor(){this.index={}}add(t){const e=t.lastSegment(),s=t.popLast(),i=this.index[e]||new it(G.comparator),a=!i.has(s);return this.index[e]=i.add(s),a}has(t){const e=t.lastSegment(),s=t.popLast(),i=this.index[e];return i&&i.has(s)}getEntries(t){return(this.index[t]||new it(G.comparator)).toArray()}}const Ji={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},la=41943040;class gt{static withCacheSize(t){return new gt(t,gt.DEFAULT_COLLECTION_PERCENTILE,gt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(t,e,s){this.cacheSizeCollectionThreshold=t,this.percentileToCollect=e,this.maximumSequenceNumbersToCollect=s}}gt.DEFAULT_COLLECTION_PERCENTILE=10,gt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,gt.DEFAULT=new gt(la,gt.DEFAULT_COLLECTION_PERCENTILE,gt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),gt.DISABLED=new gt(-1,0,0);class ve{constructor(t){this.ar=t}next(){return this.ar+=2,this.ar}static ur(){return new ve(0)}static cr(){return new ve(-1)}}const Zi="LruGarbageCollector",mh=1048576;function to([n,t],[e,s]){const i=B(n,e);return i===0?B(t,s):i}class _h{constructor(t){this.Ir=t,this.buffer=new it(to),this.Er=0}dr(){return++this.Er}Ar(t){const e=[t,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(e);else{const s=this.buffer.last();to(e,s)<0&&(this.buffer=this.buffer.delete(s).add(e))}}get maxValue(){return this.buffer.last()[0]}}class yh{constructor(t,e,s){this.garbageCollector=t,this.asyncQueue=e,this.localStore=s,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(t){V(Zi,`Garbage collection scheduled in ${t}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",t,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(e){jn(e)?V(Zi,"Ignoring IndexedDB error during garbage collection: ",e):await nc(e)}await this.Vr(3e5)}))}}class Eh{constructor(t,e){this.mr=t,this.params=e}calculateTargetCount(t,e){return this.mr.gr(t).next((s=>Math.floor(e/100*s)))}nthSequenceNumber(t,e){if(e===0)return R.resolve(Jr.ce);const s=new _h(e);return this.mr.forEachTarget(t,(i=>s.Ar(i.sequenceNumber))).next((()=>this.mr.pr(t,(i=>s.Ar(i))))).next((()=>s.maxValue))}removeTargets(t,e,s){return this.mr.removeTargets(t,e,s)}removeOrphanedDocuments(t,e){return this.mr.removeOrphanedDocuments(t,e)}collect(t,e){return this.params.cacheSizeCollectionThreshold===-1?(V("LruGarbageCollector","Garbage collection skipped; disabled"),R.resolve(Ji)):this.getCacheSize(t).next((s=>s<this.params.cacheSizeCollectionThreshold?(V("LruGarbageCollector",`Garbage collection skipped; Cache size ${s} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Ji):this.yr(t,e)))}getCacheSize(t){return this.mr.getCacheSize(t)}yr(t,e){let s,i,a,u,h,g,d;const A=Date.now();return this.calculateTargetCount(t,this.params.percentileToCollect).next((w=>(w>this.params.maximumSequenceNumbersToCollect?(V("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${w}`),i=this.params.maximumSequenceNumbersToCollect):i=w,u=Date.now(),this.nthSequenceNumber(t,i)))).next((w=>(s=w,h=Date.now(),this.removeTargets(t,s,e)))).next((w=>(a=w,g=Date.now(),this.removeOrphanedDocuments(t,s)))).next((w=>(d=Date.now(),de()<=F.DEBUG&&V("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${u-A}ms
	Determined least recently used ${i} in `+(h-u)+`ms
	Removed ${a} targets in `+(g-h)+`ms
	Removed ${w} documents in `+(d-g)+`ms
Total Duration: ${d-A}ms`),R.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:a,documentsRemoved:w}))))}}function Th(n,t){return new Eh(n,t)}class vh{constructor(){this.changes=new ue((t=>t.toString()),((t,e)=>t.isEqual(e))),this.changesApplied=!1}addEntry(t){this.assertNotApplied(),this.changes.set(t.key,t)}removeEntry(t,e){this.assertNotApplied(),this.changes.set(t,It.newInvalidDocument(t).setReadTime(e))}getEntry(t,e){this.assertNotApplied();const s=this.changes.get(e);return s!==void 0?R.resolve(s):this.getFromCache(t,e)}getEntries(t,e){return this.getAllFromCache(t,e)}apply(t){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(t)}assertNotApplied(){}}class Ah{constructor(t,e){this.overlayedDocument=t,this.mutatedFields=e}}class Ih{constructor(t,e,s,i){this.remoteDocumentCache=t,this.mutationQueue=e,this.documentOverlayCache=s,this.indexManager=i}getDocument(t,e){let s=null;return this.documentOverlayCache.getOverlay(t,e).next((i=>(s=i,this.remoteDocumentCache.getEntry(t,e)))).next((i=>(s!==null&&Qe(s.mutation,i,Bt.empty(),Et.now()),i)))}getDocuments(t,e){return this.remoteDocumentCache.getEntries(t,e).next((s=>this.getLocalViewOfDocuments(t,s,yt()).next((()=>s))))}getLocalViewOfDocuments(t,e,s=yt()){const i=re();return this.populateOverlays(t,i,e).next((()=>this.computeViews(t,e,i,s).next((a=>{let u=An();return a.forEach(((h,g)=>{u=u.insert(h,g.overlayedDocument)})),u}))))}getOverlayedDocuments(t,e){const s=re();return this.populateOverlays(t,s,e).next((()=>this.computeViews(t,e,s,yt())))}populateOverlays(t,e,s){const i=[];return s.forEach((a=>{e.has(a)||i.push(a)})),this.documentOverlayCache.getOverlays(t,i).next((a=>{a.forEach(((u,h)=>{e.set(u,h)}))}))}computeViews(t,e,s,i){let a=Br();const u=Ge(),h=(function(){return Ge()})();return e.forEach(((g,d)=>{const A=s.get(d.key);i.has(d.key)&&(A===void 0||A.mutation instanceof Gn)?a=a.insert(d.key,d):A!==void 0?(u.set(d.key,A.mutation.getFieldMask()),Qe(A.mutation,d,A.mutation.getFieldMask(),Et.now())):u.set(d.key,Bt.empty())})),this.recalculateAndSaveOverlays(t,a).next((g=>(g.forEach(((d,A)=>u.set(d,A))),e.forEach(((d,A)=>h.set(d,new Ah(A,u.get(d)??null)))),h)))}recalculateAndSaveOverlays(t,e){const s=Ge();let i=new At(((u,h)=>u-h)),a=yt();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(t,e).next((u=>{for(const h of u)h.keys().forEach((g=>{const d=e.get(g);if(d===null)return;let A=s.get(g)||Bt.empty();A=h.applyToLocalView(d,A),s.set(g,A);const w=(i.get(h.batchId)||yt()).add(g);i=i.insert(h.batchId,w)}))})).next((()=>{const u=[],h=i.getReverseIterator();for(;h.hasNext();){const g=h.getNext(),d=g.key,A=g.value,w=Zo();A.forEach((S=>{if(!a.has(S)){const P=ra(e.get(S),s.get(S));P!==null&&w.set(S,P),a=a.add(S)}})),u.push(this.documentOverlayCache.saveOverlays(t,d,w))}return R.waitFor(u)})).next((()=>s))}recalculateAndSaveOverlaysForDocumentKeys(t,e){return this.remoteDocumentCache.getEntries(t,e).next((s=>this.recalculateAndSaveOverlays(t,s)))}getDocumentsMatchingQuery(t,e,s,i){return(function(u){return k.isDocumentKey(u.path)&&u.collectionGroup===null&&u.filters.length===0})(e)?this.getDocumentsMatchingDocumentQuery(t,e.path):Pc(e)?this.getDocumentsMatchingCollectionGroupQuery(t,e,s,i):this.getDocumentsMatchingCollectionQuery(t,e,s,i)}getNextDocuments(t,e,s,i){return this.remoteDocumentCache.getAllFromCollectionGroup(t,e,s,i).next((a=>{const u=i-a.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(t,e,s.largestBatchId,i-a.size):R.resolve(re());let h=Ye,g=a;return u.next((d=>R.forEach(d,((A,w)=>(h<w.largestBatchId&&(h=w.largestBatchId),a.get(A)?R.resolve():this.remoteDocumentCache.getEntry(t,A).next((S=>{g=g.insert(A,S)}))))).next((()=>this.populateOverlays(t,d,a))).next((()=>this.computeViews(t,g,d,yt()))).next((A=>({batchId:h,changes:Mc(A)})))))}))}getDocumentsMatchingDocumentQuery(t,e){return this.getDocument(t,new k(e)).next((s=>{let i=An();return s.isFoundDocument()&&(i=i.insert(s.key,s)),i}))}getDocumentsMatchingCollectionGroupQuery(t,e,s,i){const a=e.collectionGroup;let u=An();return this.indexManager.getCollectionParents(t,a).next((h=>R.forEach(h,(g=>{const d=(function(w,S){return new Hn(S,null,w.explicitOrderBy.slice(),w.filters.slice(),w.limit,w.limitType,w.startAt,w.endAt)})(e,g.child(a));return this.getDocumentsMatchingCollectionQuery(t,d,s,i).next((A=>{A.forEach(((w,S)=>{u=u.insert(w,S)}))}))})).next((()=>u))))}getDocumentsMatchingCollectionQuery(t,e,s,i){let a;return this.documentOverlayCache.getOverlaysForCollection(t,e.path,s.largestBatchId).next((u=>(a=u,this.remoteDocumentCache.getDocumentsMatchingQuery(t,e,s,a,i)))).next((u=>{a.forEach(((g,d)=>{const A=d.getKey();u.get(A)===null&&(u=u.insert(A,It.newInvalidDocument(A)))}));let h=An();return u.forEach(((g,d)=>{const A=a.get(g);A!==void 0&&Qe(A.mutation,d,Bt.empty(),Et.now()),rs(e,d)&&(h=h.insert(g,d))})),h}))}}class wh{constructor(t){this.serializer=t,this.Lr=new Map,this.kr=new Map}getBundleMetadata(t,e){return R.resolve(this.Lr.get(e))}saveBundleMetadata(t,e){return this.Lr.set(e.id,(function(i){return{id:i.id,version:i.version,createTime:Yi(i.createTime)}})(e)),R.resolve()}getNamedQuery(t,e){return R.resolve(this.kr.get(e))}saveNamedQuery(t,e){return this.kr.set(e.name,(function(i){return{name:i.name,query:dh(i.bundledQuery),readTime:Yi(i.readTime)}})(e)),R.resolve()}}class Rh{constructor(){this.overlays=new At(k.comparator),this.qr=new Map}getOverlay(t,e){return R.resolve(this.overlays.get(e))}getOverlays(t,e){const s=re();return R.forEach(e,(i=>this.getOverlay(t,i).next((a=>{a!==null&&s.set(i,a)})))).next((()=>s))}saveOverlays(t,e,s){return s.forEach(((i,a)=>{this.St(t,e,a)})),R.resolve()}removeOverlaysForBatchId(t,e,s){const i=this.qr.get(s);return i!==void 0&&(i.forEach((a=>this.overlays=this.overlays.remove(a))),this.qr.delete(s)),R.resolve()}getOverlaysForCollection(t,e,s){const i=re(),a=e.length+1,u=new k(e.child("")),h=this.overlays.getIteratorFrom(u);for(;h.hasNext();){const g=h.getNext().value,d=g.getKey();if(!e.isPrefixOf(d.path))break;d.path.length===a&&g.largestBatchId>s&&i.set(g.getKey(),g)}return R.resolve(i)}getOverlaysForCollectionGroup(t,e,s,i){let a=new At(((d,A)=>d-A));const u=this.overlays.getIterator();for(;u.hasNext();){const d=u.getNext().value;if(d.getKey().getCollectionGroup()===e&&d.largestBatchId>s){let A=a.get(d.largestBatchId);A===null&&(A=re(),a=a.insert(d.largestBatchId,A)),A.set(d.getKey(),d)}}const h=re(),g=a.getIterator();for(;g.hasNext()&&(g.getNext().value.forEach(((d,A)=>h.set(d,A))),!(h.size()>=i)););return R.resolve(h)}St(t,e,s){const i=this.overlays.get(s.key);if(i!==null){const u=this.qr.get(i.largestBatchId).delete(s.key);this.qr.set(i.largestBatchId,u)}this.overlays=this.overlays.insert(s.key,new Qc(e,s));let a=this.qr.get(e);a===void 0&&(a=yt(),this.qr.set(e,a)),this.qr.set(e,a.add(s.key))}}class Sh{constructor(){this.sessionToken=bt.EMPTY_BYTE_STRING}getSessionToken(t){return R.resolve(this.sessionToken)}setSessionToken(t,e){return this.sessionToken=e,R.resolve()}}class os{constructor(){this.Qr=new it(nt.$r),this.Ur=new it(nt.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(t,e){const s=new nt(t,e);this.Qr=this.Qr.add(s),this.Ur=this.Ur.add(s)}Wr(t,e){t.forEach((s=>this.addReference(s,e)))}removeReference(t,e){this.Gr(new nt(t,e))}zr(t,e){t.forEach((s=>this.removeReference(s,e)))}jr(t){const e=new k(new G([])),s=new nt(e,t),i=new nt(e,t+1),a=[];return this.Ur.forEachInRange([s,i],(u=>{this.Gr(u),a.push(u.key)})),a}Jr(){this.Qr.forEach((t=>this.Gr(t)))}Gr(t){this.Qr=this.Qr.delete(t),this.Ur=this.Ur.delete(t)}Hr(t){const e=new k(new G([])),s=new nt(e,t),i=new nt(e,t+1);let a=yt();return this.Ur.forEachInRange([s,i],(u=>{a=a.add(u.key)})),a}containsKey(t){const e=new nt(t,0),s=this.Qr.firstAfterOrEqual(e);return s!==null&&t.isEqual(s.key)}}class nt{constructor(t,e){this.key=t,this.Yr=e}static $r(t,e){return k.comparator(t.key,e.key)||B(t.Yr,e.Yr)}static Kr(t,e){return B(t.Yr,e.Yr)||k.comparator(t.key,e.key)}}class Ch{constructor(t,e){this.indexManager=t,this.referenceDelegate=e,this.mutationQueue=[],this.tr=1,this.Zr=new it(nt.$r)}checkEmpty(t){return R.resolve(this.mutationQueue.length===0)}addMutationBatch(t,e,s,i){const a=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const u=new Gc(a,e,s,i);this.mutationQueue.push(u);for(const h of i)this.Zr=this.Zr.add(new nt(h.key,a)),this.indexManager.addToCollectionParentIndex(t,h.key.path.popLast());return R.resolve(u)}lookupMutationBatch(t,e){return R.resolve(this.Xr(e))}getNextMutationBatchAfterBatchId(t,e){const s=e+1,i=this.ei(s),a=i<0?0:i;return R.resolve(this.mutationQueue.length>a?this.mutationQueue[a]:null)}getHighestUnacknowledgedBatchId(){return R.resolve(this.mutationQueue.length===0?sc:this.tr-1)}getAllMutationBatches(t){return R.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(t,e){const s=new nt(e,0),i=new nt(e,Number.POSITIVE_INFINITY),a=[];return this.Zr.forEachInRange([s,i],(u=>{const h=this.Xr(u.Yr);a.push(h)})),R.resolve(a)}getAllMutationBatchesAffectingDocumentKeys(t,e){let s=new it(B);return e.forEach((i=>{const a=new nt(i,0),u=new nt(i,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([a,u],(h=>{s=s.add(h.Yr)}))})),R.resolve(this.ti(s))}getAllMutationBatchesAffectingQuery(t,e){const s=e.path,i=s.length+1;let a=s;k.isDocumentKey(a)||(a=a.child(""));const u=new nt(new k(a),0);let h=new it(B);return this.Zr.forEachWhile((g=>{const d=g.key.path;return!!s.isPrefixOf(d)&&(d.length===i&&(h=h.add(g.Yr)),!0)}),u),R.resolve(this.ti(h))}ti(t){const e=[];return t.forEach((s=>{const i=this.Xr(s);i!==null&&e.push(i)})),e}removeMutationBatch(t,e){st(this.ni(e.batchId,"removed")===0,55003),this.mutationQueue.shift();let s=this.Zr;return R.forEach(e.mutations,(i=>{const a=new nt(i.key,e.batchId);return s=s.delete(a),this.referenceDelegate.markPotentiallyOrphaned(t,i.key)})).next((()=>{this.Zr=s}))}ir(t){}containsKey(t,e){const s=new nt(e,0),i=this.Zr.firstAfterOrEqual(s);return R.resolve(e.isEqual(i&&i.key))}performConsistencyCheck(t){return this.mutationQueue.length,R.resolve()}ni(t,e){return this.ei(t)}ei(t){return this.mutationQueue.length===0?0:t-this.mutationQueue[0].batchId}Xr(t){const e=this.ei(t);return e<0||e>=this.mutationQueue.length?null:this.mutationQueue[e]}}class bh{constructor(t){this.ri=t,this.docs=(function(){return new At(k.comparator)})(),this.size=0}setIndexManager(t){this.indexManager=t}addEntry(t,e){const s=e.key,i=this.docs.get(s),a=i?i.size:0,u=this.ri(e);return this.docs=this.docs.insert(s,{document:e.mutableCopy(),size:u}),this.size+=u-a,this.indexManager.addToCollectionParentIndex(t,s.path.popLast())}removeEntry(t){const e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)}getEntry(t,e){const s=this.docs.get(e);return R.resolve(s?s.document.mutableCopy():It.newInvalidDocument(e))}getEntries(t,e){let s=Br();return e.forEach((i=>{const a=this.docs.get(i);s=s.insert(i,a?a.document.mutableCopy():It.newInvalidDocument(i))})),R.resolve(s)}getDocumentsMatchingQuery(t,e,s,i){let a=Br();const u=e.path,h=new k(u.child("__id-9223372036854775808__")),g=this.docs.getIteratorFrom(h);for(;g.hasNext();){const{key:d,value:{document:A}}=g.getNext();if(!u.isPrefixOf(d.path))break;d.path.length>u.length+1||Zu(Ju(A),s)<=0||(i.has(A.key)||rs(e,A))&&(a=a.insert(A.key,A.mutableCopy()))}return R.resolve(a)}getAllFromCollectionGroup(t,e,s,i){x(9500)}ii(t,e){return R.forEach(this.docs,(s=>e(s)))}newChangeBuffer(t){return new Ph(this)}getSize(t){return R.resolve(this.size)}}class Ph extends vh{constructor(t){super(),this.Nr=t}applyChanges(t){const e=[];return this.changes.forEach(((s,i)=>{i.isValidDocument()?e.push(this.Nr.addEntry(t,i)):this.Nr.removeEntry(s)})),R.waitFor(e)}getFromCache(t,e){return this.Nr.getEntry(t,e)}getAllFromCache(t,e){return this.Nr.getEntries(t,e)}}class Vh{constructor(t){this.persistence=t,this.si=new ue((e=>es(e)),ns),this.lastRemoteSnapshotVersion=q.min(),this.highestTargetId=0,this.oi=0,this._i=new os,this.targetCount=0,this.ai=ve.ur()}forEachTarget(t,e){return this.si.forEach(((s,i)=>e(i))),R.resolve()}getLastRemoteSnapshotVersion(t){return R.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(t){return R.resolve(this.oi)}allocateTargetId(t){return this.highestTargetId=this.ai.next(),R.resolve(this.highestTargetId)}setTargetsMetadata(t,e,s){return s&&(this.lastRemoteSnapshotVersion=s),e>this.oi&&(this.oi=e),R.resolve()}Pr(t){this.si.set(t.target,t);const e=t.targetId;e>this.highestTargetId&&(this.ai=new ve(e),this.highestTargetId=e),t.sequenceNumber>this.oi&&(this.oi=t.sequenceNumber)}addTargetData(t,e){return this.Pr(e),this.targetCount+=1,R.resolve()}updateTargetData(t,e){return this.Pr(e),R.resolve()}removeTargetData(t,e){return this.si.delete(e.target),this._i.jr(e.targetId),this.targetCount-=1,R.resolve()}removeTargets(t,e,s){let i=0;const a=[];return this.si.forEach(((u,h)=>{h.sequenceNumber<=e&&s.get(h.targetId)===null&&(this.si.delete(u),a.push(this.removeMatchingKeysForTargetId(t,h.targetId)),i++)})),R.waitFor(a).next((()=>i))}getTargetCount(t){return R.resolve(this.targetCount)}getTargetData(t,e){const s=this.si.get(e)||null;return R.resolve(s)}addMatchingKeys(t,e,s){return this._i.Wr(e,s),R.resolve()}removeMatchingKeys(t,e,s){this._i.zr(e,s);const i=this.persistence.referenceDelegate,a=[];return i&&e.forEach((u=>{a.push(i.markPotentiallyOrphaned(t,u))})),R.waitFor(a)}removeMatchingKeysForTargetId(t,e){return this._i.jr(e),R.resolve()}getMatchingKeysForTargetId(t,e){const s=this._i.Hr(e);return R.resolve(s)}containsKey(t,e){return R.resolve(this._i.containsKey(e))}}class ua{constructor(t,e){this.ui={},this.overlays={},this.ci=new Jr(0),this.li=!1,this.li=!0,this.hi=new Sh,this.referenceDelegate=t(this),this.Pi=new Vh(this),this.indexManager=new ph,this.remoteDocumentCache=(function(i){return new bh(i)})((s=>this.referenceDelegate.Ti(s))),this.serializer=new fh(e),this.Ii=new wh(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(t){return this.indexManager}getDocumentOverlayCache(t){let e=this.overlays[t.toKey()];return e||(e=new Rh,this.overlays[t.toKey()]=e),e}getMutationQueue(t,e){let s=this.ui[t.toKey()];return s||(s=new Ch(e,this.referenceDelegate),this.ui[t.toKey()]=s),s}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(t,e,s){V("MemoryPersistence","Starting transaction:",t);const i=new Dh(this.ci.next());return this.referenceDelegate.Ei(),s(i).next((a=>this.referenceDelegate.di(i).next((()=>a)))).toPromise().then((a=>(i.raiseOnCommittedEvent(),a)))}Ai(t,e){return R.or(Object.values(this.ui).map((s=>()=>s.containsKey(t,e))))}}class Dh extends ec{constructor(t){super(),this.currentSequenceNumber=t}}class as{constructor(t){this.persistence=t,this.Ri=new os,this.Vi=null}static mi(t){return new as(t)}get fi(){if(this.Vi)return this.Vi;throw x(60996)}addReference(t,e,s){return this.Ri.addReference(s,e),this.fi.delete(s.toString()),R.resolve()}removeReference(t,e,s){return this.Ri.removeReference(s,e),this.fi.add(s.toString()),R.resolve()}markPotentiallyOrphaned(t,e){return this.fi.add(e.toString()),R.resolve()}removeTarget(t,e){this.Ri.jr(e.targetId).forEach((i=>this.fi.add(i.toString())));const s=this.persistence.getTargetCache();return s.getMatchingKeysForTargetId(t,e.targetId).next((i=>{i.forEach((a=>this.fi.add(a.toString())))})).next((()=>s.removeTargetData(t,e)))}Ei(){this.Vi=new Set}di(t){const e=this.persistence.getRemoteDocumentCache().newChangeBuffer();return R.forEach(this.fi,(s=>{const i=k.fromPath(s);return this.gi(t,i).next((a=>{a||e.removeEntry(i,q.min())}))})).next((()=>(this.Vi=null,e.apply(t))))}updateLimboDocument(t,e){return this.gi(t,e).next((s=>{s?this.fi.delete(e.toString()):this.fi.add(e.toString())}))}Ti(t){return 0}gi(t,e){return R.or([()=>R.resolve(this.Ri.containsKey(e)),()=>this.persistence.getTargetCache().containsKey(t,e),()=>this.persistence.Ai(t,e)])}}class Fn{constructor(t,e){this.persistence=t,this.pi=new ue((s=>ic(s.path)),((s,i)=>s.isEqual(i))),this.garbageCollector=Th(this,e)}static mi(t,e){return new Fn(t,e)}Ei(){}di(t){return R.resolve()}forEachTarget(t,e){return this.persistence.getTargetCache().forEachTarget(t,e)}gr(t){const e=this.wr(t);return this.persistence.getTargetCache().getTargetCount(t).next((s=>e.next((i=>s+i))))}wr(t){let e=0;return this.pr(t,(s=>{e++})).next((()=>e))}pr(t,e){return R.forEach(this.pi,((s,i)=>this.br(t,s,i).next((a=>a?R.resolve():e(i)))))}removeTargets(t,e,s){return this.persistence.getTargetCache().removeTargets(t,e,s)}removeOrphanedDocuments(t,e){let s=0;const i=this.persistence.getRemoteDocumentCache(),a=i.newChangeBuffer();return i.ii(t,(u=>this.br(t,u,e).next((h=>{h||(s++,a.removeEntry(u,q.min()))})))).next((()=>a.apply(t))).next((()=>s))}markPotentiallyOrphaned(t,e){return this.pi.set(e,t.currentSequenceNumber),R.resolve()}removeTarget(t,e){const s=e.withSequenceNumber(t.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(t,s)}addReference(t,e,s){return this.pi.set(s,t.currentSequenceNumber),R.resolve()}removeReference(t,e,s){return this.pi.set(s,t.currentSequenceNumber),R.resolve()}updateLimboDocument(t,e){return this.pi.set(e,t.currentSequenceNumber),R.resolve()}Ti(t){let e=t.key.toString().length;return t.isFoundDocument()&&(e+=Sn(t.data.value)),e}br(t,e,s){return R.or([()=>this.persistence.Ai(t,e),()=>this.persistence.getTargetCache().containsKey(t,e),()=>{const i=this.pi.get(e);return R.resolve(i!==void 0&&i>s)}])}getCacheSize(t){return this.persistence.getRemoteDocumentCache().getSize(t)}}class ls{constructor(t,e,s,i){this.targetId=t,this.fromCache=e,this.Es=s,this.ds=i}static As(t,e){let s=yt(),i=yt();for(const a of e.docChanges)switch(a.type){case 0:s=s.add(a.doc.key);break;case 1:i=i.add(a.doc.key)}return new ls(t,e.fromCache,s,i)}}class Nh{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(t){this._documentReadCount+=t}}class Oh{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(function(){return _l()?8:rc(gl())>0?6:4})()}initialize(t,e){this.ps=t,this.indexManager=e,this.Rs=!0}getDocumentsMatchingQuery(t,e,s,i){const a={result:null};return this.ys(t,e).next((u=>{a.result=u})).next((()=>{if(!a.result)return this.ws(t,e,i,s).next((u=>{a.result=u}))})).next((()=>{if(a.result)return;const u=new Nh;return this.Ss(t,e,u).next((h=>{if(a.result=h,this.Vs)return this.bs(t,e,u,h.size)}))})).next((()=>a.result))}bs(t,e,s,i){return s.documentReadCount<this.fs?(de()<=F.DEBUG&&V("QueryEngine","SDK will not create cache indexes for query:",je(e),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),R.resolve()):(de()<=F.DEBUG&&V("QueryEngine","Query:",je(e),"scans",s.documentReadCount,"local documents and returns",i,"documents as results."),s.documentReadCount>this.gs*i?(de()<=F.DEBUG&&V("QueryEngine","The SDK decides to create cache indexes for query:",je(e),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(t,ie(e))):R.resolve())}ys(t,e){if(Gi(e))return R.resolve(null);let s=ie(e);return this.indexManager.getIndexType(t,s).next((i=>i===0?null:(e.limit!==null&&i===1&&(e=Ur(e,null,"F"),s=ie(e)),this.indexManager.getDocumentsMatchingTarget(t,s).next((a=>{const u=yt(...a);return this.ps.getDocuments(t,u).next((h=>this.indexManager.getMinOffset(t,s).next((g=>{const d=this.Ds(e,h);return this.Cs(e,d,u,g.readTime)?this.ys(t,Ur(e,null,"F")):this.vs(t,d,e,g)}))))})))))}ws(t,e,s,i){return Gi(e)||i.isEqual(q.min())?R.resolve(null):this.ps.getDocuments(t,s).next((a=>{const u=this.Ds(e,a);return this.Cs(e,u,s,i)?R.resolve(null):(de()<=F.DEBUG&&V("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),je(e)),this.vs(t,u,e,Yu(i,Ye)).next((h=>h)))}))}Ds(t,e){let s=new it(Dc(t));return e.forEach(((i,a)=>{rs(t,a)&&(s=s.add(a))})),s}Cs(t,e,s,i){if(t.limit===null)return!1;if(s.size!==e.size)return!0;const a=t.limitType==="F"?e.last():e.first();return!!a&&(a.hasPendingWrites||a.version.compareTo(i)>0)}Ss(t,e,s){return de()<=F.DEBUG&&V("QueryEngine","Using full collection scan to execute query:",je(e)),this.ps.getDocumentsMatchingQuery(t,e,zt.min(),s)}vs(t,e,s,i){return this.ps.getDocumentsMatchingQuery(t,s,i).next((a=>(e.forEach((u=>{a=a.insert(u.key,u)})),a)))}}const Mh="LocalStore";class kh{constructor(t,e,s,i){this.persistence=t,this.Fs=e,this.serializer=i,this.Ms=new At(B),this.xs=new ue((a=>es(a)),ns),this.Os=new Map,this.Ns=t.getRemoteDocumentCache(),this.Pi=t.getTargetCache(),this.Ii=t.getBundleCache(),this.Bs(s)}Bs(t){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(t),this.indexManager=this.persistence.getIndexManager(t),this.mutationQueue=this.persistence.getMutationQueue(t,this.indexManager),this.localDocuments=new Ih(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(t){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(e=>t.collect(e,this.Ms)))}}function xh(n,t,e,s){return new kh(n,t,e,s)}async function ca(n,t){const e=ot(n);return await e.persistence.runTransaction("Handle user change","readonly",(s=>{let i;return e.mutationQueue.getAllMutationBatches(s).next((a=>(i=a,e.Bs(t),e.mutationQueue.getAllMutationBatches(s)))).next((a=>{const u=[],h=[];let g=yt();for(const d of i){u.push(d.batchId);for(const A of d.mutations)g=g.add(A.key)}for(const d of a){h.push(d.batchId);for(const A of d.mutations)g=g.add(A.key)}return e.localDocuments.getDocuments(s,g).next((d=>({Ls:d,removedBatchIds:u,addedBatchIds:h})))}))}))}class eo{constructor(){this.activeTargetIds=Lc()}zs(t){this.activeTargetIds=this.activeTargetIds.add(t)}js(t){this.activeTargetIds=this.activeTargetIds.delete(t)}Gs(){const t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(t)}}class Lh{constructor(){this.Mo=new eo,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(t){}updateMutationState(t,e,s){}addLocalQueryTarget(t,e=!0){return e&&this.Mo.zs(t),this.xo[t]||"not-current"}updateQueryState(t,e,s){this.xo[t]=e}removeLocalQueryTarget(t){this.Mo.js(t)}isLocalQueryTarget(t){return this.Mo.activeTargetIds.has(t)}clearQueryState(t){delete this.xo[t]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(t){return this.Mo.activeTargetIds.has(t)}start(){return this.Mo=new eo,Promise.resolve()}handleUserChange(t,e,s){}setOnlineState(t){}shutdown(){}writeSequenceNumber(t){}notifyBundleLoaded(t){}}class Fh{Oo(t){}shutdown(){}}const no="ConnectivityMonitor";class ro{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(t){this.qo.push(t)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){V(no,"Network connectivity changed: AVAILABLE");for(const t of this.qo)t(0)}ko(){V(no,"Network connectivity changed: UNAVAILABLE");for(const t of this.qo)t(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}let In=null;function Hr(){return In===null?In=(function(){return 268435456+Math.round(2147483648*Math.random())})():In++,"0x"+In.toString(16)}const wr="RestConnection",Uh={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class Bh{get $o(){return!1}constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;const e=t.ssl?"https":"http",s=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Uo=e+"://"+t.host,this.Ko=`projects/${s}/databases/${i}`,this.Wo=this.databaseId.database===On?`project_id=${s}`:`project_id=${s}&database_id=${i}`}Go(t,e,s,i,a){const u=Hr(),h=this.zo(t,e.toUriEncodedString());V(wr,`Sending RPC '${t}' ${u}:`,h,s);const g={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(g,i,a);const{host:d}=new URL(h),A=Kr(d);return this.Jo(t,h,g,s,A).then((w=>(V(wr,`Received RPC '${t}' ${u}: `,w),w)),(w=>{throw Bn(wr,`RPC '${t}' ${u} failed with error: `,w,"url: ",h,"request:",s),w}))}Ho(t,e,s,i,a,u){return this.Go(t,e,s,i,a)}jo(t,e,s){t["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+Ie})(),t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),e&&e.headers.forEach(((i,a)=>t[a]=i)),s&&s.headers.forEach(((i,a)=>t[a]=i))}zo(t,e){const s=Uh[t];return`${this.Uo}/v1/${e}:${s}`}terminate(){}}class jh{constructor(t){this.Yo=t.Yo,this.Zo=t.Zo}Xo(t){this.e_=t}t_(t){this.n_=t}r_(t){this.i_=t}onMessage(t){this.s_=t}close(){this.Zo()}send(t){this.Yo(t)}o_(){this.e_()}__(){this.n_()}a_(t){this.i_(t)}u_(t){this.s_(t)}}const lt="WebChannelConnection";class $h extends Bh{constructor(t){super(t),this.c_=[],this.forceLongPolling=t.forceLongPolling,this.autoDetectLongPolling=t.autoDetectLongPolling,this.useFetchStreams=t.useFetchStreams,this.longPollingOptions=t.longPollingOptions}Jo(t,e,s,i,a){const u=Hr();return new Promise(((h,g)=>{const d=new Po;d.setWithCredentials(!0),d.listenOnce(Vo.COMPLETE,(()=>{try{switch(d.getLastErrorCode()){case Rn.NO_ERROR:const w=d.getResponseJson();V(lt,`XHR for RPC '${t}' ${u} received:`,JSON.stringify(w)),h(w);break;case Rn.TIMEOUT:V(lt,`RPC '${t}' ${u} timed out`),g(new D(b.DEADLINE_EXCEEDED,"Request time out"));break;case Rn.HTTP_ERROR:const S=d.getStatus();if(V(lt,`RPC '${t}' ${u} failed with status:`,S,"response text:",d.getResponseText()),S>0){let P=d.getResponseJson();Array.isArray(P)&&(P=P[0]);const N=P?.error;if(N&&N.status&&N.message){const U=(function(Z){const X=Z.toLowerCase().replace(/_/g,"-");return Object.values(b).indexOf(X)>=0?X:b.UNKNOWN})(N.status);g(new D(U,N.message))}else g(new D(b.UNKNOWN,"Server responded with status "+d.getStatus()))}else g(new D(b.UNAVAILABLE,"Connection failed."));break;default:x(9055,{l_:t,streamId:u,h_:d.getLastErrorCode(),P_:d.getLastError()})}}finally{V(lt,`RPC '${t}' ${u} completed.`)}}));const A=JSON.stringify(i);V(lt,`RPC '${t}' ${u} sending request:`,i),d.send(e,"POST",A,s,15)}))}T_(t,e,s){const i=Hr(),a=[this.Uo,"/","google.firestore.v1.Firestore","/",t,"/channel"],u=Oo(),h=No(),g={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},d=this.longPollingOptions.timeoutSeconds;d!==void 0&&(g.longPollingTimeout=Math.round(1e3*d)),this.useFetchStreams&&(g.useFetchStreams=!0),this.jo(g.initMessageHeaders,e,s),g.encodeInitMessageHeaders=!0;const A=a.join("");V(lt,`Creating RPC '${t}' stream ${i}: ${A}`,g);const w=u.createWebChannel(A,g);this.I_(w);let S=!1,P=!1;const N=new jh({Yo:O=>{P?V(lt,`Not sending because RPC '${t}' stream ${i} is closed:`,O):(S||(V(lt,`Opening RPC '${t}' stream ${i} transport.`),w.open(),S=!0),V(lt,`RPC '${t}' stream ${i} sending:`,O),w.send(O))},Zo:()=>w.close()}),U=(O,Z,X)=>{O.listen(Z,(Q=>{try{X(Q)}catch(mt){setTimeout((()=>{throw mt}),0)}}))};return U(w,$e.EventType.OPEN,(()=>{P||(V(lt,`RPC '${t}' stream ${i} transport opened.`),N.o_())})),U(w,$e.EventType.CLOSE,(()=>{P||(P=!0,V(lt,`RPC '${t}' stream ${i} transport closed`),N.a_(),this.E_(w))})),U(w,$e.EventType.ERROR,(O=>{P||(P=!0,Bn(lt,`RPC '${t}' stream ${i} transport errored. Name:`,O.name,"Message:",O.message),N.a_(new D(b.UNAVAILABLE,"The operation could not be completed")))})),U(w,$e.EventType.MESSAGE,(O=>{if(!P){const Z=O.data[0];st(!!Z,16349);const X=Z,Q=X?.error||X[0]?.error;if(Q){V(lt,`RPC '${t}' stream ${i} received error:`,Q);const mt=Q.status;let Tt=(function(f){const m=K[f];if(m!==void 0)return Wc(m)})(mt),ct=Q.message;Tt===void 0&&(Tt=b.INTERNAL,ct="Unknown error status: "+mt+" with message "+Q.message),P=!0,N.a_(new D(Tt,ct)),w.close()}else V(lt,`RPC '${t}' stream ${i} received:`,Z),N.u_(Z)}})),U(h,Do.STAT_EVENT,(O=>{O.stat===Nr.PROXY?V(lt,`RPC '${t}' stream ${i} detected buffering proxy`):O.stat===Nr.NOPROXY&&V(lt,`RPC '${t}' stream ${i} detected no buffering proxy`)})),setTimeout((()=>{N.__()}),0),N}terminate(){this.c_.forEach((t=>t.close())),this.c_=[]}I_(t){this.c_.push(t)}E_(t){this.c_=this.c_.filter((e=>e===t))}}function Rr(){return typeof document<"u"?document:null}function ha(n){return new Zc(n,!0)}class qh{constructor(t,e,s=1e3,i=1.5,a=6e4){this.Mi=t,this.timerId=e,this.d_=s,this.A_=i,this.R_=a,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(t){this.cancel();const e=Math.floor(this.V_+this.y_()),s=Math.max(0,Date.now()-this.f_),i=Math.max(0,e-s);i>0&&V("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.V_} ms, delay with jitter: ${e} ms, last attempt: ${s} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,i,(()=>(this.f_=Date.now(),t()))),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}class Hh{}class zh extends Hh{constructor(t,e,s,i){super(),this.authCredentials=t,this.appCheckCredentials=e,this.connection=s,this.serializer=i,this.ia=!1}sa(){if(this.ia)throw new D(b.FAILED_PRECONDITION,"The client has already been terminated.")}Go(t,e,s,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([a,u])=>this.connection.Go(t,qr(e,s),i,a,u))).catch((a=>{throw a.name==="FirebaseError"?(a.code===b.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new D(b.UNKNOWN,a.toString())}))}Ho(t,e,s,i,a){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([u,h])=>this.connection.Ho(t,qr(e,s),i,u,h,a))).catch((u=>{throw u.name==="FirebaseError"?(u.code===b.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),u):new D(b.UNKNOWN,u.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}class Gh{constructor(t,e){this.asyncQueue=t,this.onlineStateHandler=e,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(t){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${t.toString()}`),this.ca("Offline")))}set(t){this.Pa(),this.oa=0,t==="Online"&&(this.aa=!1),this.ca(t)}ca(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))}la(t){const e=`Could not reach Cloud Firestore backend. ${t}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(we(e),this.aa=!1):V("OnlineStateTracker",e)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}const us="RemoteStore";class Qh{constructor(t,e,s,i,a){this.localStore=t,this.datastore=e,this.asyncQueue=s,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=a,this.Aa.Oo((u=>{s.enqueueAndForget((async()=>{hs(this)&&(V(us,"Restarting streams for network reachability change."),await(async function(g){const d=ot(g);d.Ea.add(4),await Qn(d),d.Ra.set("Unknown"),d.Ea.delete(4),await cs(d)})(this))}))})),this.Ra=new Gh(s,i)}}async function cs(n){if(hs(n))for(const t of n.da)await t(!0)}async function Qn(n){for(const t of n.da)await t(!1)}function hs(n){return ot(n).Ea.size===0}async function so(n,t){const e=ot(n);e.asyncQueue.verifyOperationInProgress(),V(us,"RemoteStore received new credentials");const s=hs(e);e.Ea.add(3),await Qn(e),s&&e.Ra.set("Unknown"),await e.remoteSyncer.handleCredentialChange(t),e.Ea.delete(3),await cs(e)}async function Kh(n,t){const e=ot(n);t?(e.Ea.delete(2),await cs(e)):t||(e.Ea.add(2),await Qn(e),e.Ra.set("Unknown"))}class fs{constructor(t,e,s,i,a){this.asyncQueue=t,this.timerId=e,this.targetTimeMs=s,this.op=i,this.removalCallback=a,this.deferred=new se,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((u=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(t,e,s,i,a){const u=Date.now()+s,h=new fs(t,e,u,i,a);return h.start(s),h}start(t){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),t)}skipDelay(){return this.handleDelayElapsed()}cancel(t){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new D(b.CANCELLED,"Operation cancelled"+(t?": "+t:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((t=>this.deferred.resolve(t)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Wh(n,t){if(we("AsyncQueue",`${t}: ${n}`),jn(n))return new D(b.UNAVAILABLE,`${t}: ${n}`);throw n}class Xh{constructor(){this.queries=io(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(e,s){const i=ot(e),a=i.queries;i.queries=io(),a.forEach(((u,h)=>{for(const g of h.Sa)g.onError(s)}))})(this,new D(b.ABORTED,"Firestore shutting down"))}}function io(){return new ue((n=>Yo(n)),Xo)}function Yh(n){n.Ca.forEach((t=>{t.next()}))}var oo,ao;(ao=oo||(oo={})).Ma="default",ao.Cache="cache";const Jh="SyncEngine";class Zh{constructor(t,e,s,i,a,u){this.localStore=t,this.remoteStore=e,this.eventManager=s,this.sharedClientState=i,this.currentUser=a,this.maxConcurrentLimboResolutions=u,this.Pu={},this.Tu=new ue((h=>Yo(h)),Xo),this.Iu=new Map,this.Eu=new Set,this.du=new At(k.comparator),this.Au=new Map,this.Ru=new os,this.Vu={},this.mu=new Map,this.fu=ve.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}function lo(n,t,e){const s=ot(n);if(s.isPrimaryClient&&e===0||!s.isPrimaryClient&&e===1){const i=[];s.Tu.forEach(((a,u)=>{const h=u.view.va(t);h.snapshot&&i.push(h.snapshot)})),(function(u,h){const g=ot(u);g.onlineState=h;let d=!1;g.queries.forEach(((A,w)=>{for(const S of w.Sa)S.va(h)&&(d=!0)})),d&&Yh(g)})(s.eventManager,t),i.length&&s.Pu.H_(i),s.onlineState=t,s.isPrimaryClient&&s.sharedClientState.setOnlineState(t)}}async function tf(n,t,e){const s=ot(n),i=[],a=[],u=[];s.Tu.isEmpty()||(s.Tu.forEach(((h,g)=>{u.push(s.pu(g,t,e).then((d=>{if((d||e)&&s.isPrimaryClient){const A=d?!d.fromCache:e?.targetChanges.get(g.targetId)?.current;s.sharedClientState.updateQueryState(g.targetId,A?"current":"not-current")}if(d){i.push(d);const A=ls.As(g.targetId,d);a.push(A)}})))})),await Promise.all(u),s.Pu.H_(i),await(async function(g,d){const A=ot(g);try{await A.persistence.runTransaction("notifyLocalViewChanges","readwrite",(w=>R.forEach(d,(S=>R.forEach(S.Es,(P=>A.persistence.referenceDelegate.addReference(w,S.targetId,P))).next((()=>R.forEach(S.ds,(P=>A.persistence.referenceDelegate.removeReference(w,S.targetId,P)))))))))}catch(w){if(!jn(w))throw w;V(Mh,"Failed to update sequence numbers: "+w)}for(const w of d){const S=w.targetId;if(!w.fromCache){const P=A.Ms.get(S),N=P.snapshotVersion,U=P.withLastLimboFreeSnapshotVersion(N);A.Ms=A.Ms.insert(S,U)}}})(s.localStore,a))}async function ef(n,t){const e=ot(n);if(!e.currentUser.isEqual(t)){V(Jh,"User change. New user:",t.toKey());const s=await ca(e.localStore,t);e.currentUser=t,(function(a,u){a.mu.forEach((h=>{h.forEach((g=>{g.reject(new D(b.CANCELLED,u))}))})),a.mu.clear()})(e,"'waitForPendingWrites' promise is rejected due to a user change."),e.sharedClientState.handleUserChange(t,s.removedBatchIds,s.addedBatchIds),await tf(e,s.Ls)}}class Un{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(t){this.serializer=ha(t.databaseInfo.databaseId),this.sharedClientState=this.Du(t),this.persistence=this.Cu(t),await this.persistence.start(),this.localStore=this.vu(t),this.gcScheduler=this.Fu(t,this.localStore),this.indexBackfillerScheduler=this.Mu(t,this.localStore)}Fu(t,e){return null}Mu(t,e){return null}vu(t){return xh(this.persistence,new Oh,t.initialUser,this.serializer)}Cu(t){return new ua(as.mi,this.serializer)}Du(t){return new Lh}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Un.provider={build:()=>new Un};class nf extends Un{constructor(t){super(),this.cacheSizeBytes=t}Fu(t,e){st(this.persistence.referenceDelegate instanceof Fn,46915);const s=this.persistence.referenceDelegate.garbageCollector;return new yh(s,t.asyncQueue,e)}Cu(t){const e=this.cacheSizeBytes!==void 0?gt.withCacheSize(this.cacheSizeBytes):gt.DEFAULT;return new ua((s=>Fn.mi(s,e)),this.serializer)}}class zr{async initialize(t,e){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(e),this.remoteStore=this.createRemoteStore(e),this.eventManager=this.createEventManager(e),this.syncEngine=this.createSyncEngine(e,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=s=>lo(this.syncEngine,s,1),this.remoteStore.remoteSyncer.handleCredentialChange=ef.bind(null,this.syncEngine),await Kh(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(t){return(function(){return new Xh})()}createDatastore(t){const e=ha(t.databaseInfo.databaseId),s=(function(a){return new $h(a)})(t.databaseInfo);return(function(a,u,h,g){return new zh(a,u,h,g)})(t.authCredentials,t.appCheckCredentials,s,e)}createRemoteStore(t){return(function(s,i,a,u,h){return new Qh(s,i,a,u,h)})(this.localStore,this.datastore,t.asyncQueue,(e=>lo(this.syncEngine,e,0)),(function(){return ro.v()?new ro:new Fh})())}createSyncEngine(t,e){return(function(i,a,u,h,g,d,A){const w=new Zh(i,a,u,h,g,d);return A&&(w.gu=!0),w})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,e)}async terminate(){await(async function(e){const s=ot(e);V(us,"RemoteStore shutting down."),s.Ea.add(5),await Qn(s),s.Aa.shutdown(),s.Ra.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}zr.provider={build:()=>new zr};const Kt="FirestoreClient";class rf{constructor(t,e,s,i,a){this.authCredentials=t,this.appCheckCredentials=e,this.asyncQueue=s,this.databaseInfo=i,this.user=ut.UNAUTHENTICATED,this.clientId=xo.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=a,this.authCredentials.start(s,(async u=>{V(Kt,"Received user=",u.uid),await this.authCredentialListener(u),this.user=u})),this.appCheckCredentials.start(s,(u=>(V(Kt,"Received new app check token=",u),this.appCheckCredentialListener(u,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(t){this.authCredentialListener=t}setAppCheckTokenChangeListener(t){this.appCheckCredentialListener=t}terminate(){this.asyncQueue.enterRestrictedMode();const t=new se;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),t.resolve()}catch(e){const s=Wh(e,"Failed to shutdown persistence");t.reject(s)}})),t.promise}}async function Sr(n,t){n.asyncQueue.verifyOperationInProgress(),V(Kt,"Initializing OfflineComponentProvider");const e=n.configuration;await t.initialize(e);let s=e.initialUser;n.setCredentialChangeListener((async i=>{s.isEqual(i)||(await ca(t.localStore,i),s=i)})),t.persistence.setDatabaseDeletedListener((()=>n.terminate())),n._offlineComponents=t}async function uo(n,t){n.asyncQueue.verifyOperationInProgress();const e=await sf(n);V(Kt,"Initializing OnlineComponentProvider"),await t.initialize(e,n.configuration),n.setCredentialChangeListener((s=>so(t.remoteStore,s))),n.setAppCheckTokenChangeListener(((s,i)=>so(t.remoteStore,i))),n._onlineComponents=t}async function sf(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){V(Kt,"Using user provided OfflineComponentProvider");try{await Sr(n,n._uninitializedComponentsProvider._offline)}catch(t){const e=t;if(!(function(i){return i.name==="FirebaseError"?i.code===b.FAILED_PRECONDITION||i.code===b.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11})(e))throw e;Bn("Error using user provided cache. Falling back to memory cache: "+e),await Sr(n,new Un)}}else V(Kt,"Using default OfflineComponentProvider"),await Sr(n,new nf(void 0));return n._offlineComponents}async function of(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(V(Kt,"Using user provided OnlineComponentProvider"),await uo(n,n._uninitializedComponentsProvider._online)):(V(Kt,"Using default OnlineComponentProvider"),await uo(n,new zr))),n._onlineComponents}function af(n){return of(n).then((t=>t.datastore))}function lf(n,t,e){const s=new se;return n.asyncQueue.enqueueAndForget((async()=>{try{const i=await af(n);s.resolve((async function(u,h,g){const d=ot(u),{request:A,gt:w,parent:S}=ah(d.serializer,Vc(h),g);d.connection.$o||delete A.parent;const P=(await d.Ho("RunAggregationQuery",d.serializer.databaseId,S,A,1)).filter((U=>!!U.result));st(P.length===1,64727);const N=P[0].result?.aggregateFields;return Object.keys(N).reduce(((U,O)=>(U[w[O]]=N[O],U)),{})})(i,t,e))}catch(i){s.reject(i)}})),s.promise}function fa(n){const t={};return n.timeoutSeconds!==void 0&&(t.timeoutSeconds=n.timeoutSeconds),t}const co=new Map;const da="firestore.googleapis.com",ho=!0;class fo{constructor(t){if(t.host===void 0){if(t.ssl!==void 0)throw new D(b.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=da,this.ssl=ho}else this.host=t.host,this.ssl=t.ssl??ho;if(this.isUsingEmulator=t.emulatorOptions!==void 0,this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,this.localCache=t.localCache,t.cacheSizeBytes===void 0)this.cacheSizeBytes=la;else{if(t.cacheSizeBytes!==-1&&t.cacheSizeBytes<mh)throw new D(b.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}Ku("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:t.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=fa(t.experimentalLongPollingOptions??{}),(function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new D(b.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new D(b.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new D(b.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!t.useFetchStreams}isEqual(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&(function(s,i){return s.timeoutSeconds===i.timeoutSeconds})(this.experimentalLongPollingOptions,t.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties&&this.useFetchStreams===t.useFetchStreams}}class ds{constructor(t,e,s,i){this._authCredentials=t,this._appCheckCredentials=e,this._databaseId=s,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new fo({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new D(b.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(t){if(this._settingsFrozen)throw new D(b.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new fo(t),this._emulatorOptions=t.emulatorOptions||{},t.credentials!==void 0&&(this._authCredentials=(function(s){if(!s)return new Lu;switch(s.type){case"firstParty":return new ju(s.sessionIndex||"0",s.iamToken||null,s.authTokenFactory||null);case"provider":return s.client;default:throw new D(b.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(t.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(e){const s=co.get(e);s&&(V("ComponentProvider","Removing Datastore"),co.delete(e),s.terminate())})(this),Promise.resolve()}}function uf(n,t,e,s={}){n=Lo(n,ds);const i=Kr(t),a=n._getSettings(),u={...a,emulatorOptions:n._getEmulatorOptions()},h=`${t}:${e}`;i&&(cl(`https://${h}`),pl("Firestore",!0)),a.host!==da&&a.host!==h&&Bn("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const g={...a,host:h,ssl:i,emulatorOptions:s};if(!Vn(g,u)&&(n._setSettings(g),s.mockUserToken)){let d,A;if(typeof s.mockUserToken=="string")d=s.mockUserToken,A=ut.MOCK_USER;else{d=hl(s.mockUserToken,n._app?.options.projectId);const w=s.mockUserToken.sub||s.mockUserToken.user_id;if(!w)throw new D(b.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");A=new ut(w)}n._authCredentials=new Fu(new ko(d,A))}}class ps{constructor(t,e,s){this.converter=e,this._query=s,this.type="query",this.firestore=t}withConverter(t){return new ps(this.firestore,t,this._query)}}class vt{constructor(t,e,s){this.converter=e,this._key=s,this.type="document",this.firestore=t}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new me(this.firestore,this.converter,this._key.path.popLast())}withConverter(t){return new vt(this.firestore,t,this._key)}toJSON(){return{type:vt._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(t,e,s){if(en(e,vt._jsonSchema))return new vt(t,s||null,new k(G.fromString(e.referencePath)))}}vt._jsonSchemaVersion="firestore/documentReference/1.0",vt._jsonSchema={type:W("string",vt._jsonSchemaVersion),referencePath:W("string")};class me extends ps{constructor(t,e,s){super(t,e,bc(s)),this._path=s,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const t=this._path.popLast();return t.isEmpty()?null:new vt(this.firestore,null,new k(t))}withConverter(t){return new me(this.firestore,t,this._path)}}function cf(n,t,...e){if(n=Ao(n),Qu("collection","path",t),n instanceof ds){const s=G.fromString(t,...e);return Oi(s),new me(n,null,s)}{if(!(n instanceof vt||n instanceof me))throw new D(b.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const s=n._path.child(G.fromString(t,...e));return Oi(s),new me(n.firestore,null,s)}}const po="AsyncQueue";class go{constructor(t=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new qh(this,"async_queue_retry"),this._c=()=>{const s=Rr();s&&V(po,"Visibility state changed to "+s.visibilityState),this.M_.w_()},this.ac=t;const e=Rr();e&&typeof e.addEventListener=="function"&&e.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(t){this.enqueue(t)}enqueueAndForgetEvenWhileRestricted(t){this.uc(),this.cc(t)}enterRestrictedMode(t){if(!this.ec){this.ec=!0,this.sc=t||!1;const e=Rr();e&&typeof e.removeEventListener=="function"&&e.removeEventListener("visibilitychange",this._c)}}enqueue(t){if(this.uc(),this.ec)return new Promise((()=>{}));const e=new se;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(t().then(e.resolve,e.reject),e.promise))).then((()=>e.promise))}enqueueRetryable(t){this.enqueueAndForget((()=>(this.Xu.push(t),this.lc())))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(t){if(!jn(t))throw t;V(po,"Operation failed with retryable error: "+t)}this.Xu.length>0&&this.M_.p_((()=>this.lc()))}}cc(t){const e=this.ac.then((()=>(this.rc=!0,t().catch((s=>{throw this.nc=s,this.rc=!1,we("INTERNAL UNHANDLED ERROR: ",mo(s)),s})).then((s=>(this.rc=!1,s))))));return this.ac=e,e}enqueueAfterDelay(t,e,s){this.uc(),this.oc.indexOf(t)>-1&&(e=0);const i=fs.createAndSchedule(this,t,e,s,(a=>this.hc(a)));return this.tc.push(i),i}uc(){this.nc&&x(47125,{Pc:mo(this.nc)})}verifyOperationInProgress(){}async Tc(){let t;do t=this.ac,await t;while(t!==this.ac)}Ic(t){for(const e of this.tc)if(e.timerId===t)return!0;return!1}Ec(t){return this.Tc().then((()=>{this.tc.sort(((e,s)=>e.targetTimeMs-s.targetTimeMs));for(const e of this.tc)if(e.skipDelay(),t!=="all"&&e.timerId===t)break;return this.Tc()}))}dc(t){this.oc.push(t)}hc(t){const e=this.tc.indexOf(t);this.tc.splice(e,1)}}function mo(n){let t=n.message||"";return n.stack&&(t=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),t}class pa extends ds{constructor(t,e,s,i){super(t,e,s,i),this.type="firestore",this._queue=new go,this._persistenceKey=i?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const t=this._firestoreClient.terminate();this._queue=new go(t),this._firestoreClient=void 0,await t}}}function hf(n,t){const e=typeof n=="object"?n:wu(),s=typeof n=="string"?n:On,i=Eu(e,"firestore").getImmediate({identifier:s});if(!i._initialized){const a=ll("firestore");a&&uf(i,...a)}return i}function ff(n){if(n._terminated)throw new D(b.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||df(n),n._firestoreClient}function df(n){const t=n._freezeSettings(),e=(function(i,a,u,h){return new hc(i,a,u,h.host,h.ssl,h.experimentalForceLongPolling,h.experimentalAutoDetectLongPolling,fa(h.experimentalLongPollingOptions),h.useFetchStreams,h.isUsingEmulator)})(n._databaseId,n._app?.options.appId||"",n._persistenceKey,t);n._componentsProvider||t.localCache?._offlineComponentProvider&&t.localCache?._onlineComponentProvider&&(n._componentsProvider={_offline:t.localCache._offlineComponentProvider,_online:t.localCache._onlineComponentProvider}),n._firestoreClient=new rf(n._authCredentials,n._appCheckCredentials,n._queue,e,n._componentsProvider&&(function(i){const a=i?._online.build();return{_offline:i?._offline.build(a),_online:a}})(n._componentsProvider))}class pf{constructor(t="count",e){this._internalFieldPath=e,this.type="AggregateField",this.aggregateType=t}}class gf{constructor(t,e,s){this._userDataWriter=e,this._data=s,this.type="AggregateQuerySnapshot",this.query=t}data(){return this._userDataWriter.convertObjectMap(this._data)}}class Ct{constructor(t){this._byteString=t}static fromBase64String(t){try{return new Ct(bt.fromBase64String(t))}catch(e){throw new D(b.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}}static fromUint8Array(t){return new Ct(bt.fromUint8Array(t))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(t){return this._byteString.isEqual(t._byteString)}toJSON(){return{type:Ct._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(t){if(en(t,Ct._jsonSchema))return Ct.fromBase64String(t.bytes)}}Ct._jsonSchemaVersion="firestore/bytes/1.0",Ct._jsonSchema={type:W("string",Ct._jsonSchemaVersion),bytes:W("string")};class gs{constructor(...t){for(let e=0;e<t.length;++e)if(t[e].length===0)throw new D(b.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new dt(t)}isEqual(t){return this._internalPath.isEqual(t._internalPath)}}class qt{constructor(t,e){if(!isFinite(t)||t<-90||t>90)throw new D(b.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new D(b.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this._lat=t,this._long=e}get latitude(){return this._lat}get longitude(){return this._long}isEqual(t){return this._lat===t._lat&&this._long===t._long}_compareTo(t){return B(this._lat,t._lat)||B(this._long,t._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:qt._jsonSchemaVersion}}static fromJSON(t){if(en(t,qt._jsonSchema))return new qt(t.latitude,t.longitude)}}qt._jsonSchemaVersion="firestore/geoPoint/1.0",qt._jsonSchema={type:W("string",qt._jsonSchemaVersion),latitude:W("number"),longitude:W("number")};class Ht{constructor(t){this._values=(t||[]).map((e=>e))}toArray(){return this._values.map((t=>t))}isEqual(t){return(function(s,i){if(s.length!==i.length)return!1;for(let a=0;a<s.length;++a)if(s[a]!==i[a])return!1;return!0})(this._values,t._values)}toJSON(){return{type:Ht._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(t){if(en(t,Ht._jsonSchema)){if(Array.isArray(t.vectorValues)&&t.vectorValues.every((e=>typeof e=="number")))return new Ht(t.vectorValues);throw new D(b.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}Ht._jsonSchemaVersion="firestore/vectorValue/1.0",Ht._jsonSchema={type:W("string",Ht._jsonSchemaVersion),vectorValues:W("object")};function mf(n,t,e){if((t=Ao(t))instanceof gs)return t._internalPath;if(typeof t=="string")return ga(n,t);throw Gr("Field path arguments must be of type string or ",n)}const _f=new RegExp("[~\\*/\\[\\]]");function ga(n,t,e){if(t.search(_f)>=0)throw Gr(`Invalid field path (${t}). Paths must not contain '~', '*', '/', '[', or ']'`,n);try{return new gs(...t.split("."))._internalPath}catch{throw Gr(`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n)}}function Gr(n,t,e,s,i){let a=`Function ${t}() called with invalid data`;a+=". ";let u="";return new D(b.INVALID_ARGUMENT,a+n+u)}class ma{constructor(t,e,s,i,a){this._firestore=t,this._userDataWriter=e,this._key=s,this._document=i,this._converter=a}get id(){return this._key.path.lastSegment()}get ref(){return new vt(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const t=new yf(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(t)}return this._userDataWriter.convertValue(this._document.data.value)}}get(t){if(this._document){const e=this._document.data.field(_a("DocumentSnapshot.get",t));if(e!==null)return this._userDataWriter.convertValue(e)}}}class yf extends ma{data(){return super.data()}}function _a(n,t){return typeof t=="string"?ga(n,t):t instanceof gs?t._internalPath:t._delegate._internalPath}class Ef{convertValue(t,e="none"){switch(Qt(t)){case 0:return null;case 1:return t.booleanValue;case 2:return z(t.integerValue||t.doubleValue);case 3:return this.convertTimestamp(t.timestampValue);case 4:return this.convertServerTimestamp(t,e);case 5:return t.stringValue;case 6:return this.convertBytes(le(t.bytesValue));case 7:return this.convertReference(t.referenceValue);case 8:return this.convertGeoPoint(t.geoPointValue);case 9:return this.convertArray(t.arrayValue,e);case 11:return this.convertObject(t.mapValue,e);case 10:return this.convertVectorValue(t.mapValue);default:throw x(62114,{value:t})}}convertObject(t,e){return this.convertObjectMap(t.fields,e)}convertObjectMap(t,e="none"){const s={};return nn(t,((i,a)=>{s[i]=this.convertValue(a,e)})),s}convertVectorValue(t){const e=t.fields?.[kr].arrayValue?.values?.map((s=>z(s.doubleValue)));return new Ht(e)}convertGeoPoint(t){return new qt(z(t.latitude),z(t.longitude))}convertArray(t,e){return(t.values||[]).map((s=>this.convertValue(s,e)))}convertServerTimestamp(t,e){switch(e){case"previous":const s=qn(t);return s==null?null:this.convertValue(s,e);case"estimate":return this.convertTimestamp(Je(t));default:return null}}convertTimestamp(t){const e=Gt(t);return new Et(e.seconds,e.nanos)}convertDocumentKey(t,e){const s=G.fromString(t);st(aa(s),9688,{name:t});const i=new Ze(s.get(1),s.get(3)),a=new k(s.popFirst(5));return i.isEqual(e)||we(`Document ${a} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${e.projectId}/${e.database}) instead.`),a}}function Tf(n){return new pf("avg",mf("average",n))}class wn{constructor(t,e){this.hasPendingWrites=t,this.fromCache=e}isEqual(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache}}class _e extends ma{constructor(t,e,s,i,a,u){super(t,e,s,i,u),this._firestore=t,this._firestoreImpl=t,this.metadata=a}exists(){return super.exists()}data(t={}){if(this._document){if(this._converter){const e=new bn(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(e,t)}return this._userDataWriter.convertValue(this._document.data.value,t.serverTimestamps)}}get(t,e={}){if(this._document){const s=this._document.data.field(_a("DocumentSnapshot.get",t));if(s!==null)return this._userDataWriter.convertValue(s,e.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new D(b.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const t=this._document,e={};return e.type=_e._jsonSchemaVersion,e.bundle="",e.bundleSource="DocumentSnapshot",e.bundleName=this._key.toString(),!t||!t.isValidDocument()||!t.isFoundDocument()?e:(this._userDataWriter.convertObjectMap(t.data.value.mapValue.fields,"previous"),e.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),e)}}_e._jsonSchemaVersion="firestore/documentSnapshot/1.0",_e._jsonSchema={type:W("string",_e._jsonSchemaVersion),bundleSource:W("string","DocumentSnapshot"),bundleName:W("string"),bundle:W("string")};class bn extends _e{data(t={}){return super.data(t)}}class Ke{constructor(t,e,s,i){this._firestore=t,this._userDataWriter=e,this._snapshot=i,this.metadata=new wn(i.hasPendingWrites,i.fromCache),this.query=s}get docs(){const t=[];return this.forEach((e=>t.push(e))),t}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(t,e){this._snapshot.docs.forEach((s=>{t.call(e,new bn(this._firestore,this._userDataWriter,s.key,s,new wn(this._snapshot.mutatedKeys.has(s.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(t={}){const e=!!t.includeMetadataChanges;if(e&&this._snapshot.excludesMetadataChanges)throw new D(b.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===e||(this._cachedChanges=(function(i,a){if(i._snapshot.oldDocs.isEmpty()){let u=0;return i._snapshot.docChanges.map((h=>{const g=new bn(i._firestore,i._userDataWriter,h.doc.key,h.doc,new wn(i._snapshot.mutatedKeys.has(h.doc.key),i._snapshot.fromCache),i.query.converter);return h.doc,{type:"added",doc:g,oldIndex:-1,newIndex:u++}}))}{let u=i._snapshot.oldDocs;return i._snapshot.docChanges.filter((h=>a||h.type!==3)).map((h=>{const g=new bn(i._firestore,i._userDataWriter,h.doc.key,h.doc,new wn(i._snapshot.mutatedKeys.has(h.doc.key),i._snapshot.fromCache),i.query.converter);let d=-1,A=-1;return h.type!==0&&(d=u.indexOf(h.doc.key),u=u.delete(h.doc.key)),h.type!==1&&(u=u.add(h.doc),A=u.indexOf(h.doc.key)),{type:vf(h.type),doc:g,oldIndex:d,newIndex:A}}))}})(this,e),this._cachedChangesIncludeMetadataChanges=e),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new D(b.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const t={};t.type=Ke._jsonSchemaVersion,t.bundleSource="QuerySnapshot",t.bundleName=xo.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const e=[],s=[],i=[];return this.docs.forEach((a=>{a._document!==null&&(e.push(a._document),s.push(this._userDataWriter.convertObjectMap(a._document.data.value.mapValue.fields,"previous")),i.push(a.ref.path))})),t.bundle=(this._firestore,this.query._query,t.bundleName,"NOT SUPPORTED"),t}}function vf(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return x(61501,{type:n})}}Ke._jsonSchemaVersion="firestore/querySnapshot/1.0",Ke._jsonSchema={type:W("string",Ke._jsonSchemaVersion),bundleSource:W("string","QuerySnapshot"),bundleName:W("string"),bundle:W("string")};class Af extends Ef{constructor(t){super(),this.firestore=t}convertBytes(t){return new Ct(t)}convertReference(t){const e=this.convertDocumentKey(t,this.firestore._databaseId);return new vt(this.firestore,null,e)}}function If(n,t){const e=Lo(n.firestore,pa),s=ff(e),i=ac(t,((a,u)=>new Kc(u,a.aggregateType,a._internalFieldPath)));return lf(s,n._query,i).then((a=>(function(h,g,d){const A=new Af(h);return new gf(g,A,d)})(e,n,a)))}(function(t,e=!0){(function(i){Ie=i})(Iu),Nn(new We("firestore",((s,{instanceIdentifier:i,options:a})=>{const u=s.getProvider("app").getImmediate(),h=new pa(new Uu(s.getProvider("auth-internal")),new $u(u,s.getProvider("app-check-internal")),(function(d,A){if(!Object.prototype.hasOwnProperty.apply(d.options,["projectId"]))throw new D(b.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Ze(d.options.projectId,A)})(u,i),u);return a={useFetchStreams:e,...a},h._setSettings(a),h}),"PUBLIC").setMultipleInstances(!0)),ge(Pi,Vi,t),ge(Pi,Vi,"esm2020")})();const wf={apiKey:"AIzaSyAgiuoHawf7-vdzoLhwumePmeb2djunwSM",authDomain:"rwat-ca-43554.firebaseapp.com",projectId:"rwat-ca-43554",storageBucket:"rwat-ca-43554.firebasestorage.app",messagingSenderId:"1019402551514",appId:"1:1019402551514:web:2811c7ef1a54fb4a7725e3"},Rf=So(wf),_o=hf(Rf),Sf=document.getElementById("average_clicks"),Cf=document.getElementById("button_div");class et extends HTMLElement{static observedAttributes=["type","colour"];static HEIGHT="100px";static WIDTH="100px";static BORDER="1px";static SHAPE_DATA={circle:{tag:"circle"},square:{tag:"rect"},triangle:{tag:"polygon"}};static get SHAPES(){return Object.keys(et.SHAPE_DATA)}static shapeTag(t){return et.SHAPE_DATA[t].tag}static COLOURS=["red","green","blue","yellow","orange","purple"];static COMBINATIONS=et.SHAPES.map(t=>et.COLOURS.map(e=>[t,e])).flat();static getUniqueRandomCardsAsHTML(t,e){if(t>this.COMBINATIONS.length)throw new Error(`Cannot get ${t} unique shape cards. Maximum is ${this.COMBINATIONS.length}.`);return et.COMBINATIONS.reduce((s,i)=>s.toSpliced(Math.floor(Math.random()*(s.length+1)),0,i),[]).slice(0,t).reduce((s,i)=>{for(let a=0;a<(e?2:1);++a)s.splice(Math.floor(Math.random()*(s.length+1)),0,i);return s},[]).map(([s,i])=>`<shape-card type="${s}" colour="${i}"></shape-card>`).join("")}constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){this.shadowRoot.appendChild(document.getElementById("shape-card-template").content.cloneNode(!0)),this.#t(null,this.getAttribute("type")),this.#e(this.getAttribute("colour")),this.style.setProperty("--card-width",et.WIDTH),this.style.setProperty("--card-height",et.HEIGHT),this.style.setProperty("--card-border",et.BORDER)}attributeChangedCallback(t,e,s){this.shadowRoot&&(t=="type"?this.#t(e,s):t=="colour"&&this.#e(s))}#t(t,e){if(e&&!(e in et.SHAPE_DATA))throw new Error(`Invalid shape type attribute ${e}. Expected one of ${et.SHAPES.join(", ")}.`);t&&this.shadowRoot.querySelector(et.shapeTag(t))?.setAttribute("fill-opacity","0"),e&&this.shadowRoot.querySelector(et.shapeTag(e))?.setAttribute("fill-opacity","1")}#e(t){if(t&&!et.COLOURS.includes(t))throw new Error(`Invalid colour attribute ${t}. Expected one of ${et.COLOURS.join(", ")}.`);t&&this.shadowRoot.querySelector(et.shapeTag(this.getAttribute("type")))?.setAttribute("fill",t)}isFaceUp(){return this.shadowRoot.querySelector(".card").classList.contains("card-face-up")}flip(){const t=this.shadowRoot.querySelector(".card");t.classList.toggle("card-face-down"),t.classList.toggle("card-face-up")}}customElements.define("shape-card",et);class bf extends HTMLElement{connectedCallback(){const t=document.createElement("div");t.style.display="grid",t.style.gap="20px";const e=this.getAttribute("size"),[s,i]=e.split("x"),a=parseInt(s),u=parseInt(i);let h=a*u;const g=h/2,d=et.getUniqueRandomCardsAsHTML(g,!0);t.innerHTML=`${d}`,this.appendChild(t),t.style.gridTemplateRows="auto ".repeat(a),t.style.gridTemplateColumns="auto ".repeat(u);let A=[];const w=t.querySelectorAll("shape-card");let S=0;Sf.addEventListener("click",async()=>{const P=await If(cf(_o,"memory_game"),{average_clicks:Tf("num_clicks")}),N=document.createElement("p");N.innerHTML=`Average Clicks: ${P.data().average_clicks}`,N.setAttribute("aria-label","Average number of clicks"),N.id="average_clicks_text",Cf.appendChild(N)}),w.forEach(P=>{P.addEventListener("click",async()=>{if(A.length<2&&!P.isFaceUp())S=S+1,P.flip(),A.push(P);else return;A.length==2&&(Ya(A[0],A[1]),await Xa(_o,h,t,S),A=[])})})}}customElements.define("mem-game",bf);
